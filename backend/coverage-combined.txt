
> backend@1.0.0 test:coverage
> jest --coverage

  console.log
    [dotenv@17.2.3] injecting env (3) from .env.test -- tip: üîë add access controls to secrets: https://dotenvx.com/ops

      at _log (node_modules/dotenv/lib/main.js:142:11)

  console.log
    Starting test suite...

      at Object.<anonymous> (tests/setup.ts:9:11)

  console.log
    
    üöÄ Starting Restaurant Tests (No Mocking)...

      at Object.<anonymous> (tests/no-mocks/restaurant.test.ts:23:11)

  console.log
    ‚úÖ Socket.IO initialized successfully

      at initializeSocket (src/config/socket.ts:151:11)

  console.log
    ‚úÖ Socket.IO initialized successfully

      at initializeSocket (src/config/socket.ts:151:11)

  console.log
    ‚úÖ SocketManager initialized

      at SocketManager.log [as initialize] (src/utils/socketManager.ts:35:13)

  console.log
    ‚úÖ Test Socket.IO server initialized on port 60377

      at Server.<anonymous> (tests/helpers/socket.helper.ts:28:15)

  console.log
    MongoDB Atlas connected successfully

      at connectDatabase (src/config/database.ts:22:13)

  console.log
    
    ‚úÖ Test setup complete. Ready to run tests.

      at Object.<anonymous> (tests/no-mocks/restaurant.test.ts:44:11)

  console.warn
    ‚ö†Ô∏è  No Google Places API key - returning mock data

      39 |       // If no API key, return mock data
      40 |       if (!this.GOOGLE_PLACES_API_KEY) {
    > 41 |         console.warn('‚ö†Ô∏è  No Google Places API key - returning mock data');
         |                 ^
      42 |         return this.getMockRestaurants();
      43 |       }
      44 |

      at RestaurantService.warn [as searchRestaurants] (src/services/restaurantService.ts:41:17)
      at RestaurantController.searchRestaurants (src/controllers/restaurant.controller.ts:30:51)
      at searchRestaurants (src/routes/restaurant.routes.ts:14:30)
      at fn (src/middleware/errorHandler.ts:58:15)
      at src/middleware/errorHandler.ts:62:6
      at Layer.handleRequest (node_modules/router/lib/layer.js:152:17)
      at next (node_modules/router/lib/route.js:157:13)
      at next (src/middleware/auth.middleware.ts:110:5)
      at Layer.handleRequest (node_modules/router/lib/layer.js:152:17)
      at next (node_modules/router/lib/route.js:157:13)
      at Route.dispatch (node_modules/router/lib/route.js:117:3)
      at handle (node_modules/router/index.js:435:11)
      at Layer.handleRequest (node_modules/router/lib/layer.js:152:17)
      at node_modules/router/index.js:295:15
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at Function.handle (node_modules/router/index.js:186:3)
      at router (node_modules/router/index.js:60:12)
      at Layer.handleRequest (node_modules/router/lib/layer.js:152:17)
      at trimPrefix (node_modules/router/index.js:342:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at urlencodedParser (node_modules/body-parser/lib/types/urlencoded.js:68:7)
      at Layer.handleRequest (node_modules/router/lib/layer.js:152:17)
      at trimPrefix (node_modules/router/index.js:342:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at jsonParser (node_modules/body-parser/lib/types/json.js:100:7)
      at Layer.handleRequest (node_modules/router/lib/layer.js:152:17)
      at trimPrefix (node_modules/router/index.js:342:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at cors (node_modules/cors/lib/index.js:188:7)
      at node_modules/cors/lib/index.js:224:17
      at originCallback (node_modules/cors/lib/index.js:214:15)
      at node_modules/cors/lib/index.js:219:13
      at optionsCallback (node_modules/cors/lib/index.js:199:9)
      at corsMiddleware (node_modules/cors/lib/index.js:204:7)
      at Layer.handleRequest (node_modules/router/lib/layer.js:152:17)
      at trimPrefix (node_modules/router/index.js:342:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at Function.handle (node_modules/router/index.js:186:3)
      at Function.handle (node_modules/express/lib/application.js:177:15)
      at Server.app (node_modules/express/lib/express.js:38:9)

  console.warn
    ‚ö†Ô∏è  No Google Places API key - returning mock data

      39 |       // If no API key, return mock data
      40 |       if (!this.GOOGLE_PLACES_API_KEY) {
    > 41 |         console.warn('‚ö†Ô∏è  No Google Places API key - returning mock data');
         |                 ^
      42 |         return this.getMockRestaurants();
      43 |       }
      44 |

      at RestaurantService.warn [as searchRestaurants] (src/services/restaurantService.ts:41:17)
      at RestaurantController.searchRestaurants (src/controllers/restaurant.controller.ts:30:51)
      at searchRestaurants (src/routes/restaurant.routes.ts:14:30)
      at fn (src/middleware/errorHandler.ts:58:15)
      at src/middleware/errorHandler.ts:62:6
      at Layer.handleRequest (node_modules/router/lib/layer.js:152:17)
      at next (node_modules/router/lib/route.js:157:13)
      at next (src/middleware/auth.middleware.ts:110:5)
      at Layer.handleRequest (node_modules/router/lib/layer.js:152:17)
      at next (node_modules/router/lib/route.js:157:13)
      at Route.dispatch (node_modules/router/lib/route.js:117:3)
      at handle (node_modules/router/index.js:435:11)
      at Layer.handleRequest (node_modules/router/lib/layer.js:152:17)
      at node_modules/router/index.js:295:15
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at Function.handle (node_modules/router/index.js:186:3)
      at router (node_modules/router/index.js:60:12)
      at Layer.handleRequest (node_modules/router/lib/layer.js:152:17)
      at trimPrefix (node_modules/router/index.js:342:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at urlencodedParser (node_modules/body-parser/lib/types/urlencoded.js:68:7)
      at Layer.handleRequest (node_modules/router/lib/layer.js:152:17)
      at trimPrefix (node_modules/router/index.js:342:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at jsonParser (node_modules/body-parser/lib/types/json.js:100:7)
      at Layer.handleRequest (node_modules/router/lib/layer.js:152:17)
      at trimPrefix (node_modules/router/index.js:342:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at cors (node_modules/cors/lib/index.js:188:7)
      at node_modules/cors/lib/index.js:224:17
      at originCallback (node_modules/cors/lib/index.js:214:15)
      at node_modules/cors/lib/index.js:219:13
      at optionsCallback (node_modules/cors/lib/index.js:199:9)
      at corsMiddleware (node_modules/cors/lib/index.js:204:7)
      at Layer.handleRequest (node_modules/router/lib/layer.js:152:17)
      at trimPrefix (node_modules/router/index.js:342:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at Function.handle (node_modules/router/index.js:186:3)
      at Function.handle (node_modules/express/lib/application.js:177:15)
      at Server.app (node_modules/express/lib/express.js:38:9)

  console.warn
    ‚ö†Ô∏è  No Google Places API key - returning mock data

      39 |       // If no API key, return mock data
      40 |       if (!this.GOOGLE_PLACES_API_KEY) {
    > 41 |         console.warn('‚ö†Ô∏è  No Google Places API key - returning mock data');
         |                 ^
      42 |         return this.getMockRestaurants();
      43 |       }
      44 |

      at RestaurantService.warn [as searchRestaurants] (src/services/restaurantService.ts:41:17)
      at RestaurantController.searchRestaurants (src/controllers/restaurant.controller.ts:30:51)
      at searchRestaurants (src/routes/restaurant.routes.ts:14:30)
      at fn (src/middleware/errorHandler.ts:58:15)
      at src/middleware/errorHandler.ts:62:6
      at Layer.handleRequest (node_modules/router/lib/layer.js:152:17)
      at next (node_modules/router/lib/route.js:157:13)
      at next (src/middleware/auth.middleware.ts:110:5)
      at Layer.handleRequest (node_modules/router/lib/layer.js:152:17)
      at next (node_modules/router/lib/route.js:157:13)
      at Route.dispatch (node_modules/router/lib/route.js:117:3)
      at handle (node_modules/router/index.js:435:11)
      at Layer.handleRequest (node_modules/router/lib/layer.js:152:17)
      at node_modules/router/index.js:295:15
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at Function.handle (node_modules/router/index.js:186:3)
      at router (node_modules/router/index.js:60:12)
      at Layer.handleRequest (node_modules/router/lib/layer.js:152:17)
      at trimPrefix (node_modules/router/index.js:342:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at urlencodedParser (node_modules/body-parser/lib/types/urlencoded.js:68:7)
      at Layer.handleRequest (node_modules/router/lib/layer.js:152:17)
      at trimPrefix (node_modules/router/index.js:342:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at jsonParser (node_modules/body-parser/lib/types/json.js:100:7)
      at Layer.handleRequest (node_modules/router/lib/layer.js:152:17)
      at trimPrefix (node_modules/router/index.js:342:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at cors (node_modules/cors/lib/index.js:188:7)
      at node_modules/cors/lib/index.js:224:17
      at originCallback (node_modules/cors/lib/index.js:214:15)
      at node_modules/cors/lib/index.js:219:13
      at optionsCallback (node_modules/cors/lib/index.js:199:9)
      at corsMiddleware (node_modules/cors/lib/index.js:204:7)
      at Layer.handleRequest (node_modules/router/lib/layer.js:152:17)
      at trimPrefix (node_modules/router/index.js:342:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at Function.handle (node_modules/router/index.js:186:3)
      at Function.handle (node_modules/express/lib/application.js:177:15)
      at Server.app (node_modules/express/lib/express.js:38:9)

  console.warn
    ‚ö†Ô∏è  No Google Places API key - returning mock data

      39 |       // If no API key, return mock data
      40 |       if (!this.GOOGLE_PLACES_API_KEY) {
    > 41 |         console.warn('‚ö†Ô∏è  No Google Places API key - returning mock data');
         |                 ^
      42 |         return this.getMockRestaurants();
      43 |       }
      44 |

      at RestaurantService.warn [as searchRestaurants] (src/services/restaurantService.ts:41:17)
      at RestaurantService.searchRestaurants [as getRecommendationsForGroup] (src/services/restaurantService.ts:177:36)
      at RestaurantController.getRecommendationsForGroup [as getGroupRecommendations] (src/controllers/restaurant.controller.ts:87:55)
      at Layer.handleRequest (node_modules/router/lib/layer.js:152:17)
      at next (node_modules/router/lib/route.js:157:13)
      at next (src/middleware/auth.middleware.ts:69:5)
      at Layer.handleRequest (node_modules/router/lib/layer.js:152:17)
      at next (node_modules/router/lib/route.js:157:13)
      at Route.dispatch (node_modules/router/lib/route.js:117:3)
      at handle (node_modules/router/index.js:435:11)
      at Layer.handleRequest (node_modules/router/lib/layer.js:152:17)
      at node_modules/router/index.js:295:15
      at param (node_modules/router/index.js:600:14)
      at param (node_modules/router/index.js:610:14)
      at processParams (node_modules/router/index.js:664:3)
      at next (node_modules/router/index.js:291:5)
      at Function.handle (node_modules/router/index.js:186:3)
      at router (node_modules/router/index.js:60:12)
      at Layer.handleRequest (node_modules/router/lib/layer.js:152:17)
      at trimPrefix (node_modules/router/index.js:342:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at urlencodedParser (node_modules/body-parser/lib/types/urlencoded.js:57:7)
      at Layer.handleRequest (node_modules/router/lib/layer.js:152:17)
      at trimPrefix (node_modules/router/index.js:342:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at node_modules/body-parser/lib/read.js:132:5
      at invokeCallback (node_modules/raw-body/index.js:238:16)
      at done (node_modules/raw-body/index.js:227:7)
      at IncomingMessage.onEnd (node_modules/raw-body/index.js:287:7)

  console.warn
    ‚ö†Ô∏è  No Google Places API key - returning mock data

      39 |       // If no API key, return mock data
      40 |       if (!this.GOOGLE_PLACES_API_KEY) {
    > 41 |         console.warn('‚ö†Ô∏è  No Google Places API key - returning mock data');
         |                 ^
      42 |         return this.getMockRestaurants();
      43 |       }
      44 |

      at RestaurantService.warn [as searchRestaurants] (src/services/restaurantService.ts:41:17)
      at RestaurantService.searchRestaurants [as getRecommendationsForGroup] (src/services/restaurantService.ts:177:36)
      at RestaurantController.getRecommendationsForGroup [as getGroupRecommendations] (src/controllers/restaurant.controller.ts:87:55)
      at Layer.handleRequest (node_modules/router/lib/layer.js:152:17)
      at next (node_modules/router/lib/route.js:157:13)
      at next (src/middleware/auth.middleware.ts:69:5)
      at Layer.handleRequest (node_modules/router/lib/layer.js:152:17)
      at next (node_modules/router/lib/route.js:157:13)
      at Route.dispatch (node_modules/router/lib/route.js:117:3)
      at handle (node_modules/router/index.js:435:11)
      at Layer.handleRequest (node_modules/router/lib/layer.js:152:17)
      at node_modules/router/index.js:295:15
      at param (node_modules/router/index.js:600:14)
      at param (node_modules/router/index.js:610:14)
      at processParams (node_modules/router/index.js:664:3)
      at next (node_modules/router/index.js:291:5)
      at Function.handle (node_modules/router/index.js:186:3)
      at router (node_modules/router/index.js:60:12)
      at Layer.handleRequest (node_modules/router/lib/layer.js:152:17)
      at trimPrefix (node_modules/router/index.js:342:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at urlencodedParser (node_modules/body-parser/lib/types/urlencoded.js:57:7)
      at Layer.handleRequest (node_modules/router/lib/layer.js:152:17)
      at trimPrefix (node_modules/router/index.js:342:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at node_modules/body-parser/lib/read.js:132:5
      at invokeCallback (node_modules/raw-body/index.js:238:16)
      at done (node_modules/raw-body/index.js:227:7)
      at IncomingMessage.onEnd (node_modules/raw-body/index.js:287:7)

  console.warn
    ‚ö†Ô∏è  No Google Places API key - returning mock data

      39 |       // If no API key, return mock data
      40 |       if (!this.GOOGLE_PLACES_API_KEY) {
    > 41 |         console.warn('‚ö†Ô∏è  No Google Places API key - returning mock data');
         |                 ^
      42 |         return this.getMockRestaurants();
      43 |       }
      44 |

      at RestaurantService.warn [as searchRestaurants] (src/services/restaurantService.ts:41:17)
      at RestaurantService.searchRestaurants [as getRecommendationsForGroup] (src/services/restaurantService.ts:177:36)
      at RestaurantController.getRecommendationsForGroup [as getGroupRecommendations] (src/controllers/restaurant.controller.ts:87:55)
      at Layer.handleRequest (node_modules/router/lib/layer.js:152:17)
      at next (node_modules/router/lib/route.js:157:13)
      at next (src/middleware/auth.middleware.ts:69:5)
      at Layer.handleRequest (node_modules/router/lib/layer.js:152:17)
      at next (node_modules/router/lib/route.js:157:13)
      at Route.dispatch (node_modules/router/lib/route.js:117:3)
      at handle (node_modules/router/index.js:435:11)
      at Layer.handleRequest (node_modules/router/lib/layer.js:152:17)
      at node_modules/router/index.js:295:15
      at param (node_modules/router/index.js:600:14)
      at param (node_modules/router/index.js:610:14)
      at processParams (node_modules/router/index.js:664:3)
      at next (node_modules/router/index.js:291:5)
      at Function.handle (node_modules/router/index.js:186:3)
      at router (node_modules/router/index.js:60:12)
      at Layer.handleRequest (node_modules/router/lib/layer.js:152:17)
      at trimPrefix (node_modules/router/index.js:342:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at urlencodedParser (node_modules/body-parser/lib/types/urlencoded.js:57:7)
      at Layer.handleRequest (node_modules/router/lib/layer.js:152:17)
      at trimPrefix (node_modules/router/index.js:342:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at node_modules/body-parser/lib/read.js:132:5
      at invokeCallback (node_modules/raw-body/index.js:238:16)
      at done (node_modules/raw-body/index.js:227:7)
      at IncomingMessage.onEnd (node_modules/raw-body/index.js:287:7)

  console.error
    Error: {
      message: 'Service error for testing',
      statusCode: 500,
      stack: 'Error: Service error for testing\n' +
        '    at Object.<anonymous> (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/tests/no-mocks/restaurant.test.ts:488:30)\n' +
        '    at processTicksAndRejections (node:internal/process/task_queues:105:5)',
      timestamp: '2025-11-09T07:24:46.305Z',
      path: '/api/restaurant/search',
      method: 'GET'
    }

      90 |   }
      91 |
    > 92 |   console.error('Error:', {
         |           ^
      93 |     message: err.message,
      94 |     statusCode,
      95 |     stack: err.stack,

      at error (src/middleware/errorHandler.ts:92:11)
      at Layer.handleError (node_modules/router/lib/layer.js:116:17)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at Layer.handleError (node_modules/router/lib/layer.js:111:12)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at node_modules/router/index.js:688:15
      at next (node_modules/router/index.js:276:14)
      at next (node_modules/router/lib/route.js:132:14)
      at RestaurantController.next [as searchRestaurants] (src/controllers/restaurant.controller.ts:44:7)
      at src/routes/restaurant.routes.ts:14:3
      at src/middleware/errorHandler.ts:58:9

  console.error
    Error: {
      message: 'Recommendations service error',
      statusCode: 500,
      stack: 'Error: Recommendations service error\n' +
        '    at Object.<anonymous> (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/tests/no-mocks/restaurant.test.ts:523:30)\n' +
        '    at processTicksAndRejections (node:internal/process/task_queues:105:5)',
      timestamp: '2025-11-09T07:24:46.309Z',
      path: '/api/restaurant/recommendations/691041bedbf5fa1d2758bf87',
      method: 'POST'
    }

      90 |   }
      91 |
    > 92 |   console.error('Error:', {
         |           ^
      93 |     message: err.message,
      94 |     statusCode,
      95 |     stack: err.stack,

      at error (src/middleware/errorHandler.ts:92:11)
      at Layer.handleError (node_modules/router/lib/layer.js:116:17)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at Layer.handleError (node_modules/router/lib/layer.js:111:12)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at node_modules/router/index.js:688:15
      at next (node_modules/router/index.js:276:14)
      at next (node_modules/router/lib/route.js:132:14)
      at RestaurantController.next [as getGroupRecommendations] (src/controllers/restaurant.controller.ts:98:7)

  console.log
    Test suite completed.

      at Object.<anonymous> (tests/setup.ts:14:11)

  console.log
    
    üßπ Cleaning up after tests...

      at Object.<anonymous> (tests/no-mocks/restaurant.test.ts:48:11)

  console.warn
    MongoDB disconnected. Attempting to reconnect...

      28 |
      29 |     mongoose.connection.on('disconnected', () => {
    > 30 |       console.warn('MongoDB disconnected. Attempting to reconnect...');
         |               ^
      31 |     });
      32 |
      33 |     mongoose.connection.on('reconnected', () => {

      at NativeConnection.<anonymous> (src/config/database.ts:30:15)
      at NativeConnection.set (node_modules/mongoose/lib/connection.js:145:12)
      at NativeConnection.onClose (node_modules/mongoose/lib/connection.js:1315:19)
      at NativeConnection._close (node_modules/mongoose/lib/connection.js:1264:12)
      at disconnectDatabase (src/config/database.ts:55:5)
      at Object.<anonymous> (tests/no-mocks/restaurant.test.ts:54:3)

  console.log
    MongoDB disconnected successfully

      at disconnectDatabase (src/config/database.ts:56:13)

  console.log
    ‚úÖ HTTP server closed

      at Server.<anonymous> (tests/helpers/socket.helper.ts:44:15)

  console.log
    ‚úÖ Socket.IO server closed

      at tests/helpers/socket.helper.ts:40:15

  console.log
    ‚úÖ Cleanup complete.

      at Object.<anonymous> (tests/no-mocks/restaurant.test.ts:59:11)

PASS tests/no-mocks/restaurant.test.ts
  GET /api/restaurant/search - No Mocking
    ‚úì should return 200 and search results with valid coordinates (17 ms)
    ‚úì should return 400 when latitude is missing (2 ms)
    ‚úì should return 400 when longitude is missing (2 ms)
    ‚úì should accept optional query parameters (radius, cuisineTypes, priceLevel) (5 ms)
    ‚úì should work without authentication (optional auth) (5 ms)
  GET /api/restaurant/:restaurantId - No Mocking
    ‚úì should return 200 and restaurant details for valid ID (3 ms)
    ‚úì should handle different restaurant IDs (2 ms)
  POST /api/restaurant/recommendations/:groupId - No Mocking
    ‚úì should return 200 and recommendations with valid data (13 ms)
    ‚úì should return 401 without authentication token (4 ms)
    ‚úì should return 400 when userPreferences is missing (3 ms)
    ‚úì should return 400 when userPreferences is not an array (1 ms)
    ‚úì should handle empty userPreferences array (3 ms)
    ‚úì should calculate average preferences from multiple users (2 ms)
  Error Handling - next(error) Coverage
    ‚úì should handle errors in searchRestaurants catch block and call next(error) (9 ms)
    ‚úì should handle errors in getGroupRecommendations catch block and call next(error) (4 ms)

  console.log
    [dotenv@17.2.3] injecting env (3) from .env.test -- tip: üë• sync secrets across teammates & machines: https://dotenvx.com/ops

      at _log (node_modules/dotenv/lib/main.js:142:11)

  console.log
    Starting test suite...

      at Object.<anonymous> (tests/setup.ts:9:11)

  console.log
    
    üöÄ Starting Error Handler Tests...

      at Object.<anonymous> (tests/with-mocks/errorHandler.mock.test.ts:103:13)

  console.log
    MongoDB Atlas connected successfully

      at connectDatabase (src/config/database.ts:22:13)

  console.log
    ‚úÖ Test setup complete.

      at Object.<anonymous> (tests/with-mocks/errorHandler.mock.test.ts:106:13)

  console.error
    Error: {
      message: 'Custom application error',
      statusCode: 400,
      stack: 'AppError: Custom application error\n' +
        '    at /Users/hashim/Desktop/Development/FeastFriends/321-project/backend/tests/with-mocks/errorHandler.mock.test.ts:33:10\n' +
        '    at Layer.handleRequest (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/lib/layer.js:152:17)\n' +
        '    at next (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/lib/route.js:157:13)\n' +
        '    at Route.dispatch (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/lib/route.js:117:3)\n' +
        '    at handle (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/index.js:435:11)\n' +
        '    at Layer.handleRequest (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/lib/layer.js:152:17)\n' +
        '    at /Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/index.js:295:15\n' +
        '    at processParams (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/index.js:582:12)\n' +
        '    at next (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/index.js:291:5)\n' +
        '    at jsonParser (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/body-parser/lib/types/json.js:100:7)\n' +
        '    at Layer.handleRequest (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/lib/layer.js:152:17)\n' +
        '    at trimPrefix (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/index.js:342:13)\n' +
        '    at /Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/index.js:297:9\n' +
        '    at processParams (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/index.js:582:12)\n' +
        '    at next (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/index.js:291:5)\n' +
        '    at Function.handle (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/index.js:186:3)\n' +
        '    at Function.handle (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/express/lib/application.js:177:15)\n' +
        '    at Server.app (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/express/lib/express.js:38:9)\n' +
        '    at Server.emit (node:events:519:28)\n' +
        '    at parserOnIncoming (node:_http_server:1173:12)\n' +
        '    at HTTPParser.parserOnHeadersComplete (node:_http_common:121:17)',
      timestamp: '2025-11-09T07:24:46.453Z',
      path: '/test/app-error',
      method: 'GET'
    }

      90 |   }
      91 |
    > 92 |   console.error('Error:', {
         |           ^
      93 |     message: err.message,
      94 |     statusCode,
      95 |     stack: err.stack,

      at error (src/middleware/errorHandler.ts:92:11)
      at Layer.handleError (node_modules/router/lib/layer.js:116:17)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at next (node_modules/router/lib/route.js:132:14)
      at tests/with-mocks/errorHandler.mock.test.ts:33:5
      at Layer.handleRequest (node_modules/router/lib/layer.js:152:17)
      at next (node_modules/router/lib/route.js:157:13)
      at Route.dispatch (node_modules/router/lib/route.js:117:3)
      at handle (node_modules/router/index.js:435:11)
      at Layer.handleRequest (node_modules/router/lib/layer.js:152:17)
      at node_modules/router/index.js:295:15
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at jsonParser (node_modules/body-parser/lib/types/json.js:100:7)
      at Layer.handleRequest (node_modules/router/lib/layer.js:152:17)
      at trimPrefix (node_modules/router/index.js:342:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at Function.handle (node_modules/router/index.js:186:3)
      at Function.handle (node_modules/express/lib/application.js:177:15)
      at Server.app (node_modules/express/lib/express.js:38:9)

  console.error
    Error: {
      message: 'Resource not found',
      statusCode: 404,
      stack: 'AppError: Resource not found\n' +
        '    at /Users/hashim/Desktop/Development/FeastFriends/321-project/backend/tests/with-mocks/errorHandler.mock.test.ts:140:14\n' +
        '    at Layer.handleRequest (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/lib/layer.js:152:17)\n' +
        '    at next (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/lib/route.js:157:13)\n' +
        '    at Route.dispatch (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/lib/route.js:117:3)\n' +
        '    at handle (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/index.js:435:11)\n' +
        '    at Layer.handleRequest (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/lib/layer.js:152:17)\n' +
        '    at /Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/index.js:295:15\n' +
        '    at processParams (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/index.js:582:12)\n' +
        '    at next (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/index.js:291:5)\n' +
        '    at Function.handle (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/index.js:186:3)\n' +
        '    at Function.handle (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/express/lib/application.js:177:15)\n' +
        '    at Server.app (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/express/lib/express.js:38:9)\n' +
        '    at Server.emit (node:events:519:28)\n' +
        '    at parserOnIncoming (node:_http_server:1173:12)\n' +
        '    at HTTPParser.parserOnHeadersComplete (node:_http_common:121:17)',
      timestamp: '2025-11-09T07:24:46.463Z',
      path: '/test/not-found',
      method: 'GET'
    }

      90 |   }
      91 |
    > 92 |   console.error('Error:', {
         |           ^
      93 |     message: err.message,
      94 |     statusCode,
      95 |     stack: err.stack,

      at error (src/middleware/errorHandler.ts:92:11)
      at Layer.handleError (node_modules/router/lib/layer.js:116:17)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at next (node_modules/router/lib/route.js:132:14)
      at tests/with-mocks/errorHandler.mock.test.ts:140:9
      at Layer.handleRequest (node_modules/router/lib/layer.js:152:17)
      at next (node_modules/router/lib/route.js:157:13)
      at Route.dispatch (node_modules/router/lib/route.js:117:3)
      at handle (node_modules/router/index.js:435:11)
      at Layer.handleRequest (node_modules/router/lib/layer.js:152:17)
      at node_modules/router/index.js:295:15
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at Function.handle (node_modules/router/index.js:186:3)
      at Function.handle (node_modules/express/lib/application.js:177:15)
      at Server.app (node_modules/express/lib/express.js:38:9)

  console.error
    Error: {
      message: 'Access forbidden',
      statusCode: 403,
      stack: 'AppError: Access forbidden\n' +
        '    at /Users/hashim/Desktop/Development/FeastFriends/321-project/backend/tests/with-mocks/errorHandler.mock.test.ts:159:14\n' +
        '    at Layer.handleRequest (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/lib/layer.js:152:17)\n' +
        '    at next (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/lib/route.js:157:13)\n' +
        '    at Route.dispatch (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/lib/route.js:117:3)\n' +
        '    at handle (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/index.js:435:11)\n' +
        '    at Layer.handleRequest (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/lib/layer.js:152:17)\n' +
        '    at /Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/index.js:295:15\n' +
        '    at processParams (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/index.js:582:12)\n' +
        '    at next (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/index.js:291:5)\n' +
        '    at Function.handle (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/index.js:186:3)\n' +
        '    at Function.handle (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/express/lib/application.js:177:15)\n' +
        '    at Server.app (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/express/lib/express.js:38:9)\n' +
        '    at Server.emit (node:events:519:28)\n' +
        '    at parserOnIncoming (node:_http_server:1173:12)\n' +
        '    at HTTPParser.parserOnHeadersComplete (node:_http_common:121:17)',
      timestamp: '2025-11-09T07:24:46.469Z',
      path: '/test/forbidden',
      method: 'GET'
    }

      90 |   }
      91 |
    > 92 |   console.error('Error:', {
         |           ^
      93 |     message: err.message,
      94 |     statusCode,
      95 |     stack: err.stack,

      at error (src/middleware/errorHandler.ts:92:11)
      at Layer.handleError (node_modules/router/lib/layer.js:116:17)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at next (node_modules/router/lib/route.js:132:14)
      at tests/with-mocks/errorHandler.mock.test.ts:159:9
      at Layer.handleRequest (node_modules/router/lib/layer.js:152:17)
      at next (node_modules/router/lib/route.js:157:13)
      at Route.dispatch (node_modules/router/lib/route.js:117:3)
      at handle (node_modules/router/index.js:435:11)
      at Layer.handleRequest (node_modules/router/lib/layer.js:152:17)
      at node_modules/router/index.js:295:15
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at Function.handle (node_modules/router/index.js:186:3)
      at Function.handle (node_modules/express/lib/application.js:177:15)
      at Server.app (node_modules/express/lib/express.js:38:9)

  console.error
    Error: {
      message: 'Resource conflict',
      statusCode: 409,
      stack: 'AppError: Resource conflict\n' +
        '    at /Users/hashim/Desktop/Development/FeastFriends/321-project/backend/tests/with-mocks/errorHandler.mock.test.ts:178:14\n' +
        '    at Layer.handleRequest (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/lib/layer.js:152:17)\n' +
        '    at next (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/lib/route.js:157:13)\n' +
        '    at Route.dispatch (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/lib/route.js:117:3)\n' +
        '    at handle (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/index.js:435:11)\n' +
        '    at Layer.handleRequest (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/lib/layer.js:152:17)\n' +
        '    at /Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/index.js:295:15\n' +
        '    at processParams (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/index.js:582:12)\n' +
        '    at next (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/index.js:291:5)\n' +
        '    at Function.handle (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/index.js:186:3)\n' +
        '    at Function.handle (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/express/lib/application.js:177:15)\n' +
        '    at Server.app (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/express/lib/express.js:38:9)\n' +
        '    at Server.emit (node:events:519:28)\n' +
        '    at parserOnIncoming (node:_http_server:1173:12)\n' +
        '    at HTTPParser.parserOnHeadersComplete (node:_http_common:121:17)',
      timestamp: '2025-11-09T07:24:46.484Z',
      path: '/test/conflict',
      method: 'GET'
    }

      90 |   }
      91 |
    > 92 |   console.error('Error:', {
         |           ^
      93 |     message: err.message,
      94 |     statusCode,
      95 |     stack: err.stack,

      at error (src/middleware/errorHandler.ts:92:11)
      at Layer.handleError (node_modules/router/lib/layer.js:116:17)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at next (node_modules/router/lib/route.js:132:14)
      at tests/with-mocks/errorHandler.mock.test.ts:178:9
      at Layer.handleRequest (node_modules/router/lib/layer.js:152:17)
      at next (node_modules/router/lib/route.js:157:13)
      at Route.dispatch (node_modules/router/lib/route.js:117:3)
      at handle (node_modules/router/index.js:435:11)
      at Layer.handleRequest (node_modules/router/lib/layer.js:152:17)
      at node_modules/router/index.js:295:15
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at Function.handle (node_modules/router/index.js:186:3)
      at Function.handle (node_modules/express/lib/application.js:177:15)
      at Server.app (node_modules/express/lib/express.js:38:9)

  console.error
    Error: {
      message: 'Unauthorized',
      statusCode: 401,
      stack: 'AppError: Unauthorized\n' +
        '    at /Users/hashim/Desktop/Development/FeastFriends/321-project/backend/tests/with-mocks/errorHandler.mock.test.ts:197:14\n' +
        '    at Layer.handleRequest (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/lib/layer.js:152:17)\n' +
        '    at next (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/lib/route.js:157:13)\n' +
        '    at Route.dispatch (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/lib/route.js:117:3)\n' +
        '    at handle (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/index.js:435:11)\n' +
        '    at Layer.handleRequest (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/lib/layer.js:152:17)\n' +
        '    at /Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/index.js:295:15\n' +
        '    at processParams (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/index.js:582:12)\n' +
        '    at next (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/index.js:291:5)\n' +
        '    at Function.handle (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/index.js:186:3)\n' +
        '    at Function.handle (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/express/lib/application.js:177:15)\n' +
        '    at Server.app (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/express/lib/express.js:38:9)\n' +
        '    at Server.emit (node:events:519:28)\n' +
        '    at parserOnIncoming (node:_http_server:1173:12)\n' +
        '    at HTTPParser.parserOnHeadersComplete (node:_http_common:121:17)',
      timestamp: '2025-11-09T07:24:46.492Z',
      path: '/test/unauthorized',
      method: 'GET'
    }

      90 |   }
      91 |
    > 92 |   console.error('Error:', {
         |           ^
      93 |     message: err.message,
      94 |     statusCode,
      95 |     stack: err.stack,

      at error (src/middleware/errorHandler.ts:92:11)
      at Layer.handleError (node_modules/router/lib/layer.js:116:17)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at next (node_modules/router/lib/route.js:132:14)
      at tests/with-mocks/errorHandler.mock.test.ts:197:9
      at Layer.handleRequest (node_modules/router/lib/layer.js:152:17)
      at next (node_modules/router/lib/route.js:157:13)
      at Route.dispatch (node_modules/router/lib/route.js:117:3)
      at handle (node_modules/router/index.js:435:11)
      at Layer.handleRequest (node_modules/router/lib/layer.js:152:17)
      at node_modules/router/index.js:295:15
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at Function.handle (node_modules/router/index.js:186:3)
      at Function.handle (node_modules/express/lib/application.js:177:15)
      at Server.app (node_modules/express/lib/express.js:38:9)

  console.error
    Error: {
      message: 'Validation failed',
      statusCode: 400,
      stack: 'ValidationError: Validation failed\n' +
        '    at /Users/hashim/Desktop/Development/FeastFriends/321-project/backend/tests/with-mocks/errorHandler.mock.test.ts:38:24\n' +
        '    at Layer.handleRequest (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/lib/layer.js:152:17)\n' +
        '    at next (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/lib/route.js:157:13)\n' +
        '    at Route.dispatch (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/lib/route.js:117:3)\n' +
        '    at handle (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/index.js:435:11)\n' +
        '    at Layer.handleRequest (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/lib/layer.js:152:17)\n' +
        '    at /Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/index.js:295:15\n' +
        '    at processParams (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/index.js:582:12)\n' +
        '    at next (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/index.js:291:5)\n' +
        '    at jsonParser (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/body-parser/lib/types/json.js:100:7)\n' +
        '    at Layer.handleRequest (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/lib/layer.js:152:17)\n' +
        '    at trimPrefix (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/index.js:342:13)\n' +
        '    at /Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/index.js:297:9\n' +
        '    at processParams (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/index.js:582:12)\n' +
        '    at next (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/index.js:291:5)\n' +
        '    at Function.handle (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/index.js:186:3)\n' +
        '    at Function.handle (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/express/lib/application.js:177:15)\n' +
        '    at Server.app (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/express/lib/express.js:38:9)\n' +
        '    at Server.emit (node:events:519:28)\n' +
        '    at parserOnIncoming (node:_http_server:1173:12)\n' +
        '    at HTTPParser.parserOnHeadersComplete (node:_http_common:121:17)',
      timestamp: '2025-11-09T07:24:46.500Z',
      path: '/test/validation-error',
      method: 'GET'
    }

      90 |   }
      91 |
    > 92 |   console.error('Error:', {
         |           ^
      93 |     message: err.message,
      94 |     statusCode,
      95 |     stack: err.stack,

      at error (src/middleware/errorHandler.ts:92:11)
      at Layer.handleError (node_modules/router/lib/layer.js:116:17)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at next (node_modules/router/lib/route.js:132:14)
      at tests/with-mocks/errorHandler.mock.test.ts:45:5
      at Layer.handleRequest (node_modules/router/lib/layer.js:152:17)
      at next (node_modules/router/lib/route.js:157:13)
      at Route.dispatch (node_modules/router/lib/route.js:117:3)
      at handle (node_modules/router/index.js:435:11)
      at Layer.handleRequest (node_modules/router/lib/layer.js:152:17)
      at node_modules/router/index.js:295:15
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at jsonParser (node_modules/body-parser/lib/types/json.js:100:7)
      at Layer.handleRequest (node_modules/router/lib/layer.js:152:17)
      at trimPrefix (node_modules/router/index.js:342:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at Function.handle (node_modules/router/index.js:186:3)
      at Function.handle (node_modules/express/lib/application.js:177:15)
      at Server.app (node_modules/express/lib/express.js:38:9)

  console.error
    Error: {
      message: 'Cast to ObjectId failed',
      statusCode: 400,
      stack: 'CastError: Cast to ObjectId failed\n' +
        '    at /Users/hashim/Desktop/Development/FeastFriends/321-project/backend/tests/with-mocks/errorHandler.mock.test.ts:50:24\n' +
        '    at Layer.handleRequest (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/lib/layer.js:152:17)\n' +
        '    at next (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/lib/route.js:157:13)\n' +
        '    at Route.dispatch (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/lib/route.js:117:3)\n' +
        '    at handle (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/index.js:435:11)\n' +
        '    at Layer.handleRequest (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/lib/layer.js:152:17)\n' +
        '    at /Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/index.js:295:15\n' +
        '    at processParams (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/index.js:582:12)\n' +
        '    at next (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/index.js:291:5)\n' +
        '    at jsonParser (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/body-parser/lib/types/json.js:100:7)\n' +
        '    at Layer.handleRequest (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/lib/layer.js:152:17)\n' +
        '    at trimPrefix (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/index.js:342:13)\n' +
        '    at /Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/index.js:297:9\n' +
        '    at processParams (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/index.js:582:12)\n' +
        '    at next (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/index.js:291:5)\n' +
        '    at Function.handle (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/index.js:186:3)\n' +
        '    at Function.handle (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/express/lib/application.js:177:15)\n' +
        '    at Server.app (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/express/lib/express.js:38:9)\n' +
        '    at Server.emit (node:events:519:28)\n' +
        '    at parserOnIncoming (node:_http_server:1173:12)\n' +
        '    at HTTPParser.parserOnHeadersComplete (node:_http_common:121:17)',
      timestamp: '2025-11-09T07:24:46.507Z',
      path: '/test/cast-error',
      method: 'GET'
    }

      90 |   }
      91 |
    > 92 |   console.error('Error:', {
         |           ^
      93 |     message: err.message,
      94 |     statusCode,
      95 |     stack: err.stack,

      at error (src/middleware/errorHandler.ts:92:11)
      at Layer.handleError (node_modules/router/lib/layer.js:116:17)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at next (node_modules/router/lib/route.js:132:14)
      at tests/with-mocks/errorHandler.mock.test.ts:54:5
      at Layer.handleRequest (node_modules/router/lib/layer.js:152:17)
      at next (node_modules/router/lib/route.js:157:13)
      at Route.dispatch (node_modules/router/lib/route.js:117:3)
      at handle (node_modules/router/index.js:435:11)
      at Layer.handleRequest (node_modules/router/lib/layer.js:152:17)
      at node_modules/router/index.js:295:15
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at jsonParser (node_modules/body-parser/lib/types/json.js:100:7)
      at Layer.handleRequest (node_modules/router/lib/layer.js:152:17)
      at trimPrefix (node_modules/router/index.js:342:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at Function.handle (node_modules/router/index.js:186:3)
      at Function.handle (node_modules/express/lib/application.js:177:15)
      at Server.app (node_modules/express/lib/express.js:38:9)

  console.error
    Error: {
      message: 'E11000 duplicate key error',
      statusCode: 409,
      stack: 'MongoServerError: E11000 duplicate key error\n' +
        '    at /Users/hashim/Desktop/Development/FeastFriends/321-project/backend/tests/with-mocks/errorHandler.mock.test.ts:59:24\n' +
        '    at Layer.handleRequest (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/lib/layer.js:152:17)\n' +
        '    at next (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/lib/route.js:157:13)\n' +
        '    at Route.dispatch (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/lib/route.js:117:3)\n' +
        '    at handle (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/index.js:435:11)\n' +
        '    at Layer.handleRequest (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/lib/layer.js:152:17)\n' +
        '    at /Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/index.js:295:15\n' +
        '    at processParams (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/index.js:582:12)\n' +
        '    at next (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/index.js:291:5)\n' +
        '    at jsonParser (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/body-parser/lib/types/json.js:100:7)\n' +
        '    at Layer.handleRequest (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/lib/layer.js:152:17)\n' +
        '    at trimPrefix (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/index.js:342:13)\n' +
        '    at /Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/index.js:297:9\n' +
        '    at processParams (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/index.js:582:12)\n' +
        '    at next (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/index.js:291:5)\n' +
        '    at Function.handle (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/index.js:186:3)\n' +
        '    at Function.handle (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/express/lib/application.js:177:15)\n' +
        '    at Server.app (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/express/lib/express.js:38:9)\n' +
        '    at Server.emit (node:events:519:28)\n' +
        '    at parserOnIncoming (node:_http_server:1173:12)\n' +
        '    at HTTPParser.parserOnHeadersComplete (node:_http_common:121:17)',
      timestamp: '2025-11-09T07:24:46.518Z',
      path: '/test/duplicate-error',
      method: 'GET'
    }

      90 |   }
      91 |
    > 92 |   console.error('Error:', {
         |           ^
      93 |     message: err.message,
      94 |     statusCode,
      95 |     stack: err.stack,

      at error (src/middleware/errorHandler.ts:92:11)
      at Layer.handleError (node_modules/router/lib/layer.js:116:17)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at next (node_modules/router/lib/route.js:132:14)
      at tests/with-mocks/errorHandler.mock.test.ts:63:5
      at Layer.handleRequest (node_modules/router/lib/layer.js:152:17)
      at next (node_modules/router/lib/route.js:157:13)
      at Route.dispatch (node_modules/router/lib/route.js:117:3)
      at handle (node_modules/router/index.js:435:11)
      at Layer.handleRequest (node_modules/router/lib/layer.js:152:17)
      at node_modules/router/index.js:295:15
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at jsonParser (node_modules/body-parser/lib/types/json.js:100:7)
      at Layer.handleRequest (node_modules/router/lib/layer.js:152:17)
      at trimPrefix (node_modules/router/index.js:342:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at Function.handle (node_modules/router/index.js:186:3)
      at Function.handle (node_modules/express/lib/application.js:177:15)
      at Server.app (node_modules/express/lib/express.js:38:9)

  console.error
    Error: {
      message: 'Something went wrong',
      statusCode: 500,
      stack: 'Error: Something went wrong\n' +
        '    at /Users/hashim/Desktop/Development/FeastFriends/321-project/backend/tests/with-mocks/errorHandler.mock.test.ts:68:10\n' +
        '    at Layer.handleRequest (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/lib/layer.js:152:17)\n' +
        '    at next (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/lib/route.js:157:13)\n' +
        '    at Route.dispatch (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/lib/route.js:117:3)\n' +
        '    at handle (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/index.js:435:11)\n' +
        '    at Layer.handleRequest (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/lib/layer.js:152:17)\n' +
        '    at /Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/index.js:295:15\n' +
        '    at processParams (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/index.js:582:12)\n' +
        '    at next (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/index.js:291:5)\n' +
        '    at jsonParser (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/body-parser/lib/types/json.js:100:7)\n' +
        '    at Layer.handleRequest (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/lib/layer.js:152:17)\n' +
        '    at trimPrefix (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/index.js:342:13)\n' +
        '    at /Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/index.js:297:9\n' +
        '    at processParams (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/index.js:582:12)\n' +
        '    at next (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/index.js:291:5)\n' +
        '    at Function.handle (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/index.js:186:3)\n' +
        '    at Function.handle (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/express/lib/application.js:177:15)\n' +
        '    at Server.app (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/express/lib/express.js:38:9)\n' +
        '    at Server.emit (node:events:519:28)\n' +
        '    at parserOnIncoming (node:_http_server:1173:12)\n' +
        '    at HTTPParser.parserOnHeadersComplete (node:_http_common:121:17)',
      timestamp: '2025-11-09T07:24:46.546Z',
      path: '/test/generic-error',
      method: 'GET'
    }

      90 |   }
      91 |
    > 92 |   console.error('Error:', {
         |           ^
      93 |     message: err.message,
      94 |     statusCode,
      95 |     stack: err.stack,

      at error (src/middleware/errorHandler.ts:92:11)
      at Layer.handleError (node_modules/router/lib/layer.js:116:17)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at next (node_modules/router/lib/route.js:132:14)
      at tests/with-mocks/errorHandler.mock.test.ts:68:5
      at Layer.handleRequest (node_modules/router/lib/layer.js:152:17)
      at next (node_modules/router/lib/route.js:157:13)
      at Route.dispatch (node_modules/router/lib/route.js:117:3)
      at handle (node_modules/router/index.js:435:11)
      at Layer.handleRequest (node_modules/router/lib/layer.js:152:17)
      at node_modules/router/index.js:295:15
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at jsonParser (node_modules/body-parser/lib/types/json.js:100:7)
      at Layer.handleRequest (node_modules/router/lib/layer.js:152:17)
      at trimPrefix (node_modules/router/index.js:342:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at Function.handle (node_modules/router/index.js:186:3)
      at Function.handle (node_modules/express/lib/application.js:177:15)
      at Server.app (node_modules/express/lib/express.js:38:9)

  console.error
    Error: {
      message: '',
      statusCode: 500,
      stack: 'UnknownError: \n' +
        '    at /Users/hashim/Desktop/Development/FeastFriends/321-project/backend/tests/with-mocks/errorHandler.mock.test.ts:73:24\n' +
        '    at Layer.handleRequest (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/lib/layer.js:152:17)\n' +
        '    at next (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/lib/route.js:157:13)\n' +
        '    at Route.dispatch (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/lib/route.js:117:3)\n' +
        '    at handle (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/index.js:435:11)\n' +
        '    at Layer.handleRequest (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/lib/layer.js:152:17)\n' +
        '    at /Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/index.js:295:15\n' +
        '    at processParams (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/index.js:582:12)\n' +
        '    at next (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/index.js:291:5)\n' +
        '    at jsonParser (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/body-parser/lib/types/json.js:100:7)\n' +
        '    at Layer.handleRequest (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/lib/layer.js:152:17)\n' +
        '    at trimPrefix (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/index.js:342:13)\n' +
        '    at /Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/index.js:297:9\n' +
        '    at processParams (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/index.js:582:12)\n' +
        '    at next (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/index.js:291:5)\n' +
        '    at Function.handle (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/index.js:186:3)\n' +
        '    at Function.handle (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/express/lib/application.js:177:15)\n' +
        '    at Server.app (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/express/lib/express.js:38:9)\n' +
        '    at Server.emit (node:events:519:28)\n' +
        '    at parserOnIncoming (node:_http_server:1173:12)\n' +
        '    at HTTPParser.parserOnHeadersComplete (node:_http_common:121:17)',
      timestamp: '2025-11-09T07:24:46.550Z',
      path: '/test/no-message-error',
      method: 'GET'
    }

      90 |   }
      91 |
    > 92 |   console.error('Error:', {
         |           ^
      93 |     message: err.message,
      94 |     statusCode,
      95 |     stack: err.stack,

      at error (src/middleware/errorHandler.ts:92:11)
      at Layer.handleError (node_modules/router/lib/layer.js:116:17)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at next (node_modules/router/lib/route.js:132:14)
      at tests/with-mocks/errorHandler.mock.test.ts:75:5
      at Layer.handleRequest (node_modules/router/lib/layer.js:152:17)
      at next (node_modules/router/lib/route.js:157:13)
      at Route.dispatch (node_modules/router/lib/route.js:117:3)
      at handle (node_modules/router/index.js:435:11)
      at Layer.handleRequest (node_modules/router/lib/layer.js:152:17)
      at node_modules/router/index.js:295:15
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at jsonParser (node_modules/body-parser/lib/types/json.js:100:7)
      at Layer.handleRequest (node_modules/router/lib/layer.js:152:17)
      at trimPrefix (node_modules/router/index.js:342:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at Function.handle (node_modules/router/index.js:186:3)
      at Function.handle (node_modules/express/lib/application.js:177:15)
      at Server.app (node_modules/express/lib/express.js:38:9)

  console.error
    Error: {
      message: 'Error without name property',
      statusCode: 500,
      stack: undefined,
      timestamp: '2025-11-09T07:24:46.554Z',
      path: '/test/no-name-error',
      method: 'GET'
    }

      90 |   }
      91 |
    > 92 |   console.error('Error:', {
         |           ^
      93 |     message: err.message,
      94 |     statusCode,
      95 |     stack: err.stack,

      at error (src/middleware/errorHandler.ts:92:11)
      at Layer.handleError (node_modules/router/lib/layer.js:116:17)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at next (node_modules/router/lib/route.js:132:14)
      at tests/with-mocks/errorHandler.mock.test.ts:83:5
      at Layer.handleRequest (node_modules/router/lib/layer.js:152:17)
      at next (node_modules/router/lib/route.js:157:13)
      at Route.dispatch (node_modules/router/lib/route.js:117:3)
      at handle (node_modules/router/index.js:435:11)
      at Layer.handleRequest (node_modules/router/lib/layer.js:152:17)
      at node_modules/router/index.js:295:15
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at jsonParser (node_modules/body-parser/lib/types/json.js:100:7)
      at Layer.handleRequest (node_modules/router/lib/layer.js:152:17)
      at trimPrefix (node_modules/router/index.js:342:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at Function.handle (node_modules/router/index.js:186:3)
      at Function.handle (node_modules/express/lib/application.js:177:15)
      at Server.app (node_modules/express/lib/express.js:38:9)

  console.error
    Error: {
      message: 'ECONNREFUSED',
      statusCode: 500,
      stack: 'Error: ECONNREFUSED\n' +
        '    at /Users/hashim/Desktop/Development/FeastFriends/321-project/backend/tests/with-mocks/errorHandler.mock.test.ts:88:24\n' +
        '    at Layer.handleRequest (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/lib/layer.js:152:17)\n' +
        '    at next (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/lib/route.js:157:13)\n' +
        '    at Route.dispatch (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/lib/route.js:117:3)\n' +
        '    at handle (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/index.js:435:11)\n' +
        '    at Layer.handleRequest (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/lib/layer.js:152:17)\n' +
        '    at /Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/index.js:295:15\n' +
        '    at processParams (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/index.js:582:12)\n' +
        '    at next (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/index.js:291:5)\n' +
        '    at jsonParser (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/body-parser/lib/types/json.js:100:7)\n' +
        '    at Layer.handleRequest (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/lib/layer.js:152:17)\n' +
        '    at trimPrefix (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/index.js:342:13)\n' +
        '    at /Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/index.js:297:9\n' +
        '    at processParams (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/index.js:582:12)\n' +
        '    at next (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/index.js:291:5)\n' +
        '    at Function.handle (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/index.js:186:3)\n' +
        '    at Function.handle (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/express/lib/application.js:177:15)\n' +
        '    at Server.app (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/express/lib/express.js:38:9)\n' +
        '    at Server.emit (node:events:519:28)\n' +
        '    at parserOnIncoming (node:_http_server:1173:12)\n' +
        '    at HTTPParser.parserOnHeadersComplete (node:_http_common:121:17)',
      timestamp: '2025-11-09T07:24:46.557Z',
      path: '/test/network-error',
      method: 'GET'
    }

      90 |   }
      91 |
    > 92 |   console.error('Error:', {
         |           ^
      93 |     message: err.message,
      94 |     statusCode,
      95 |     stack: err.stack,

      at error (src/middleware/errorHandler.ts:92:11)
      at Layer.handleError (node_modules/router/lib/layer.js:116:17)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at next (node_modules/router/lib/route.js:132:14)
      at tests/with-mocks/errorHandler.mock.test.ts:90:5
      at Layer.handleRequest (node_modules/router/lib/layer.js:152:17)
      at next (node_modules/router/lib/route.js:157:13)
      at Route.dispatch (node_modules/router/lib/route.js:117:3)
      at handle (node_modules/router/index.js:435:11)
      at Layer.handleRequest (node_modules/router/lib/layer.js:152:17)
      at node_modules/router/index.js:295:15
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at jsonParser (node_modules/body-parser/lib/types/json.js:100:7)
      at Layer.handleRequest (node_modules/router/lib/layer.js:152:17)
      at trimPrefix (node_modules/router/index.js:342:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at Function.handle (node_modules/router/index.js:186:3)
      at Function.handle (node_modules/express/lib/application.js:177:15)
      at Server.app (node_modules/express/lib/express.js:38:9)

  console.error
    Error: {
      message: 'Something went wrong',
      statusCode: 500,
      stack: 'Error: Something went wrong\n' +
        '    at /Users/hashim/Desktop/Development/FeastFriends/321-project/backend/tests/with-mocks/errorHandler.mock.test.ts:68:10\n' +
        '    at Layer.handleRequest (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/lib/layer.js:152:17)\n' +
        '    at next (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/lib/route.js:157:13)\n' +
        '    at Route.dispatch (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/lib/route.js:117:3)\n' +
        '    at handle (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/index.js:435:11)\n' +
        '    at Layer.handleRequest (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/lib/layer.js:152:17)\n' +
        '    at /Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/index.js:295:15\n' +
        '    at processParams (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/index.js:582:12)\n' +
        '    at next (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/index.js:291:5)\n' +
        '    at jsonParser (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/body-parser/lib/types/json.js:100:7)\n' +
        '    at Layer.handleRequest (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/lib/layer.js:152:17)\n' +
        '    at trimPrefix (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/index.js:342:13)\n' +
        '    at /Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/index.js:297:9\n' +
        '    at processParams (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/index.js:582:12)\n' +
        '    at next (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/index.js:291:5)\n' +
        '    at Function.handle (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/index.js:186:3)\n' +
        '    at Function.handle (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/express/lib/application.js:177:15)\n' +
        '    at Server.app (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/express/lib/express.js:38:9)\n' +
        '    at Server.emit (node:events:519:28)\n' +
        '    at parserOnIncoming (node:_http_server:1173:12)\n' +
        '    at HTTPParser.parserOnHeadersComplete (node:_http_common:121:17)',
      timestamp: '2025-11-09T07:24:46.567Z',
      path: '/test/generic-error',
      method: 'GET'
    }

      90 |   }
      91 |
    > 92 |   console.error('Error:', {
         |           ^
      93 |     message: err.message,
      94 |     statusCode,
      95 |     stack: err.stack,

      at error (src/middleware/errorHandler.ts:92:11)
      at Layer.handleError (node_modules/router/lib/layer.js:116:17)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at next (node_modules/router/lib/route.js:132:14)
      at tests/with-mocks/errorHandler.mock.test.ts:68:5
      at Layer.handleRequest (node_modules/router/lib/layer.js:152:17)
      at next (node_modules/router/lib/route.js:157:13)
      at Route.dispatch (node_modules/router/lib/route.js:117:3)
      at handle (node_modules/router/index.js:435:11)
      at Layer.handleRequest (node_modules/router/lib/layer.js:152:17)
      at node_modules/router/index.js:295:15
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at jsonParser (node_modules/body-parser/lib/types/json.js:100:7)
      at Layer.handleRequest (node_modules/router/lib/layer.js:152:17)
      at trimPrefix (node_modules/router/index.js:342:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at Function.handle (node_modules/router/index.js:186:3)
      at Function.handle (node_modules/express/lib/application.js:177:15)
      at Server.app (node_modules/express/lib/express.js:38:9)

  console.error
    Error: {
      message: 'Something went wrong',
      statusCode: 500,
      stack: 'Error: Something went wrong\n' +
        '    at /Users/hashim/Desktop/Development/FeastFriends/321-project/backend/tests/with-mocks/errorHandler.mock.test.ts:68:10\n' +
        '    at Layer.handleRequest (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/lib/layer.js:152:17)\n' +
        '    at next (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/lib/route.js:157:13)\n' +
        '    at Route.dispatch (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/lib/route.js:117:3)\n' +
        '    at handle (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/index.js:435:11)\n' +
        '    at Layer.handleRequest (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/lib/layer.js:152:17)\n' +
        '    at /Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/index.js:295:15\n' +
        '    at processParams (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/index.js:582:12)\n' +
        '    at next (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/index.js:291:5)\n' +
        '    at jsonParser (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/body-parser/lib/types/json.js:100:7)\n' +
        '    at Layer.handleRequest (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/lib/layer.js:152:17)\n' +
        '    at trimPrefix (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/index.js:342:13)\n' +
        '    at /Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/index.js:297:9\n' +
        '    at processParams (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/index.js:582:12)\n' +
        '    at next (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/index.js:291:5)\n' +
        '    at Function.handle (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/index.js:186:3)\n' +
        '    at Function.handle (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/express/lib/application.js:177:15)\n' +
        '    at Server.app (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/express/lib/express.js:38:9)\n' +
        '    at Server.emit (node:events:519:28)\n' +
        '    at parserOnIncoming (node:_http_server:1173:12)\n' +
        '    at HTTPParser.parserOnHeadersComplete (node:_http_common:121:17)',
      timestamp: '2025-11-09T07:24:46.570Z',
      path: '/test/generic-error',
      method: 'GET'
    }

      90 |   }
      91 |
    > 92 |   console.error('Error:', {
         |           ^
      93 |     message: err.message,
      94 |     statusCode,
      95 |     stack: err.stack,

      at error (src/middleware/errorHandler.ts:92:11)
      at Layer.handleError (node_modules/router/lib/layer.js:116:17)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at next (node_modules/router/lib/route.js:132:14)
      at tests/with-mocks/errorHandler.mock.test.ts:68:5
      at Layer.handleRequest (node_modules/router/lib/layer.js:152:17)
      at next (node_modules/router/lib/route.js:157:13)
      at Route.dispatch (node_modules/router/lib/route.js:117:3)
      at handle (node_modules/router/index.js:435:11)
      at Layer.handleRequest (node_modules/router/lib/layer.js:152:17)
      at node_modules/router/index.js:295:15
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at jsonParser (node_modules/body-parser/lib/types/json.js:100:7)
      at Layer.handleRequest (node_modules/router/lib/layer.js:152:17)
      at trimPrefix (node_modules/router/index.js:342:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at Function.handle (node_modules/router/index.js:186:3)
      at Function.handle (node_modules/express/lib/application.js:177:15)
      at Server.app (node_modules/express/lib/express.js:38:9)

  console.error
    Error: {
      message: 'Validation failed',
      statusCode: 400,
      stack: 'ValidationError: Validation failed\n' +
        '    at /Users/hashim/Desktop/Development/FeastFriends/321-project/backend/tests/with-mocks/errorHandler.mock.test.ts:38:24\n' +
        '    at Layer.handleRequest (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/lib/layer.js:152:17)\n' +
        '    at next (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/lib/route.js:157:13)\n' +
        '    at Route.dispatch (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/lib/route.js:117:3)\n' +
        '    at handle (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/index.js:435:11)\n' +
        '    at Layer.handleRequest (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/lib/layer.js:152:17)\n' +
        '    at /Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/index.js:295:15\n' +
        '    at processParams (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/index.js:582:12)\n' +
        '    at next (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/index.js:291:5)\n' +
        '    at jsonParser (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/body-parser/lib/types/json.js:100:7)\n' +
        '    at Layer.handleRequest (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/lib/layer.js:152:17)\n' +
        '    at trimPrefix (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/index.js:342:13)\n' +
        '    at /Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/index.js:297:9\n' +
        '    at processParams (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/index.js:582:12)\n' +
        '    at next (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/index.js:291:5)\n' +
        '    at Function.handle (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/index.js:186:3)\n' +
        '    at Function.handle (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/express/lib/application.js:177:15)\n' +
        '    at Server.app (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/express/lib/express.js:38:9)\n' +
        '    at Server.emit (node:events:519:28)\n' +
        '    at parserOnIncoming (node:_http_server:1173:12)\n' +
        '    at HTTPParser.parserOnHeadersComplete (node:_http_common:121:17)',
      timestamp: '2025-11-09T07:24:46.572Z',
      path: '/test/validation-error',
      method: 'GET'
    }

      90 |   }
      91 |
    > 92 |   console.error('Error:', {
         |           ^
      93 |     message: err.message,
      94 |     statusCode,
      95 |     stack: err.stack,

      at error (src/middleware/errorHandler.ts:92:11)
      at Layer.handleError (node_modules/router/lib/layer.js:116:17)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at next (node_modules/router/lib/route.js:132:14)
      at tests/with-mocks/errorHandler.mock.test.ts:45:5
      at Layer.handleRequest (node_modules/router/lib/layer.js:152:17)
      at next (node_modules/router/lib/route.js:157:13)
      at Route.dispatch (node_modules/router/lib/route.js:117:3)
      at handle (node_modules/router/index.js:435:11)
      at Layer.handleRequest (node_modules/router/lib/layer.js:152:17)
      at node_modules/router/index.js:295:15
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at jsonParser (node_modules/body-parser/lib/types/json.js:100:7)
      at Layer.handleRequest (node_modules/router/lib/layer.js:152:17)
      at trimPrefix (node_modules/router/index.js:342:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at Function.handle (node_modules/router/index.js:186:3)
      at Function.handle (node_modules/express/lib/application.js:177:15)
      at Server.app (node_modules/express/lib/express.js:38:9)

  console.error
    Error: {
      message: 'E11000 duplicate key error',
      statusCode: 409,
      stack: 'MongoServerError: E11000 duplicate key error\n' +
        '    at /Users/hashim/Desktop/Development/FeastFriends/321-project/backend/tests/with-mocks/errorHandler.mock.test.ts:59:24\n' +
        '    at Layer.handleRequest (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/lib/layer.js:152:17)\n' +
        '    at next (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/lib/route.js:157:13)\n' +
        '    at Route.dispatch (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/lib/route.js:117:3)\n' +
        '    at handle (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/index.js:435:11)\n' +
        '    at Layer.handleRequest (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/lib/layer.js:152:17)\n' +
        '    at /Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/index.js:295:15\n' +
        '    at processParams (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/index.js:582:12)\n' +
        '    at next (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/index.js:291:5)\n' +
        '    at jsonParser (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/body-parser/lib/types/json.js:100:7)\n' +
        '    at Layer.handleRequest (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/lib/layer.js:152:17)\n' +
        '    at trimPrefix (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/index.js:342:13)\n' +
        '    at /Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/index.js:297:9\n' +
        '    at processParams (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/index.js:582:12)\n' +
        '    at next (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/index.js:291:5)\n' +
        '    at Function.handle (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/index.js:186:3)\n' +
        '    at Function.handle (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/express/lib/application.js:177:15)\n' +
        '    at Server.app (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/express/lib/express.js:38:9)\n' +
        '    at Server.emit (node:events:519:28)\n' +
        '    at parserOnIncoming (node:_http_server:1173:12)\n' +
        '    at HTTPParser.parserOnHeadersComplete (node:_http_common:121:17)',
      timestamp: '2025-11-09T07:24:46.574Z',
      path: '/test/duplicate-error',
      method: 'GET'
    }

      90 |   }
      91 |
    > 92 |   console.error('Error:', {
         |           ^
      93 |     message: err.message,
      94 |     statusCode,
      95 |     stack: err.stack,

      at error (src/middleware/errorHandler.ts:92:11)
      at Layer.handleError (node_modules/router/lib/layer.js:116:17)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at next (node_modules/router/lib/route.js:132:14)
      at tests/with-mocks/errorHandler.mock.test.ts:63:5
      at Layer.handleRequest (node_modules/router/lib/layer.js:152:17)
      at next (node_modules/router/lib/route.js:157:13)
      at Route.dispatch (node_modules/router/lib/route.js:117:3)
      at handle (node_modules/router/index.js:435:11)
      at Layer.handleRequest (node_modules/router/lib/layer.js:152:17)
      at node_modules/router/index.js:295:15
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at jsonParser (node_modules/body-parser/lib/types/json.js:100:7)
      at Layer.handleRequest (node_modules/router/lib/layer.js:152:17)
      at trimPrefix (node_modules/router/index.js:342:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at Function.handle (node_modules/router/index.js:186:3)
      at Function.handle (node_modules/express/lib/application.js:177:15)
      at Server.app (node_modules/express/lib/express.js:38:9)

  console.error
    Error: {
      message: 'Something went wrong',
      statusCode: 500,
      stack: 'Error: Something went wrong\n' +
        '    at /Users/hashim/Desktop/Development/FeastFriends/321-project/backend/tests/with-mocks/errorHandler.mock.test.ts:68:10\n' +
        '    at Layer.handleRequest (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/lib/layer.js:152:17)\n' +
        '    at next (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/lib/route.js:157:13)\n' +
        '    at Route.dispatch (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/lib/route.js:117:3)\n' +
        '    at handle (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/index.js:435:11)\n' +
        '    at Layer.handleRequest (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/lib/layer.js:152:17)\n' +
        '    at /Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/index.js:295:15\n' +
        '    at processParams (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/index.js:582:12)\n' +
        '    at next (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/index.js:291:5)\n' +
        '    at jsonParser (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/body-parser/lib/types/json.js:100:7)\n' +
        '    at Layer.handleRequest (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/lib/layer.js:152:17)\n' +
        '    at trimPrefix (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/index.js:342:13)\n' +
        '    at /Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/index.js:297:9\n' +
        '    at processParams (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/index.js:582:12)\n' +
        '    at next (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/index.js:291:5)\n' +
        '    at Function.handle (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/index.js:186:3)\n' +
        '    at Function.handle (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/express/lib/application.js:177:15)\n' +
        '    at Server.app (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/express/lib/express.js:38:9)\n' +
        '    at Server.emit (node:events:519:28)\n' +
        '    at parserOnIncoming (node:_http_server:1173:12)\n' +
        '    at HTTPParser.parserOnHeadersComplete (node:_http_common:121:17)',
      timestamp: '2025-11-09T07:24:46.576Z',
      path: '/test/generic-error',
      method: 'GET'
    }

      90 |   }
      91 |
    > 92 |   console.error('Error:', {
         |           ^
      93 |     message: err.message,
      94 |     statusCode,
      95 |     stack: err.stack,

      at error (src/middleware/errorHandler.ts:92:11)
      at Layer.handleError (node_modules/router/lib/layer.js:116:17)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at next (node_modules/router/lib/route.js:132:14)
      at tests/with-mocks/errorHandler.mock.test.ts:68:5
      at Layer.handleRequest (node_modules/router/lib/layer.js:152:17)
      at next (node_modules/router/lib/route.js:157:13)
      at Route.dispatch (node_modules/router/lib/route.js:117:3)
      at handle (node_modules/router/index.js:435:11)
      at Layer.handleRequest (node_modules/router/lib/layer.js:152:17)
      at node_modules/router/index.js:295:15
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at jsonParser (node_modules/body-parser/lib/types/json.js:100:7)
      at Layer.handleRequest (node_modules/router/lib/layer.js:152:17)
      at trimPrefix (node_modules/router/index.js:342:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at Function.handle (node_modules/router/index.js:186:3)
      at Function.handle (node_modules/express/lib/application.js:177:15)
      at Server.app (node_modules/express/lib/express.js:38:9)

  console.error
    Error: {
      message: 'Cast to ObjectId failed',
      statusCode: 400,
      stack: 'CastError: Cast to ObjectId failed\n' +
        '    at /Users/hashim/Desktop/Development/FeastFriends/321-project/backend/tests/with-mocks/errorHandler.mock.test.ts:50:24\n' +
        '    at Layer.handleRequest (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/lib/layer.js:152:17)\n' +
        '    at next (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/lib/route.js:157:13)\n' +
        '    at Route.dispatch (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/lib/route.js:117:3)\n' +
        '    at handle (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/index.js:435:11)\n' +
        '    at Layer.handleRequest (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/lib/layer.js:152:17)\n' +
        '    at /Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/index.js:295:15\n' +
        '    at processParams (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/index.js:582:12)\n' +
        '    at next (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/index.js:291:5)\n' +
        '    at jsonParser (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/body-parser/lib/types/json.js:100:7)\n' +
        '    at Layer.handleRequest (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/lib/layer.js:152:17)\n' +
        '    at trimPrefix (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/index.js:342:13)\n' +
        '    at /Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/index.js:297:9\n' +
        '    at processParams (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/index.js:582:12)\n' +
        '    at next (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/index.js:291:5)\n' +
        '    at Function.handle (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/index.js:186:3)\n' +
        '    at Function.handle (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/express/lib/application.js:177:15)\n' +
        '    at Server.app (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/express/lib/express.js:38:9)\n' +
        '    at Server.emit (node:events:519:28)\n' +
        '    at parserOnIncoming (node:_http_server:1173:12)\n' +
        '    at HTTPParser.parserOnHeadersComplete (node:_http_common:121:17)',
      timestamp: '2025-11-09T07:24:46.578Z',
      path: '/test/cast-error',
      method: 'GET'
    }

      90 |   }
      91 |
    > 92 |   console.error('Error:', {
         |           ^
      93 |     message: err.message,
      94 |     statusCode,
      95 |     stack: err.stack,

      at error (src/middleware/errorHandler.ts:92:11)
      at Layer.handleError (node_modules/router/lib/layer.js:116:17)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at next (node_modules/router/lib/route.js:132:14)
      at tests/with-mocks/errorHandler.mock.test.ts:54:5
      at Layer.handleRequest (node_modules/router/lib/layer.js:152:17)
      at next (node_modules/router/lib/route.js:157:13)
      at Route.dispatch (node_modules/router/lib/route.js:117:3)
      at handle (node_modules/router/index.js:435:11)
      at Layer.handleRequest (node_modules/router/lib/layer.js:152:17)
      at node_modules/router/index.js:295:15
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at jsonParser (node_modules/body-parser/lib/types/json.js:100:7)
      at Layer.handleRequest (node_modules/router/lib/layer.js:152:17)
      at trimPrefix (node_modules/router/index.js:342:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at Function.handle (node_modules/router/index.js:186:3)
      at Function.handle (node_modules/express/lib/application.js:177:15)
      at Server.app (node_modules/express/lib/express.js:38:9)

  console.error
    Error: {
      message: 'Error: aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa'... 7 more characters,
      statusCode: 500,
      stack: 'Error: Error: aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa'... 1687 more characters,
      timestamp: '2025-11-09T07:24:46.585Z',
      path: '/test/long-error',
      method: 'GET'
    }

      90 |   }
      91 |
    > 92 |   console.error('Error:', {
         |           ^
      93 |     message: err.message,
      94 |     statusCode,
      95 |     stack: err.stack,

      at error (src/middleware/errorHandler.ts:92:11)
      at Layer.handleError (node_modules/router/lib/layer.js:116:17)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at next (node_modules/router/lib/route.js:132:14)
      at tests/with-mocks/errorHandler.mock.test.ts:538:9
      at Layer.handleRequest (node_modules/router/lib/layer.js:152:17)
      at next (node_modules/router/lib/route.js:157:13)
      at Route.dispatch (node_modules/router/lib/route.js:117:3)
      at handle (node_modules/router/index.js:435:11)
      at Layer.handleRequest (node_modules/router/lib/layer.js:152:17)
      at node_modules/router/index.js:295:15
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at Function.handle (node_modules/router/index.js:186:3)
      at Function.handle (node_modules/express/lib/application.js:177:15)
      at Server.app (node_modules/express/lib/express.js:38:9)

  console.error
    Error: {
      message: `Error: <script>alert("xss")</script> & "quotes" 'apostrophe'`,
      statusCode: 500,
      stack: `Error: Error: <script>alert("xss")</script> & "quotes" 'apostrophe'\n` +
        '    at /Users/hashim/Desktop/Development/FeastFriends/321-project/backend/tests/with-mocks/errorHandler.mock.test.ts:558:14\n' +
        '    at Layer.handleRequest (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/lib/layer.js:152:17)\n' +
        '    at next (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/lib/route.js:157:13)\n' +
        '    at Route.dispatch (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/lib/route.js:117:3)\n' +
        '    at handle (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/index.js:435:11)\n' +
        '    at Layer.handleRequest (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/lib/layer.js:152:17)\n' +
        '    at /Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/index.js:295:15\n' +
        '    at processParams (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/index.js:582:12)\n' +
        '    at next (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/index.js:291:5)\n' +
        '    at Function.handle (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/index.js:186:3)\n' +
        '    at Function.handle (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/express/lib/application.js:177:15)\n' +
        '    at Server.app (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/express/lib/express.js:38:9)\n' +
        '    at Server.emit (node:events:519:28)\n' +
        '    at parserOnIncoming (node:_http_server:1173:12)\n' +
        '    at HTTPParser.parserOnHeadersComplete (node:_http_common:121:17)',
      timestamp: '2025-11-09T07:24:46.587Z',
      path: '/test/special-chars',
      method: 'GET'
    }

      90 |   }
      91 |
    > 92 |   console.error('Error:', {
         |           ^
      93 |     message: err.message,
      94 |     statusCode,
      95 |     stack: err.stack,

      at error (src/middleware/errorHandler.ts:92:11)
      at Layer.handleError (node_modules/router/lib/layer.js:116:17)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at next (node_modules/router/lib/route.js:132:14)
      at tests/with-mocks/errorHandler.mock.test.ts:558:9
      at Layer.handleRequest (node_modules/router/lib/layer.js:152:17)
      at next (node_modules/router/lib/route.js:157:13)
      at Route.dispatch (node_modules/router/lib/route.js:117:3)
      at handle (node_modules/router/index.js:435:11)
      at Layer.handleRequest (node_modules/router/lib/layer.js:152:17)
      at node_modules/router/index.js:295:15
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at Function.handle (node_modules/router/index.js:186:3)
      at Function.handle (node_modules/express/lib/application.js:177:15)
      at Server.app (node_modules/express/lib/express.js:38:9)

  console.error
    Error: {
      message: 'Cannot read property of undefined',
      statusCode: 500,
      stack: 'TypeError: Cannot read property of undefined\n' +
        '    at /Users/hashim/Desktop/Development/FeastFriends/321-project/backend/tests/with-mocks/errorHandler.mock.test.ts:576:23\n' +
        '    at Layer.handleRequest (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/lib/layer.js:152:17)\n' +
        '    at next (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/lib/route.js:157:13)\n' +
        '    at Route.dispatch (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/lib/route.js:117:3)\n' +
        '    at handle (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/index.js:435:11)\n' +
        '    at Layer.handleRequest (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/lib/layer.js:152:17)\n' +
        '    at /Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/index.js:295:15\n' +
        '    at processParams (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/index.js:582:12)\n' +
        '    at next (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/index.js:291:5)\n' +
        '    at Function.handle (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/index.js:186:3)\n' +
        '    at Function.handle (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/express/lib/application.js:177:15)\n' +
        '    at Server.app (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/express/lib/express.js:38:9)\n' +
        '    at Server.emit (node:events:519:28)\n' +
        '    at parserOnIncoming (node:_http_server:1173:12)\n' +
        '    at HTTPParser.parserOnHeadersComplete (node:_http_common:121:17)',
      timestamp: '2025-11-09T07:24:46.590Z',
      path: '/test/type-error',
      method: 'GET'
    }

      90 |   }
      91 |
    > 92 |   console.error('Error:', {
         |           ^
      93 |     message: err.message,
      94 |     statusCode,
      95 |     stack: err.stack,

      at error (src/middleware/errorHandler.ts:92:11)
      at Layer.handleError (node_modules/router/lib/layer.js:116:17)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at next (node_modules/router/lib/route.js:132:14)
      at tests/with-mocks/errorHandler.mock.test.ts:577:9
      at Layer.handleRequest (node_modules/router/lib/layer.js:152:17)
      at next (node_modules/router/lib/route.js:157:13)
      at Route.dispatch (node_modules/router/lib/route.js:117:3)
      at handle (node_modules/router/index.js:435:11)
      at Layer.handleRequest (node_modules/router/lib/layer.js:152:17)
      at node_modules/router/index.js:295:15
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at Function.handle (node_modules/router/index.js:186:3)
      at Function.handle (node_modules/express/lib/application.js:177:15)
      at Server.app (node_modules/express/lib/express.js:38:9)

  console.error
    Error: {
      message: 'Variable is not defined',
      statusCode: 500,
      stack: 'ReferenceError: Variable is not defined\n' +
        '    at /Users/hashim/Desktop/Development/FeastFriends/321-project/backend/tests/with-mocks/errorHandler.mock.test.ts:595:23\n' +
        '    at Layer.handleRequest (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/lib/layer.js:152:17)\n' +
        '    at next (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/lib/route.js:157:13)\n' +
        '    at Route.dispatch (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/lib/route.js:117:3)\n' +
        '    at handle (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/index.js:435:11)\n' +
        '    at Layer.handleRequest (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/lib/layer.js:152:17)\n' +
        '    at /Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/index.js:295:15\n' +
        '    at processParams (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/index.js:582:12)\n' +
        '    at next (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/index.js:291:5)\n' +
        '    at Function.handle (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/index.js:186:3)\n' +
        '    at Function.handle (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/express/lib/application.js:177:15)\n' +
        '    at Server.app (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/express/lib/express.js:38:9)\n' +
        '    at Server.emit (node:events:519:28)\n' +
        '    at parserOnIncoming (node:_http_server:1173:12)\n' +
        '    at HTTPParser.parserOnHeadersComplete (node:_http_common:121:17)',
      timestamp: '2025-11-09T07:24:46.593Z',
      path: '/test/reference-error',
      method: 'GET'
    }

      90 |   }
      91 |
    > 92 |   console.error('Error:', {
         |           ^
      93 |     message: err.message,
      94 |     statusCode,
      95 |     stack: err.stack,

      at error (src/middleware/errorHandler.ts:92:11)
      at Layer.handleError (node_modules/router/lib/layer.js:116:17)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at next (node_modules/router/lib/route.js:132:14)
      at tests/with-mocks/errorHandler.mock.test.ts:596:9
      at Layer.handleRequest (node_modules/router/lib/layer.js:152:17)
      at next (node_modules/router/lib/route.js:157:13)
      at Route.dispatch (node_modules/router/lib/route.js:117:3)
      at handle (node_modules/router/index.js:435:11)
      at Layer.handleRequest (node_modules/router/lib/layer.js:152:17)
      at node_modules/router/index.js:295:15
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at Function.handle (node_modules/router/index.js:186:3)
      at Function.handle (node_modules/express/lib/application.js:177:15)
      at Server.app (node_modules/express/lib/express.js:38:9)

  console.error
    Error: {
      message: 'PUT error',
      statusCode: 500,
      stack: 'Error: PUT error\n' +
        '    at /Users/hashim/Desktop/Development/FeastFriends/321-project/backend/tests/with-mocks/errorHandler.mock.test.ts:644:14\n' +
        '    at Layer.handleRequest (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/lib/layer.js:152:17)\n' +
        '    at next (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/lib/route.js:157:13)\n' +
        '    at Route.dispatch (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/lib/route.js:117:3)\n' +
        '    at handle (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/index.js:435:11)\n' +
        '    at Layer.handleRequest (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/lib/layer.js:152:17)\n' +
        '    at /Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/index.js:295:15\n' +
        '    at processParams (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/index.js:582:12)\n' +
        '    at next (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/index.js:291:5)\n' +
        '    at /Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/body-parser/lib/read.js:132:5\n' +
        '    at AsyncResource.runInAsyncScope (node:async_hooks:214:14)\n' +
        '    at invokeCallback (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/raw-body/index.js:238:16)\n' +
        '    at done (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/raw-body/index.js:227:7)\n' +
        '    at IncomingMessage.onEnd (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/raw-body/index.js:287:7)\n' +
        '    at IncomingMessage.emit (node:events:519:28)\n' +
        '    at endReadableNT (node:internal/streams/readable:1698:12)\n' +
        '    at processTicksAndRejections (node:internal/process/task_queues:90:21)',
      timestamp: '2025-11-09T07:24:46.599Z',
      path: '/test/put-error',
      method: 'PUT'
    }

      90 |   }
      91 |
    > 92 |   console.error('Error:', {
         |           ^
      93 |     message: err.message,
      94 |     statusCode,
      95 |     stack: err.stack,

      at error (src/middleware/errorHandler.ts:92:11)
      at Layer.handleError (node_modules/router/lib/layer.js:116:17)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at next (node_modules/router/lib/route.js:132:14)
      at tests/with-mocks/errorHandler.mock.test.ts:644:9
      at Layer.handleRequest (node_modules/router/lib/layer.js:152:17)
      at next (node_modules/router/lib/route.js:157:13)
      at Route.dispatch (node_modules/router/lib/route.js:117:3)
      at handle (node_modules/router/index.js:435:11)
      at Layer.handleRequest (node_modules/router/lib/layer.js:152:17)
      at node_modules/router/index.js:295:15
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at node_modules/body-parser/lib/read.js:132:5
      at invokeCallback (node_modules/raw-body/index.js:238:16)
      at done (node_modules/raw-body/index.js:227:7)
      at IncomingMessage.onEnd (node_modules/raw-body/index.js:287:7)

  console.error
    Error: {
      message: 'DELETE error',
      statusCode: 500,
      stack: 'Error: DELETE error\n' +
        '    at /Users/hashim/Desktop/Development/FeastFriends/321-project/backend/tests/with-mocks/errorHandler.mock.test.ts:663:14\n' +
        '    at Layer.handleRequest (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/lib/layer.js:152:17)\n' +
        '    at next (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/lib/route.js:157:13)\n' +
        '    at Route.dispatch (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/lib/route.js:117:3)\n' +
        '    at handle (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/index.js:435:11)\n' +
        '    at Layer.handleRequest (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/lib/layer.js:152:17)\n' +
        '    at /Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/index.js:295:15\n' +
        '    at processParams (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/index.js:582:12)\n' +
        '    at next (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/index.js:291:5)\n' +
        '    at Function.handle (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/index.js:186:3)\n' +
        '    at Function.handle (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/express/lib/application.js:177:15)\n' +
        '    at Server.app (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/express/lib/express.js:38:9)\n' +
        '    at Server.emit (node:events:519:28)\n' +
        '    at parserOnIncoming (node:_http_server:1173:12)\n' +
        '    at HTTPParser.parserOnHeadersComplete (node:_http_common:121:17)',
      timestamp: '2025-11-09T07:24:46.601Z',
      path: '/test/delete-error',
      method: 'DELETE'
    }

      90 |   }
      91 |
    > 92 |   console.error('Error:', {
         |           ^
      93 |     message: err.message,
      94 |     statusCode,
      95 |     stack: err.stack,

      at error (src/middleware/errorHandler.ts:92:11)
      at Layer.handleError (node_modules/router/lib/layer.js:116:17)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at next (node_modules/router/lib/route.js:132:14)
      at tests/with-mocks/errorHandler.mock.test.ts:663:9
      at Layer.handleRequest (node_modules/router/lib/layer.js:152:17)
      at next (node_modules/router/lib/route.js:157:13)
      at Route.dispatch (node_modules/router/lib/route.js:117:3)
      at handle (node_modules/router/index.js:435:11)
      at Layer.handleRequest (node_modules/router/lib/layer.js:152:17)
      at node_modules/router/index.js:295:15
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at Function.handle (node_modules/router/index.js:186:3)
      at Function.handle (node_modules/express/lib/application.js:177:15)
      at Server.app (node_modules/express/lib/express.js:38:9)

  console.log
    
    üßπ Cleaning up after tests...

      at Object.<anonymous> (tests/with-mocks/errorHandler.mock.test.ts:110:13)

  console.warn
    MongoDB disconnected. Attempting to reconnect...

      28 |
      29 |     mongoose.connection.on('disconnected', () => {
    > 30 |       console.warn('MongoDB disconnected. Attempting to reconnect...');
         |               ^
      31 |     });
      32 |
      33 |     mongoose.connection.on('reconnected', () => {

      at NativeConnection.<anonymous> (src/config/database.ts:30:15)
      at NativeConnection.set (node_modules/mongoose/lib/connection.js:145:12)
      at NativeConnection.onClose (node_modules/mongoose/lib/connection.js:1315:19)
      at NativeConnection._close (node_modules/mongoose/lib/connection.js:1264:12)
      at disconnectDatabase (src/config/database.ts:55:5)
      at Object.<anonymous> (tests/with-mocks/errorHandler.mock.test.ts:111:5)

  console.log
    MongoDB disconnected successfully

      at disconnectDatabase (src/config/database.ts:56:13)

  console.log
    ‚úÖ Cleanup complete.

      at Object.<anonymous> (tests/with-mocks/errorHandler.mock.test.ts:112:13)

  console.error
    Error: {
      message: 'Simulated controller failure',
      statusCode: 500,
      stack: 'Error: Simulated controller failure\n' +
        '    at /Users/hashim/Desktop/Development/FeastFriends/321-project/backend/tests/with-mocks/errorHandler.mock.test.ts:693:15\n' +
        '    at Layer.handleRequest (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/lib/layer.js:152:17)\n' +
        '    at next (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/lib/route.js:157:13)\n' +
        '    at Route.dispatch (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/lib/route.js:117:3)\n' +
        '    at handle (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/index.js:435:11)\n' +
        '    at Layer.handleRequest (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/lib/layer.js:152:17)\n' +
        '    at /Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/index.js:295:15\n' +
        '    at processParams (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/index.js:582:12)\n' +
        '    at next (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/index.js:291:5)\n' +
        '    at jsonParser (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/body-parser/lib/types/json.js:100:7)\n' +
        '    at Layer.handleRequest (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/lib/layer.js:152:17)\n' +
        '    at trimPrefix (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/index.js:342:13)\n' +
        '    at /Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/index.js:297:9\n' +
        '    at processParams (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/index.js:582:12)\n' +
        '    at next (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/index.js:291:5)\n' +
        '    at Function.handle (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/index.js:186:3)\n' +
        '    at Function.handle (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/express/lib/application.js:177:15)\n' +
        '    at Server.app (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/express/lib/express.js:38:9)\n' +
        '    at Server.emit (node:events:519:28)\n' +
        '    at parserOnIncoming (node:_http_server:1173:12)\n' +
        '    at HTTPParser.parserOnHeadersComplete (node:_http_common:121:17)',
      timestamp: '2025-11-09T07:24:46.608Z',
      path: '/test/controller-error',
      method: 'GET'
    }

      90 |   }
      91 |
    > 92 |   console.error('Error:', {
         |           ^
      93 |     message: err.message,
      94 |     statusCode,
      95 |     stack: err.stack,

      at error (src/middleware/errorHandler.ts:92:11)
      at Layer.handleError (node_modules/router/lib/layer.js:116:17)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at next (node_modules/router/lib/route.js:132:14)
      at tests/with-mocks/errorHandler.mock.test.ts:695:9
      at Layer.handleRequest (node_modules/router/lib/layer.js:152:17)
      at next (node_modules/router/lib/route.js:157:13)
      at Route.dispatch (node_modules/router/lib/route.js:117:3)
      at handle (node_modules/router/index.js:435:11)
      at Layer.handleRequest (node_modules/router/lib/layer.js:152:17)
      at node_modules/router/index.js:295:15
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at jsonParser (node_modules/body-parser/lib/types/json.js:100:7)
      at Layer.handleRequest (node_modules/router/lib/layer.js:152:17)
      at trimPrefix (node_modules/router/index.js:342:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at Function.handle (node_modules/router/index.js:186:3)
      at Function.handle (node_modules/express/lib/application.js:177:15)
      at Server.app (node_modules/express/lib/express.js:38:9)

  console.error
    Error: {
      message: 'Route /test/non-existent-route not found',
      statusCode: 404,
      stack: 'AppError: Route /test/non-existent-route not found\n' +
        '    at notFoundHandler (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/src/middleware/errorHandler.ts:118:17)\n' +
        '    at Layer.handleRequest (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/lib/layer.js:152:17)\n' +
        '    at trimPrefix (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/index.js:342:13)\n' +
        '    at /Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/index.js:297:9\n' +
        '    at processParams (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/index.js:582:12)\n' +
        '    at next (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/index.js:291:5)\n' +
        '    at jsonParser (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/body-parser/lib/types/json.js:100:7)\n' +
        '    at Layer.handleRequest (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/lib/layer.js:152:17)\n' +
        '    at trimPrefix (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/index.js:342:13)\n' +
        '    at /Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/index.js:297:9\n' +
        '    at processParams (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/index.js:582:12)\n' +
        '    at next (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/index.js:291:5)\n' +
        '    at Function.handle (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/index.js:186:3)\n' +
        '    at Function.handle (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/express/lib/application.js:177:15)\n' +
        '    at Server.app (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/express/lib/express.js:38:9)\n' +
        '    at Server.emit (node:events:519:28)\n' +
        '    at parserOnIncoming (node:_http_server:1173:12)\n' +
        '    at HTTPParser.parserOnHeadersComplete (node:_http_common:121:17)',
      timestamp: '2025-11-09T07:24:46.613Z',
      path: '/test/non-existent-route',
      method: 'GET'
    }

      90 |   }
      91 |
    > 92 |   console.error('Error:', {
         |           ^
      93 |     message: err.message,
      94 |     statusCode,
      95 |     stack: err.stack,

      at error (src/middleware/errorHandler.ts:92:11)
      at Layer.handleError (node_modules/router/lib/layer.js:116:17)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at next (src/middleware/errorHandler.ts:119:3)
      at Layer.handleRequest (node_modules/router/lib/layer.js:152:17)
      at trimPrefix (node_modules/router/index.js:342:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at jsonParser (node_modules/body-parser/lib/types/json.js:100:7)
      at Layer.handleRequest (node_modules/router/lib/layer.js:152:17)
      at trimPrefix (node_modules/router/index.js:342:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at Function.handle (node_modules/router/index.js:186:3)
      at Function.handle (node_modules/express/lib/application.js:177:15)
      at Server.app (node_modules/express/lib/express.js:38:9)

  console.error
    Error: {
      message: 'Async handler error',
      statusCode: 500,
      stack: 'Error: Async handler error\n' +
        '    at asyncRouteHandler (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/tests/with-mocks/errorHandler.mock.test.ts:765:13)\n' +
        '    at fn (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/src/middleware/errorHandler.ts:58:15)\n' +
        '    at /Users/hashim/Desktop/Development/FeastFriends/321-project/backend/src/middleware/errorHandler.ts:62:6\n' +
        '    at Layer.handleRequest (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/lib/layer.js:152:17)\n' +
        '    at next (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/lib/route.js:157:13)\n' +
        '    at Route.dispatch (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/lib/route.js:117:3)\n' +
        '    at handle (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/index.js:435:11)\n' +
        '    at Layer.handleRequest (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/lib/layer.js:152:17)\n' +
        '    at /Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/index.js:295:15\n' +
        '    at processParams (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/index.js:582:12)\n' +
        '    at next (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/index.js:291:5)\n' +
        '    at jsonParser (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/body-parser/lib/types/json.js:100:7)\n' +
        '    at Layer.handleRequest (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/lib/layer.js:152:17)\n' +
        '    at trimPrefix (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/index.js:342:13)\n' +
        '    at /Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/index.js:297:9\n' +
        '    at processParams (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/index.js:582:12)\n' +
        '    at next (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/index.js:291:5)\n' +
        '    at Function.handle (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/index.js:186:3)\n' +
        '    at Function.handle (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/express/lib/application.js:177:15)\n' +
        '    at Server.app (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/express/lib/express.js:38:9)\n' +
        '    at Server.emit (node:events:519:28)\n' +
        '    at parserOnIncoming (node:_http_server:1173:12)\n' +
        '    at HTTPParser.parserOnHeadersComplete (node:_http_common:121:17)',
      timestamp: '2025-11-09T07:24:46.616Z',
      path: '/test/async-error',
      method: 'GET'
    }

      90 |   }
      91 |
    > 92 |   console.error('Error:', {
         |           ^
      93 |     message: err.message,
      94 |     statusCode,
      95 |     stack: err.stack,

      at error (src/middleware/errorHandler.ts:92:11)
      at Layer.handleError (node_modules/router/lib/layer.js:116:17)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at next (node_modules/router/lib/route.js:132:14)
      at next (src/middleware/errorHandler.ts:60:9)

  console.log
    Test suite completed.

      at Object.<anonymous> (tests/setup.ts:14:11)

PASS tests/with-mocks/errorHandler.mock.test.ts
  Error Handler Middleware - All Error Types
    AppError - Custom Application Errors
      ‚úì should return 400 for custom AppError (26 ms)
      ‚úì should handle AppError with 404 status (5 ms)
      ‚úì should handle AppError with 403 status (7 ms)
      ‚úì should handle AppError with 409 status (15 ms)
      ‚úì should handle AppError with 401 status (10 ms)
    Mongoose ValidationError
      ‚úì should return 400 for Mongoose validation error (5 ms)
      ‚úì should handle real Mongoose validation error from User model (2 ms)
    Mongoose CastError
      ‚úì should return 400 for Mongoose CastError (5 ms)
      ‚úì should handle CastError from real User.findById with invalid ID (2 ms)
    MongoDB Duplicate Key Error (11000)
      ‚úì should return 409 for MongoDB duplicate key error (8 ms)
      ‚úì should handle real duplicate key error with User model (24 ms)
    Generic Errors
      ‚úì should return 500 for generic error (4 ms)
      ‚úì should return 500 with default message for error without message (3 ms)
      ‚úì should return 500 with "Error" fallback when error has no name property (4 ms)
    Network and Connection Errors
      ‚úì should handle network connection errors (5 ms)
      ‚úì should handle MongoDB connection errors
    Error Handler Response Format
      ‚úì should include timestamp in error logs (2 ms)
      ‚úì should include request path and method in error logs (2 ms)
      ‚úì should include stack trace in development mode (2 ms)
      ‚úì should NOT include stack trace in production mode (2 ms)
    Multiple Error Types in Sequence
      ‚úì should handle different error types correctly in sequence (11 ms)
    Edge Cases
      ‚úì should handle null error gracefully (2 ms)
      ‚úì should handle error with very long message (2 ms)
      ‚úì should handle error with special characters in message (3 ms)
      ‚úì should handle TypeError (3 ms)
      ‚úì should handle ReferenceError (2 ms)
    Error Handler with Different HTTP Methods
      ‚úì should handle POST request errors (4 ms)
      ‚úì should handle PUT request errors (2 ms)
      ‚úì should handle DELETE request errors (2 ms)
  Controller Error Forwarding - next(error) Coverage
    ‚úì should simulate controller calling next(error) (6 ms)
  notFoundHandler - 404 Handler
    ‚úì should create AppError with 404 when route not found (5 ms)
  asyncHandler - Async Error Wrapper
    ‚úì should catch errors from async route handlers (3 ms)
    ‚úì should pass through successful async route handlers (1 ms)

  console.log
    [dotenv@17.2.3] injecting env (3) from .env.test -- tip: üîë add access controls to secrets: https://dotenvx.com/ops

      at _log (node_modules/dotenv/lib/main.js:142:11)

  console.log
    Starting test suite...

      at Object.<anonymous> (tests/setup.ts:9:11)

  console.log
    
    üöÄ Starting Auth Tests (No Mocking - Controllable Scenarios)...

      at Object.<anonymous> (tests/no-mocks/auth.test.ts:34:11)

  console.log
    MongoDB Atlas connected successfully

      at connectDatabase (src/config/database.ts:22:13)

  console.log
    
    ‚úÖ Test setup complete. Ready to run tests.

      at Object.<anonymous> (tests/no-mocks/auth.test.ts:42:11)

  console.error
    Error: {
      message: 'Google token verification failed',
      statusCode: 500,
      stack: 'Error: Google token verification failed\n' +
        '    at Object.<anonymous> (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/tests/no-mocks/auth.test.ts:180:7)\n' +
        '    at Promise.finally.completed (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:1557:28)\n' +
        '    at new Promise (<anonymous>)\n' +
        '    at callAsyncCircusFn (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:1497:10)\n' +
        '    at _callCircusTest (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:1007:40)\n' +
        '    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n' +
        '    at _runTest (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:947:3)\n' +
        '    at /Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:849:7\n' +
        '    at _runTestsForDescribeBlock (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:862:11)\n' +
        '    at _runTestsForDescribeBlock (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:857:11)\n' +
        '    at run (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:761:3)\n' +
        '    at runAndTransformResultsToJestFormat (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:1918:21)\n' +
        '    at jestAdapter (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/runner.js:101:19)\n' +
        '    at runTestInternal (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-runner/build/index.js:275:16)\n' +
        '    at runTest (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-runner/build/index.js:343:7)',
      timestamp: '2025-11-09T07:24:46.801Z',
      path: '/api/auth/signup',
      method: 'POST'
    }

      90 |   }
      91 |
    > 92 |   console.error('Error:', {
         |           ^
      93 |     message: err.message,
      94 |     statusCode,
      95 |     stack: err.stack,

      at error (src/middleware/errorHandler.ts:92:11)
      at Layer.handleError (node_modules/router/lib/layer.js:116:17)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at Layer.handleError (node_modules/router/lib/layer.js:111:12)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at node_modules/router/index.js:688:15
      at next (node_modules/router/index.js:276:14)
      at next (node_modules/router/lib/route.js:132:14)
      at AuthController.next [as signUp] (src/controllers/auth.controller.ts:78:7)
      at src/routes/auth.routes.ts:16:3
      at src/middleware/errorHandler.ts:58:9

  console.log
    ‚úÖ New user created: 691041be8eac543fae5fe41d

      at AuthService.log [as findOrCreateUser] (src/services/authService.ts:107:17)

  console.log
    ‚úÖ Keeping existing custom profile picture for user: 691041be8eac543fae5fe40d

      at AuthService.log [as findOrCreateUser] (src/services/authService.ts:116:17)

  console.log
    ‚úÖ User logged in: 691041be8eac543fae5fe40d

      at AuthService.log [as findOrCreateUser] (src/services/authService.ts:119:15)

  console.log
    ‚úÖ Keeping existing custom profile picture for user: 691041be8eac543fae5fe40d

      at AuthService.log [as findOrCreateUser] (src/services/authService.ts:116:17)

  console.log
    ‚úÖ User logged in: 691041be8eac543fae5fe40d

      at AuthService.log [as findOrCreateUser] (src/services/authService.ts:119:15)

  console.error
    Error: {
      message: 'Google token verification failed in signin',
      statusCode: 500,
      stack: 'Error: Google token verification failed in signin\n' +
        '    at Object.<anonymous> (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/tests/no-mocks/auth.test.ts:360:7)\n' +
        '    at Promise.finally.completed (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:1557:28)\n' +
        '    at new Promise (<anonymous>)\n' +
        '    at callAsyncCircusFn (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:1497:10)\n' +
        '    at _callCircusTest (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:1007:40)\n' +
        '    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n' +
        '    at _runTest (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:947:3)\n' +
        '    at /Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:849:7\n' +
        '    at _runTestsForDescribeBlock (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:862:11)\n' +
        '    at _runTestsForDescribeBlock (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:857:11)\n' +
        '    at run (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:761:3)\n' +
        '    at runAndTransformResultsToJestFormat (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:1918:21)\n' +
        '    at jestAdapter (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/runner.js:101:19)\n' +
        '    at runTestInternal (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-runner/build/index.js:275:16)\n' +
        '    at runTest (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-runner/build/index.js:343:7)',
      timestamp: '2025-11-09T07:24:46.848Z',
      path: '/api/auth/signin',
      method: 'POST'
    }

      90 |   }
      91 |
    > 92 |   console.error('Error:', {
         |           ^
      93 |     message: err.message,
      94 |     statusCode,
      95 |     stack: err.stack,

      at error (src/middleware/errorHandler.ts:92:11)
      at Layer.handleError (node_modules/router/lib/layer.js:116:17)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at Layer.handleError (node_modules/router/lib/layer.js:111:12)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at node_modules/router/index.js:688:15
      at next (node_modules/router/index.js:276:14)
      at next (node_modules/router/lib/route.js:132:14)
      at AuthController.next [as signIn] (src/controllers/auth.controller.ts:148:7)
      at src/routes/auth.routes.ts:21:3
      at src/middleware/errorHandler.ts:58:9

  console.log
    ‚úÖ User logged in: 69103b50f0d1828080371c77

      at AuthController.log [as googleAuth] (src/controllers/auth.controller.ts:208:17)

  console.log
    ‚úÖ New user created: 691041be8eac543fae5fe42b

      at AuthController.log [as googleAuth] (src/controllers/auth.controller.ts:203:17)

  console.log
    ‚úÖ New user created: 691041be8eac543fae5fe431

      at AuthController.log [as googleAuth] (src/controllers/auth.controller.ts:203:17)

  console.log
    ‚úÖ New user created: 691041be8eac543fae5fe436

      at AuthController.log [as googleAuth] (src/controllers/auth.controller.ts:203:17)

  console.log
    ‚úÖ New user created: 691041be8eac543fae5fe43b

      at AuthController.log [as googleAuth] (src/controllers/auth.controller.ts:203:17)

  console.log
    ‚úÖ User logged in: 691041be8eac543fae5fe40d

      at AuthController.log [as googleAuth] (src/controllers/auth.controller.ts:208:17)

  console.error
    JWT_SECRET is not defined in environment variables

      34 |     const jwtSecret = process.env.JWT_SECRET;
      35 |     if (!jwtSecret) {
    > 36 |       console.error('JWT_SECRET is not defined in environment variables');
         |               ^
      37 |       res.status(500).json({
      38 |         error: 'Server Error',
      39 |         message: 'Authentication configuration error'

      at error (src/middleware/auth.middleware.ts:36:15)
      at Layer.handleRequest (node_modules/router/lib/layer.js:152:17)
      at next (node_modules/router/lib/route.js:157:13)
      at Route.dispatch (node_modules/router/lib/route.js:117:3)
      at handle (node_modules/router/index.js:435:11)
      at Layer.handleRequest (node_modules/router/lib/layer.js:152:17)
      at node_modules/router/index.js:295:15
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at Function.handle (node_modules/router/index.js:186:3)
      at router (node_modules/router/index.js:60:12)
      at Layer.handleRequest (node_modules/router/lib/layer.js:152:17)
      at trimPrefix (node_modules/router/index.js:342:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at urlencodedParser (node_modules/body-parser/lib/types/urlencoded.js:68:7)
      at Layer.handleRequest (node_modules/router/lib/layer.js:152:17)
      at trimPrefix (node_modules/router/index.js:342:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at jsonParser (node_modules/body-parser/lib/types/json.js:100:7)
      at Layer.handleRequest (node_modules/router/lib/layer.js:152:17)
      at trimPrefix (node_modules/router/index.js:342:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at cors (node_modules/cors/lib/index.js:188:7)
      at node_modules/cors/lib/index.js:224:17
      at originCallback (node_modules/cors/lib/index.js:214:15)
      at node_modules/cors/lib/index.js:219:13
      at optionsCallback (node_modules/cors/lib/index.js:199:9)
      at corsMiddleware (node_modules/cors/lib/index.js:204:7)
      at Layer.handleRequest (node_modules/router/lib/layer.js:152:17)
      at trimPrefix (node_modules/router/index.js:342:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at Function.handle (node_modules/router/index.js:186:3)
      at Function.handle (node_modules/express/lib/application.js:177:15)
      at Server.app (node_modules/express/lib/express.js:38:9)

  console.error
    Auth middleware error: Error: Unexpected verification error
        at Object.<anonymous> (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/tests/no-mocks/auth.test.ts:925:13)
        at /Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-mock/build/index.js:305:39
        at Object.<anonymous> (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-mock/build/index.js:312:13)
        at Object.mockConstructor [as verify] (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-mock/build/index.js:102:19)
        at verify (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/src/middleware/auth.middleware.ts:46:21)
        at Layer.handleRequest (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/lib/layer.js:152:17)
        at next (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/lib/route.js:157:13)
        at Route.dispatch (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/lib/route.js:117:3)
        at handle (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/index.js:435:11)
        at Layer.handleRequest (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/lib/layer.js:152:17)
        at /Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/index.js:295:15
        at processParams (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/index.js:582:12)
        at next (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/index.js:291:5)
        at jsonParser (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/body-parser/lib/types/json.js:100:7)
        at Layer.handleRequest (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/lib/layer.js:152:17)
        at trimPrefix (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/index.js:342:13)
        at /Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/index.js:297:9
        at processParams (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/index.js:582:12)
        at next (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/index.js:291:5)
        at Function.handle (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/index.js:186:3)
        at Function.handle (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/express/lib/application.js:177:15)
        at Server.app (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/express/lib/express.js:38:9)
        at Server.emit (node:events:519:28)
        at parserOnIncoming (node:_http_server:1173:12)
        at HTTPParser.parserOnHeadersComplete (node:_http_common:121:17)

      69 |     next();
      70 |   } catch (error) {
    > 71 |     console.error('Auth middleware error:', error);
         |             ^
      72 |     res.status(500).json({
      73 |       error: 'Server Error',
      74 |       message: 'Authentication failed'

      at console.<anonymous> (node_modules/jest-mock/build/index.js:631:25)
      at error (src/middleware/auth.middleware.ts:71:13)
      at Layer.handleRequest (node_modules/router/lib/layer.js:152:17)
      at next (node_modules/router/lib/route.js:157:13)
      at Route.dispatch (node_modules/router/lib/route.js:117:3)
      at handle (node_modules/router/index.js:435:11)
      at Layer.handleRequest (node_modules/router/lib/layer.js:152:17)
      at node_modules/router/index.js:295:15
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at jsonParser (node_modules/body-parser/lib/types/json.js:100:7)
      at Layer.handleRequest (node_modules/router/lib/layer.js:152:17)
      at trimPrefix (node_modules/router/index.js:342:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at Function.handle (node_modules/router/index.js:186:3)
      at Function.handle (node_modules/express/lib/application.js:177:15)
      at Server.app (node_modules/express/lib/express.js:38:9)

  console.error
    Error: {
      message: 'Failed to retrieve verification certificates: Unexpected Gaxios Error',
      statusCode: 500,
      stack: 'Error: Failed to retrieve verification certificates: Unexpected Gaxios Error\n' +
        '    at Gaxios._request (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/gaxios/src/gaxios.ts:227:15)\n' +
        '    at OAuth2Client.getFederatedSignonCertsAsync (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/google-auth-library/build/src/auth/oauth2client.js:605:19)\n' +
        '    at OAuth2Client.verifyIdTokenAsync (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/google-auth-library/build/src/auth/oauth2client.js:540:26)\n' +
        '    at AuthController.googleAuth (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/src/controllers/auth.controller.ts:169:22)\n' +
        '    at /Users/hashim/Desktop/Development/FeastFriends/321-project/backend/src/routes/auth.routes.ts:25:3\n' +
        '    at /Users/hashim/Desktop/Development/FeastFriends/321-project/backend/src/middleware/errorHandler.ts:58:9',
      timestamp: '2025-11-09T07:24:47.637Z',
      path: '/api/auth/google',
      method: 'POST'
    }

      90 |   }
      91 |
    > 92 |   console.error('Error:', {
         |           ^
      93 |     message: err.message,
      94 |     statusCode,
      95 |     stack: err.stack,

      at error (src/middleware/errorHandler.ts:92:11)
      at Layer.handleError (node_modules/router/lib/layer.js:116:17)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at Layer.handleError (node_modules/router/lib/layer.js:111:12)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at node_modules/router/index.js:688:15
      at next (node_modules/router/index.js:276:14)
      at next (node_modules/router/lib/route.js:132:14)
      at AuthController.next [as googleAuth] (src/controllers/auth.controller.ts:245:7)
      at src/routes/auth.routes.ts:25:3
      at src/middleware/errorHandler.ts:58:9

  console.log
    [AuthService] Converting Google profile picture to Base64: https://lh3.googleusercontent.com/test-picture.jpg

      at AuthService.log [as convertGoogleProfilePictureToBase64] (src/services/authService.ts:23:15)

  console.error
    [AuthService] Failed to convert profile picture to Base64: AxiosError {
      message: 'Request failed with status code 400',
      name: 'AxiosError',
      code: 'ERR_BAD_REQUEST',
      config: {
        transitional: {
          silentJSONParsing: true,
          forcedJSONParsing: true,
          clarifyTimeoutError: false
        },
        adapter: [ 'xhr', 'http', 'fetch' ],
        transformRequest: [ [Function: transformRequest] ],
        transformResponse: [ [Function: transformResponse] ],
        timeout: 10000,
        xsrfCookieName: 'XSRF-TOKEN',
        xsrfHeaderName: 'X-XSRF-TOKEN',
        maxContentLength: -1,
        maxBodyLength: -1,
        env: { FormData: [Function [FormData]], Blob: [class Blob] },
        validateStatus: [Function: validateStatus],
        headers: Object [AxiosHeaders] {
          Accept: 'application/json, text/plain, */*',
          'Content-Type': undefined,
          'User-Agent': 'axios/1.12.2',
          'Accept-Encoding': 'gzip, compress, deflate, br'
        },
        responseType: 'arraybuffer',
        method: 'get',
        url: 'https://lh3.googleusercontent.com/test-picture.jpg',
        allowAbsoluteUrls: true,
        data: undefined
      },
      request: <ref *1> ClientRequest {
        _events: [Object: null prototype] {
          abort: [Function (anonymous)],
          aborted: [Function (anonymous)],
          connect: [Function (anonymous)],
          error: [Function (anonymous)],
          socket: [Function (anonymous)],
          timeout: [Function (anonymous)],
          finish: [Function: requestOnFinish]
        },
        _eventsCount: 7,
        _maxListeners: undefined,
        outputData: [],
        outputSize: 0,
        writable: true,
        destroyed: true,
        _last: true,
        chunkedEncoding: false,
        shouldKeepAlive: true,
        maxRequestsOnConnectionReached: false,
        _defaultKeepAlive: true,
        useChunkedEncodingByDefault: false,
        sendDate: false,
        _removedConnection: false,
        _removedContLen: false,
        _removedTE: false,
        strictContentLength: false,
        _contentLength: 0,
        _hasBody: true,
        _trailer: '',
        finished: true,
        _headerSent: true,
        _closed: true,
        _header: 'GET /test-picture.jpg HTTP/1.1\r\n' +
          'Accept: application/json, text/plain, */*\r\n' +
          'User-Agent: axios/1.12.2\r\n' +
          'Accept-Encoding: gzip, compress, deflate, br\r\n' +
          'Host: lh3.googleusercontent.com\r\n' +
          'Connection: keep-alive\r\n' +
          '\r\n',
        _keepAliveTimeout: 0,
        _onPendingData: [Function: nop],
        agent: Agent {
          _events: [Object: null prototype],
          _eventsCount: 2,
          _maxListeners: undefined,
          defaultPort: 443,
          protocol: 'https:',
          options: [Object: null prototype],
          requests: [Object: null prototype] {},
          sockets: [Object: null prototype] {},
          freeSockets: [Object: null prototype],
          keepAliveMsecs: 1000,
          keepAlive: true,
          maxSockets: Infinity,
          maxFreeSockets: 256,
          scheduling: 'lifo',
          maxTotalSockets: Infinity,
          totalSocketCount: 1,
          agentKeepAliveTimeoutBuffer: 1000,
          maxCachedSessions: 100,
          _sessionCache: [Object],
          [Symbol(shapeMode)]: false,
          [Symbol(kCapture)]: false
        },
        socketPath: undefined,
        method: 'GET',
        maxHeaderSize: undefined,
        insecureHTTPParser: undefined,
        joinDuplicateHeaders: undefined,
        path: '/test-picture.jpg',
        _ended: true,
        res: IncomingMessage {
          _events: [Object],
          _readableState: [ReadableState],
          _maxListeners: undefined,
          socket: null,
          httpVersionMajor: 1,
          httpVersionMinor: 1,
          httpVersion: '1.1',
          complete: true,
          rawHeaders: [Array],
          rawTrailers: [],
          joinDuplicateHeaders: undefined,
          aborted: false,
          upgrade: false,
          url: '',
          method: null,
          statusCode: 400,
          statusMessage: 'Bad Request',
          client: [TLSSocket],
          _consuming: true,
          _dumped: false,
          req: [Circular *1],
          _eventsCount: 4,
          responseUrl: 'https://lh3.googleusercontent.com/test-picture.jpg',
          redirects: [],
          [Symbol(shapeMode)]: true,
          [Symbol(kCapture)]: false,
          [Symbol(kHeaders)]: [Object],
          [Symbol(kHeadersCount)]: 20,
          [Symbol(kTrailers)]: null,
          [Symbol(kTrailersCount)]: 0
        },
        aborted: false,
        timeoutCb: null,
        upgradeOrConnect: false,
        parser: null,
        maxHeadersCount: null,
        reusedSocket: false,
        host: 'lh3.googleusercontent.com',
        protocol: 'https:',
        _redirectable: Writable {
          _events: [Object],
          _writableState: [WritableState],
          _maxListeners: undefined,
          _options: [Object],
          _ended: true,
          _ending: true,
          _redirectCount: 0,
          _redirects: [],
          _requestBodyLength: 0,
          _requestBodyBuffers: [],
          _eventsCount: 3,
          _onNativeResponse: [Function (anonymous)],
          _currentRequest: [Circular *1],
          _currentUrl: 'https://lh3.googleusercontent.com/test-picture.jpg',
          _timeout: null,
          [Symbol(shapeMode)]: true,
          [Symbol(kCapture)]: false
        },
        [Symbol(shapeMode)]: false,
        [Symbol(kCapture)]: false,
        [Symbol(kBytesWritten)]: 0,
        [Symbol(kNeedDrain)]: false,
        [Symbol(corked)]: 0,
        [Symbol(kChunkedBuffer)]: [],
        [Symbol(kChunkedLength)]: 0,
        [Symbol(kSocket)]: TLSSocket {
          _tlsOptions: [Object],
          _secureEstablished: true,
          _securePending: false,
          _newSessionPending: false,
          _controlReleased: true,
          secureConnecting: false,
          _SNICallback: null,
          servername: 'lh3.googleusercontent.com',
          alpnProtocol: false,
          authorized: true,
          authorizationError: null,
          encrypted: true,
          _events: [Object: null prototype],
          _eventsCount: 9,
          connecting: false,
          _hadError: false,
          _parent: null,
          _host: 'lh3.googleusercontent.com',
          _closeAfterHandlingError: false,
          _readableState: [ReadableState],
          _writableState: [WritableState],
          allowHalfOpen: false,
          _maxListeners: undefined,
          _sockname: null,
          _pendingData: null,
          _pendingEncoding: '',
          server: undefined,
          _server: null,
          ssl: [TLSWrap],
          _requestCert: true,
          _rejectUnauthorized: true,
          timeout: 5000,
          parser: null,
          _httpMessage: null,
          autoSelectFamilyAttemptedAddresses: [Array],
          [Symbol(alpncallback)]: null,
          [Symbol(res)]: [TLSWrap],
          [Symbol(verified)]: true,
          [Symbol(pendingSession)]: null,
          [Symbol(async_id_symbol)]: -1,
          [Symbol(kHandle)]: [TLSWrap],
          [Symbol(lastWriteQueueSize)]: 0,
          [Symbol(timeout)]: Timeout {
            _idleTimeout: 5000,
            _idlePrev: [TimersList],
            _idleNext: [TimersList],
            _idleStart: 3587,
            _onTimeout: [Function: bound ],
            _timerArgs: undefined,
            _repeat: null,
            _destroyed: false,
            [Symbol(refed)]: false,
            [Symbol(kHasPrimitive)]: false,
            [Symbol(asyncId)]: 34781,
            [Symbol(triggerId)]: 34779,
            [Symbol(kAsyncContextFrame)]: undefined,
            [Symbol(kResourceStore)]: undefined,
            [Symbol(kResourceStore)]: undefined,
            [Symbol(kResourceStore)]: 'AuthService - Direct Unit Tests (No Mocking) findOrCreateUser() should update profile picture when user has empty profile picture and Google provides one (covers authService lines 113-114)'
          },
          [Symbol(kBuffer)]: null,
          [Symbol(kBufferCb)]: null,
          [Symbol(kBufferGen)]: null,
          [Symbol(shapeMode)]: true,
          [Symbol(kCapture)]: false,
          [Symbol(kSetNoDelay)]: false,
          [Symbol(kSetKeepAlive)]: true,
          [Symbol(kSetKeepAliveInitialDelay)]: 1,
          [Symbol(kBytesRead)]: 0,
          [Symbol(kBytesWritten)]: 0,
          [Symbol(connect-options)]: [Object]
        },
        [Symbol(kOutHeaders)]: [Object: null prototype] {
          accept: [Array],
          'user-agent': [Array],
          'accept-encoding': [Array],
          host: [Array]
        },
        [Symbol(errored)]: null,
        [Symbol(kHighWaterMark)]: 65536,
        [Symbol(kRejectNonStandardBodyWrites)]: false,
        [Symbol(kUniqueHeaders)]: null
      },
      response: {
        status: 400,
        statusText: 'Bad Request',
        headers: Object [AxiosHeaders] {
          vary: 'Origin',
          'access-control-allow-origin': '*',
          'timing-allow-origin': '*',
          'content-type': 'text/html; charset=UTF-8',
          'x-content-type-options': 'nosniff',
          date: 'Sun, 09 Nov 2025 07:24:47 GMT',
          server: 'fife',
          'content-length': '1555',
          'x-xss-protection': '0',
          'alt-svc': 'h3=":443"; ma=2592000,h3-29=":443"; ma=2592000'
        },
        config: {
          transitional: [Object],
          adapter: [Array],
          transformRequest: [Array],
          transformResponse: [Array],
          timeout: 10000,
          xsrfCookieName: 'XSRF-TOKEN',
          xsrfHeaderName: 'X-XSRF-TOKEN',
          maxContentLength: -1,
          maxBodyLength: -1,
          env: [Object],
          validateStatus: [Function: validateStatus],
          headers: [Object [AxiosHeaders]],
          responseType: 'arraybuffer',
          method: 'get',
          url: 'https://lh3.googleusercontent.com/test-picture.jpg',
          allowAbsoluteUrls: true,
          data: undefined
        },
        request: <ref *1> ClientRequest {
          _events: [Object: null prototype],
          _eventsCount: 7,
          _maxListeners: undefined,
          outputData: [],
          outputSize: 0,
          writable: true,
          destroyed: true,
          _last: true,
          chunkedEncoding: false,
          shouldKeepAlive: true,
          maxRequestsOnConnectionReached: false,
          _defaultKeepAlive: true,
          useChunkedEncodingByDefault: false,
          sendDate: false,
          _removedConnection: false,
          _removedContLen: false,
          _removedTE: false,
          strictContentLength: false,
          _contentLength: 0,
          _hasBody: true,
          _trailer: '',
          finished: true,
          _headerSent: true,
          _closed: true,
          _header: 'GET /test-picture.jpg HTTP/1.1\r\n' +
            'Accept: application/json, text/plain, */*\r\n' +
            'User-Agent: axios/1.12.2\r\n' +
            'Accept-Encoding: gzip, compress, deflate, br\r\n' +
            'Host: lh3.googleusercontent.com\r\n' +
            'Connection: keep-alive\r\n' +
            '\r\n',
          _keepAliveTimeout: 0,
          _onPendingData: [Function: nop],
          agent: [Agent],
          socketPath: undefined,
          method: 'GET',
          maxHeaderSize: undefined,
          insecureHTTPParser: undefined,
          joinDuplicateHeaders: undefined,
          path: '/test-picture.jpg',
          _ended: true,
          res: [IncomingMessage],
          aborted: false,
          timeoutCb: null,
          upgradeOrConnect: false,
          parser: null,
          maxHeadersCount: null,
          reusedSocket: false,
          host: 'lh3.googleusercontent.com',
          protocol: 'https:',
          _redirectable: [Writable],
          [Symbol(shapeMode)]: false,
          [Symbol(kCapture)]: false,
          [Symbol(kBytesWritten)]: 0,
          [Symbol(kNeedDrain)]: false,
          [Symbol(corked)]: 0,
          [Symbol(kChunkedBuffer)]: [],
          [Symbol(kChunkedLength)]: 0,
          [Symbol(kSocket)]: [TLSSocket],
          [Symbol(kOutHeaders)]: [Object: null prototype],
          [Symbol(errored)]: null,
          [Symbol(kHighWaterMark)]: 65536,
          [Symbol(kRejectNonStandardBodyWrites)]: false,
          [Symbol(kUniqueHeaders)]: null
        },
        data: <Buffer 3c 21 44 4f 43 54 59 50 45 20 68 74 6d 6c 3e 0a 3c 68 74 6d 6c 20 6c 61 6e 67 3d 65 6e 3e 0a 20 20 3c 6d 65 74 61 20 63 68 61 72 73 65 74 3d 75 74 66 ... 1505 more bytes>
      },
      status: 400
    }

      37 |       return base64DataUri;
      38 |     } catch (error) {
    > 39 |       console.error(`[AuthService] Failed to convert profile picture to Base64:`, error);
         |               ^
      40 |       return profilePictureUrl; // Return original URL if conversion fails
      41 |     }
      42 |   }

      at AuthService.error [as convertGoogleProfilePictureToBase64] (src/services/authService.ts:39:15)
      at AuthService.findOrCreateUser (src/services/authService.ts:90:33)
      at AuthController.signIn (src/controllers/auth.controller.ts:112:27)
      at src/routes/auth.routes.ts:21:3
      at src/middleware/errorHandler.ts:58:9

  console.log
    ‚úÖ Updated profile picture from Google for user: 691041be8eac543fae5fe40d

      at AuthService.log [as findOrCreateUser] (src/services/authService.ts:114:17)

  console.log
    ‚úÖ User logged in: 691041be8eac543fae5fe40d

      at AuthService.log [as findOrCreateUser] (src/services/authService.ts:119:15)

  console.log
    ‚úÖ Keeping existing custom profile picture for user: 691041be8eac543fae5fe40d

      at AuthService.log [as findOrCreateUser] (src/services/authService.ts:116:17)

  console.log
    ‚úÖ User logged in: 691041be8eac543fae5fe40d

      at AuthService.log [as findOrCreateUser] (src/services/authService.ts:119:15)

  console.log
    ‚úÖ New user created: 691041bf8eac543fae5fe461

      at AuthService.log [as findOrCreateUser] (src/services/authService.ts:107:17)

  console.log
    ‚úÖ New user created: 691041bf8eac543fae5fe466

      at AuthService.log [as findOrCreateUser] (src/services/authService.ts:107:17)

  console.log
    [AuthService] Converting Google profile picture to Base64: https://lh3.googleusercontent.com/test-picture

      at AuthService.log [as convertGoogleProfilePictureToBase64] (src/services/authService.ts:23:15)

  console.error
    [AuthService] Failed to convert profile picture to Base64: Error: Network error
        at Object.<anonymous> (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/tests/no-mocks/auth.test.ts:1630:47)
        at Promise.finally.completed (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:1557:28)
        at new Promise (<anonymous>)
        at callAsyncCircusFn (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:1497:10)
        at _callCircusTest (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:1007:40)
        at processTicksAndRejections (node:internal/process/task_queues:105:5)
        at _runTest (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:947:3)
        at /Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:849:7
        at _runTestsForDescribeBlock (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:862:11)
        at _runTestsForDescribeBlock (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:857:11)
        at _runTestsForDescribeBlock (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:857:11)
        at run (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:761:3)
        at runAndTransformResultsToJestFormat (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:1918:21)
        at jestAdapter (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/runner.js:101:19)
        at runTestInternal (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-runner/build/index.js:275:16)
        at runTest (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-runner/build/index.js:343:7)

      37 |       return base64DataUri;
      38 |     } catch (error) {
    > 39 |       console.error(`[AuthService] Failed to convert profile picture to Base64:`, error);
         |               ^
      40 |       return profilePictureUrl; // Return original URL if conversion fails
      41 |     }
      42 |   }

      at AuthService.error [as convertGoogleProfilePictureToBase64] (src/services/authService.ts:39:15)
      at AuthService.findOrCreateUser (src/services/authService.ts:90:33)
      at Object.<anonymous> (tests/no-mocks/auth.test.ts:1642:20)

  console.log
    ‚úÖ New user created: 691041bf8eac543fae5fe46b

      at AuthService.log [as findOrCreateUser] (src/services/authService.ts:107:17)

  console.log
    [AuthService] Converting Google profile picture to Base64: https://lh3.googleusercontent.com/test-picture

      at AuthService.log [as convertGoogleProfilePictureToBase64] (src/services/authService.ts:23:15)

  console.log
    [AuthService] Successfully converted to Base64 (42 chars)

      at AuthService.log [as convertGoogleProfilePictureToBase64] (src/services/authService.ts:35:15)

  console.log
    ‚úÖ New user created: 691041bf8eac543fae5fe470

      at AuthService.log [as findOrCreateUser] (src/services/authService.ts:107:17)

  console.log
    Test suite completed.

      at Object.<anonymous> (tests/setup.ts:14:11)

  console.log
    
    üßπ Cleaning up after tests...

      at Object.<anonymous> (tests/no-mocks/auth.test.ts:46:11)

  console.warn
    MongoDB disconnected. Attempting to reconnect...

      28 |
      29 |     mongoose.connection.on('disconnected', () => {
    > 30 |       console.warn('MongoDB disconnected. Attempting to reconnect...');
         |               ^
      31 |     });
      32 |
      33 |     mongoose.connection.on('reconnected', () => {

      at NativeConnection.<anonymous> (src/config/database.ts:30:15)
      at NativeConnection.set (node_modules/mongoose/lib/connection.js:145:12)
      at NativeConnection.onClose (node_modules/mongoose/lib/connection.js:1315:19)
      at NativeConnection._close (node_modules/mongoose/lib/connection.js:1264:12)
      at disconnectDatabase (src/config/database.ts:55:5)
      at Object.<anonymous> (tests/no-mocks/auth.test.ts:52:3)

  console.log
    MongoDB disconnected successfully

      at disconnectDatabase (src/config/database.ts:56:13)

  console.log
    ‚úÖ Cleanup complete.

      at Object.<anonymous> (tests/no-mocks/auth.test.ts:54:11)

PASS tests/no-mocks/auth.test.ts
  POST /api/auth/signup - Validation (No Mocking)
    ‚úì should return 400 when idToken is missing (4 ms)
    ‚úì should return 409 when user already exists (8 ms)
    ‚úì should return 500 when JWT_SECRET is missing (9 ms)
    ‚úì should handle errors in catch block and call next(error) (19 ms)
    ‚úì should successfully sign up new user and return JWT token (23 ms)
  POST /api/auth/signin - Validation (No Mocking)
    ‚úì should return 400 when idToken is missing in signin (2 ms)
    ‚úì should return 404 when user not found (3 ms)
    ‚úì should return 500 when JWT_SECRET is missing in signin (8 ms)
    ‚úì should successfully sign in existing user and return JWT token (6 ms)
    ‚úì should handle errors in signin catch block and call next(error) (2 ms)
  POST /api/auth/google - Validation (No Mocking)
    ‚úì should return 400 when idToken is missing in googleAuth (2 ms)
    ‚úì should return 401 when Google token payload is invalid (missing sub) (1 ms)
    ‚úì should return 401 when Google token payload is invalid (missing email) (2 ms)
    ‚úì should return 500 when JWT_SECRET is missing in googleAuth (16 ms)
    ‚úì should use fallback "User" when name is missing in googleAuth (8 ms)
    ‚úì should use empty string fallback when picture is missing in googleAuth (8 ms)
    ‚úì should return 401 when Google token payload is null (2 ms)
    ‚úì should create new user when not found (12 ms)
    ‚úì should create new user when not found and update existing user status when found (29 ms)
  POST /api/auth/logout - No Mocking
    ‚úì should return 200 and logout user successfully (7 ms)
    ‚úì should return 401 without authentication token (2 ms)
    ‚úì should return 200 even if user not found (3 ms)
  Auth Middleware - Integration Tests
    ‚úì should return 500 when JWT_SECRET is missing in authMiddleware (3 ms)
    ‚úì should return 401 with Invalid token message for JsonWebTokenError (1 ms)
    ‚úì should return 401 with Token expired message for TokenExpiredError (2 ms)
    ‚úì should return 500 with Authentication failed for non-JWT errors (10 ms)
    ‚úì should continue without user when JWT_SECRET is missing in optionalAuth (2 ms)
    ‚úì should handle errors in optionalAuth catch block (1 ms)
  GET /api/auth/verify - No Mocking
    ‚úì should return 200 and user info with valid token (4 ms)
    ‚úì should return 401 without authentication token (1 ms)
    ‚úì should return 404 when user not found in verify (2 ms)
  POST /api/auth/fcm-token - No Mocking
    ‚úì should return 200 and update FCM token successfully (6 ms)
    ‚úì should return 400 when fcmToken is missing (2 ms)
    ‚úì should return 401 without authentication token (1 ms)
    ‚úì should return 404 when user not found in updateFCMToken (4 ms)
  DELETE /api/auth/account - No Mocking
    ‚úì should return 200 and delete account successfully (18 ms)
    ‚úì should return 400 when user is in a room (4 ms)
    ‚úì should return 400 when user is in a group (5 ms)
    ‚úì should return 401 without authentication token (1 ms)
    ‚úì should return 404 when user not found in deleteAccount (3 ms)
  POST /api/auth/google - Google OAuth Integration (Legacy)
    ‚úì should return 200 and find or create user with valid Google token (624 ms)
  AuthService - Direct Unit Tests (No Mocking)
    generateToken()
      ‚úì should generate valid JWT token for user (1 ms)
      ‚úì should throw error when JWT_SECRET is missing (3 ms)
    verifyToken()
      ‚úì should verify and decode valid token
      ‚úì should throw error for invalid and expired tokens (1 ms)
    findOrCreateUser()
      ‚úì should update profile picture when user has empty profile picture and Google provides one (covers authService lines 113-114) (173 ms)
      ‚úì should find existing user and update status, or create new user when not found (16 ms)
      ‚úì should return original URL when profile picture is not a Google URL (9 ms)
      ‚úì should handle profile picture conversion failure gracefully (9 ms)
      ‚úì should use image/png fallback when content-type header is missing (6 ms)
    verifyGoogleToken()
      ‚úì should throw AppError when payload is invalid
      ‚úì should use "User" as fallback when name is missing (1 ms)
      ‚úì should throw AppError in catch block when verification fails
    logoutUser()
      ‚úì should set user status to OFFLINE (7 ms)
      ‚úì should handle non-existent user gracefully (1 ms)
    deleteAccount()
      ‚úì should throw error when user is in a room (1 ms)
      ‚úì should throw error when user is in a group (1 ms)

  console.log
    [dotenv@17.2.3] injecting env (3) from .env.test -- tip: üîê prevent building .env in docker: https://dotenvx.com/prebuild

      at _log (node_modules/dotenv/lib/main.js:142:11)

  console.log
    Starting test suite...

      at Object.<anonymous> (tests/setup.ts:9:11)

  console.log
    
    üöÄ Starting Group Tests (No Mocking - Controllable Scenarios)...

      at Object.<anonymous> (tests/no-mocks/group.test.ts:41:11)

  console.log
    ‚úÖ Socket.IO initialized successfully

      at initializeSocket (src/config/socket.ts:151:11)

  console.log
    ‚úÖ Socket.IO initialized successfully

      at initializeSocket (src/config/socket.ts:151:11)

  console.log
    ‚úÖ SocketManager initialized

      at SocketManager.log [as initialize] (src/utils/socketManager.ts:35:13)

  console.log
    ‚úÖ Test Socket.IO server initialized on port 60576

      at Server.<anonymous> (tests/helpers/socket.helper.ts:28:15)

  console.log
    MongoDB Atlas connected successfully

      at connectDatabase (src/config/database.ts:22:13)

  console.log
    ‚úÖ Test setup complete. Ready to run tests.

      at Object.<anonymous> (tests/no-mocks/group.test.ts:85:11)

  console.error
    Error: {
      message: 'Group not found',
      statusCode: 500,
      stack: 'Error: Group not found\n' +
        '    at GroupService.voteForRestaurant (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/src/services/groupService.ts:55:13)\n' +
        '    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n' +
        '    at GroupController.voteForRestaurant (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/src/controllers/group.controller.ts:59:22)\n' +
        '    at /Users/hashim/Desktop/Development/FeastFriends/321-project/backend/src/routes/group.routes.ts:23:3\n' +
        '    at /Users/hashim/Desktop/Development/FeastFriends/321-project/backend/src/middleware/errorHandler.ts:58:9',
      timestamp: '2025-11-09T07:24:48.155Z',
      path: '/api/group/vote/507f1f77bcf86cd799439011',
      method: 'POST'
    }

      90 |   }
      91 |
    > 92 |   console.error('Error:', {
         |           ^
      93 |     message: err.message,
      94 |     statusCode,
      95 |     stack: err.stack,

      at error (src/middleware/errorHandler.ts:92:11)
      at Layer.handleError (node_modules/router/lib/layer.js:116:17)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at Layer.handleError (node_modules/router/lib/layer.js:111:12)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at node_modules/router/index.js:688:15
      at next (node_modules/router/index.js:276:14)
      at next (node_modules/router/lib/route.js:132:14)
      at GroupController.next [as voteForRestaurant] (src/controllers/group.controller.ts:75:7)
      at src/routes/group.routes.ts:23:3
      at src/middleware/errorHandler.ts:58:9

  console.error
    Error: {
      message: 'Cast to ObjectId failed for value "invalid-group-id-format" (type string) at path "_id" for model "Group"',
      statusCode: 400,
      stack: 'CastError: Cast to ObjectId failed for value "invalid-group-id-format" (type string) at path "_id" for model "Group"\n' +
        '    at SchemaObjectId.cast (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/mongoose/lib/schema/objectId.js:251:11)\n' +
        '    at SchemaObjectId.SchemaType.applySetters (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/mongoose/lib/schemaType.js:1259:12)\n' +
        '    at SchemaObjectId.SchemaType.castForQuery (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/mongoose/lib/schemaType.js:1695:17)\n' +
        '    at cast (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/mongoose/lib/cast.js:390:32)\n' +
        '    at model.Query.Query.cast (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/mongoose/lib/query.js:5060:12)\n' +
        '    at model.Query.Query._castConditions (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/mongoose/lib/query.js:2374:10)\n' +
        '    at model.Query._findOne (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/mongoose/lib/query.js:2697:8)\n' +
        '    at model.Query.exec (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/mongoose/lib/query.js:4627:80)\n' +
        '    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n' +
        '    at GroupService.voteForRestaurant (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/src/services/groupService.ts:52:19)\n' +
        '    at GroupController.voteForRestaurant (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/src/controllers/group.controller.ts:59:22)\n' +
        '    at /Users/hashim/Desktop/Development/FeastFriends/321-project/backend/src/routes/group.routes.ts:23:3\n' +
        '    at /Users/hashim/Desktop/Development/FeastFriends/321-project/backend/src/middleware/errorHandler.ts:58:9',
      timestamp: '2025-11-09T07:24:48.163Z',
      path: '/api/group/vote/invalid-group-id-format',
      method: 'POST'
    }

      90 |   }
      91 |
    > 92 |   console.error('Error:', {
         |           ^
      93 |     message: err.message,
      94 |     statusCode,
      95 |     stack: err.stack,

      at error (src/middleware/errorHandler.ts:92:11)
      at Layer.handleError (node_modules/router/lib/layer.js:116:17)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at Layer.handleError (node_modules/router/lib/layer.js:111:12)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at node_modules/router/index.js:688:15
      at next (node_modules/router/index.js:276:14)
      at next (node_modules/router/lib/route.js:132:14)
      at GroupController.next [as voteForRestaurant] (src/controllers/group.controller.ts:75:7)
      at src/routes/group.routes.ts:23:3
      at src/middleware/errorHandler.ts:58:9

  console.error
    Error: {
      message: 'User is not a member of this group',
      statusCode: 500,
      stack: 'Error: User is not a member of this group\n' +
        '    at GroupService.voteForRestaurant (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/src/services/groupService.ts:60:13)\n' +
        '    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n' +
        '    at GroupController.voteForRestaurant (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/src/controllers/group.controller.ts:59:22)\n' +
        '    at /Users/hashim/Desktop/Development/FeastFriends/321-project/backend/src/routes/group.routes.ts:23:3\n' +
        '    at /Users/hashim/Desktop/Development/FeastFriends/321-project/backend/src/middleware/errorHandler.ts:58:9',
      timestamp: '2025-11-09T07:24:48.171Z',
      path: '/api/group/vote/691041c0fb300da161e1cd77',
      method: 'POST'
    }

      90 |   }
      91 |
    > 92 |   console.error('Error:', {
         |           ^
      93 |     message: err.message,
      94 |     statusCode,
      95 |     stack: err.stack,

      at error (src/middleware/errorHandler.ts:92:11)
      at Layer.handleError (node_modules/router/lib/layer.js:116:17)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at Layer.handleError (node_modules/router/lib/layer.js:111:12)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at node_modules/router/index.js:688:15
      at next (node_modules/router/index.js:276:14)
      at next (node_modules/router/lib/route.js:132:14)
      at GroupController.next [as voteForRestaurant] (src/controllers/group.controller.ts:75:7)
      at src/routes/group.routes.ts:23:3
      at src/middleware/errorHandler.ts:58:9

  console.error
    Error: {
      message: 'Restaurant has already been selected for this group',
      statusCode: 500,
      stack: 'Error: Restaurant has already been selected for this group\n' +
        '    at GroupService.voteForRestaurant (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/src/services/groupService.ts:65:13)\n' +
        '    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n' +
        '    at GroupController.voteForRestaurant (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/src/controllers/group.controller.ts:59:22)\n' +
        '    at /Users/hashim/Desktop/Development/FeastFriends/321-project/backend/src/routes/group.routes.ts:23:3\n' +
        '    at /Users/hashim/Desktop/Development/FeastFriends/321-project/backend/src/middleware/errorHandler.ts:58:9',
      timestamp: '2025-11-09T07:24:48.180Z',
      path: '/api/group/vote/691041c0fb300da161e1cd79',
      method: 'POST'
    }

      90 |   }
      91 |
    > 92 |   console.error('Error:', {
         |           ^
      93 |     message: err.message,
      94 |     statusCode,
      95 |     stack: err.stack,

      at error (src/middleware/errorHandler.ts:92:11)
      at Layer.handleError (node_modules/router/lib/layer.js:116:17)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at Layer.handleError (node_modules/router/lib/layer.js:111:12)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at node_modules/router/index.js:688:15
      at next (node_modules/router/index.js:276:14)
      at next (node_modules/router/lib/route.js:132:14)
      at GroupController.next [as voteForRestaurant] (src/controllers/group.controller.ts:75:7)
      at src/routes/group.routes.ts:23:3
      at src/middleware/errorHandler.ts:58:9

  console.log
    üì° Emitting vote_update to channel: group_691041c0fb300da161e1cdb1

      at SocketEmitter.emitVoteUpdate (src/config/socket.ts:215:13)

  console.log
       Data: {
      restaurantId: 'rest-first',
      votes: { 'rest-first': 1 },
      totalVotes: 1,
      membersVoted: 1,
      totalMembers: 2
    }

      at SocketEmitter.emitVoteUpdate (src/config/socket.ts:216:13)

  console.log
    ‚úÖ vote_update emitted successfully

      at SocketEmitter.emitVoteUpdate (src/config/socket.ts:218:13)

  console.log
    üì° Emitting vote_update to channel: group_691041c0fb300da161e1cdb1

      at SocketEmitter.emitVoteUpdate (src/config/socket.ts:215:13)

  console.log
       Data: {
      restaurantId: 'rest-second',
      votes: { 'rest-first': 0, 'rest-second': 1 },
      totalVotes: 1,
      membersVoted: 1,
      totalMembers: 2
    }

      at SocketEmitter.emitVoteUpdate (src/config/socket.ts:216:13)

  console.log
    ‚úÖ vote_update emitted successfully

      at SocketEmitter.emitVoteUpdate (src/config/socket.ts:218:13)

  console.log
    üì° Emitting vote_update to channel: group_691041c0fb300da161e1cdbd

      at SocketEmitter.emitVoteUpdate (src/config/socket.ts:215:13)

  console.log
       Data: {
      restaurantId: 'rest-winner',
      votes: { 'rest-winner': 1 },
      totalVotes: 1,
      membersVoted: 1,
      totalMembers: 1
    }

      at SocketEmitter.emitVoteUpdate (src/config/socket.ts:216:13)

  console.log
    ‚úÖ vote_update emitted successfully

      at SocketEmitter.emitVoteUpdate (src/config/socket.ts:218:13)

  console.log
    üéâ Emitting restaurant_selected to channel: group_691041c0fb300da161e1cdbd

      at SocketEmitter.emitRestaurantSelected (src/config/socket.ts:232:13)

  console.log
       Restaurant: Winner Restaurant

      at SocketEmitter.emitRestaurantSelected (src/config/socket.ts:233:13)

  console.log
       Data: {
      restaurantId: 'rest-winner',
      restaurantName: 'Winner Restaurant',
      votes: { 'rest-winner': 1 }
    }

      at SocketEmitter.emitRestaurantSelected (src/config/socket.ts:234:13)

  console.log
    ‚úÖ restaurant_selected emitted successfully

      at SocketEmitter.emitRestaurantSelected (src/config/socket.ts:236:13)

  console.log
     Notification sent to 1 users

      at log (src/services/notificationService.ts:52:13)

  console.log
    √¢≈ì‚Ä¶ Restaurant selected for group 691041c0fb300da161e1cdbd

      at GroupService.log [as voteForRestaurant] (src/services/groupService.ts:152:17)

  console.log
    üì° Emitting vote_update to channel: group_691041c0fb300da161e1cdc8

      at SocketEmitter.emitVoteUpdate (src/config/socket.ts:215:13)

  console.log
       Data: {
      restaurantId: 'rest-winner',
      votes: { 'rest-winner': 1 },
      totalVotes: 1,
      membersVoted: 1,
      totalMembers: 1
    }

      at SocketEmitter.emitVoteUpdate (src/config/socket.ts:216:13)

  console.log
    ‚úÖ vote_update emitted successfully

      at SocketEmitter.emitVoteUpdate (src/config/socket.ts:218:13)

  console.log
    üéâ Emitting restaurant_selected to channel: group_691041c0fb300da161e1cdc8

      at SocketEmitter.emitRestaurantSelected (src/config/socket.ts:232:13)

  console.log
       Restaurant: Winner Restaurant

      at SocketEmitter.emitRestaurantSelected (src/config/socket.ts:233:13)

  console.log
       Data: {
      restaurantId: 'rest-winner',
      restaurantName: 'Winner Restaurant',
      votes: { 'rest-winner': 1 }
    }

      at SocketEmitter.emitRestaurantSelected (src/config/socket.ts:234:13)

  console.log
    ‚úÖ restaurant_selected emitted successfully

      at SocketEmitter.emitRestaurantSelected (src/config/socket.ts:236:13)

  console.warn
    No valid FCM tokens found for the provided users

      45 |
      46 |     if (tokens.length === 0) {
    > 47 |       console.warn('No valid FCM tokens found for the provided users');
         |               ^
      48 |       return;
      49 |     }
      50 |

      at warn (src/services/notificationService.ts:47:15)
      at notifyRestaurantSelected (src/services/notificationService.ts:137:3)
      at GroupService.voteForRestaurant (src/services/groupService.ts:143:11)
      at GroupController.voteForRestaurant (src/controllers/group.controller.ts:59:22)
      at src/routes/group.routes.ts:23:3
      at src/middleware/errorHandler.ts:58:9

  console.log
    √¢≈ì‚Ä¶ Restaurant selected for group 691041c0fb300da161e1cdc8

      at GroupService.log [as voteForRestaurant] (src/services/groupService.ts:152:17)

  console.log
    üì§ Emitted member_left for room group_691041c0fb300da161e1cdd3

      at SocketEmitter.emitMemberLeft (src/config/socket.ts:263:13)

  console.error
    Error: {
      message: 'Group not found',
      statusCode: 500,
      stack: 'Error: Group not found\n' +
        '    at GroupService.leaveGroup (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/src/services/groupService.ts:169:13)\n' +
        '    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n' +
        '    at GroupController.leaveGroup (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/src/controllers/group.controller.ts:88:7)\n' +
        '    at /Users/hashim/Desktop/Development/FeastFriends/321-project/backend/src/routes/group.routes.ts:32:3\n' +
        '    at /Users/hashim/Desktop/Development/FeastFriends/321-project/backend/src/middleware/errorHandler.ts:58:9',
      timestamp: '2025-11-09T07:24:48.268Z',
      path: '/api/group/leave/507f1f77bcf86cd799439011',
      method: 'POST'
    }

      90 |   }
      91 |
    > 92 |   console.error('Error:', {
         |           ^
      93 |     message: err.message,
      94 |     statusCode,
      95 |     stack: err.stack,

      at error (src/middleware/errorHandler.ts:92:11)
      at Layer.handleError (node_modules/router/lib/layer.js:116:17)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at Layer.handleError (node_modules/router/lib/layer.js:111:12)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at Immediate.next (node_modules/router/index.js:291:5)
      at Immediate._onImmediate (node_modules/router/index.js:688:15)

  console.error
    Error: {
      message: 'User not found',
      statusCode: 500,
      stack: 'Error: User not found\n' +
        '    at GroupService.leaveGroup (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/src/services/groupService.ts:174:13)\n' +
        '    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n' +
        '    at GroupController.leaveGroup (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/src/controllers/group.controller.ts:88:7)\n' +
        '    at /Users/hashim/Desktop/Development/FeastFriends/321-project/backend/src/routes/group.routes.ts:32:3\n' +
        '    at /Users/hashim/Desktop/Development/FeastFriends/321-project/backend/src/middleware/errorHandler.ts:58:9',
      timestamp: '2025-11-09T07:24:48.276Z',
      path: '/api/group/leave/691041c0fb300da161e1cd77',
      method: 'POST'
    }

      90 |   }
      91 |
    > 92 |   console.error('Error:', {
         |           ^
      93 |     message: err.message,
      94 |     statusCode,
      95 |     stack: err.stack,

      at error (src/middleware/errorHandler.ts:92:11)
      at Layer.handleError (node_modules/router/lib/layer.js:116:17)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at Layer.handleError (node_modules/router/lib/layer.js:111:12)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at Immediate.next (node_modules/router/index.js:291:5)
      at Immediate._onImmediate (node_modules/router/index.js:688:15)

  console.log
    √∞≈∏‚Äî‚Äò√Ø¬∏¬è Deleted empty group: 691041c0fb300da161e1cdec

      at GroupService.log [as leaveGroup] (src/services/groupService.ts:188:15)

  console.log
    üì§ Emitted member_left for room group_691041c0fb300da161e1cdf8

      at SocketEmitter.emitMemberLeft (src/config/socket.ts:263:13)

  console.log
    Test suite completed.

      at Object.<anonymous> (tests/setup.ts:14:11)

  console.log
    
    üßπ Cleaning up after tests...

      at Object.<anonymous> (tests/no-mocks/group.test.ts:89:11)

  console.warn
    MongoDB disconnected. Attempting to reconnect...

      28 |
      29 |     mongoose.connection.on('disconnected', () => {
    > 30 |       console.warn('MongoDB disconnected. Attempting to reconnect...');
         |               ^
      31 |     });
      32 |
      33 |     mongoose.connection.on('reconnected', () => {

      at NativeConnection.<anonymous> (src/config/database.ts:30:15)
      at NativeConnection.set (node_modules/mongoose/lib/connection.js:145:12)
      at NativeConnection.onClose (node_modules/mongoose/lib/connection.js:1315:19)
      at NativeConnection._close (node_modules/mongoose/lib/connection.js:1264:12)
      at disconnectDatabase (src/config/database.ts:55:5)
      at Object.<anonymous> (tests/no-mocks/group.test.ts:92:3)

  console.log
    MongoDB disconnected successfully

      at disconnectDatabase (src/config/database.ts:56:13)

  console.log
    ‚úÖ HTTP server closed

      at Server.<anonymous> (tests/helpers/socket.helper.ts:44:15)

  console.log
    ‚úÖ Socket.IO server closed

      at tests/helpers/socket.helper.ts:40:15

  console.log
    ‚úÖ Cleanup complete.

      at Object.<anonymous> (tests/no-mocks/group.test.ts:97:11)

PASS tests/no-mocks/group.test.ts
  GET /api/group/status - No Mocking
    ‚úì Should return 200 and group status for user in a group (18 ms)
    ‚úì should return 404 when user is not in a group (7 ms)
    ‚úì should return 401 without authentication token (7 ms)
    ‚úì should return 401 with invalid token (6 ms)
    ‚úì should return group status with restaurant selected (9 ms)
  POST /api/group/vote/:groupId - No Mocking
    ‚úì should return 400 when restaurantID is missing (10 ms)
    ‚úì should return 500 when group not found (18 ms)
    ‚úì should return 400 for invalid ObjectId format in groupId (7 ms)
    ‚úì should return 500 when user is not a member of the group (9 ms)
    ‚úì should return 500 when restaurant already selected (9 ms)
    ‚úì should allow user to change their vote and emit socket events (19 ms)
    ‚úì should successfully vote and trigger restaurant selection with notification (22 ms)
    ‚úì should still succeed when voting even if user has no FCM token (17 ms)
  POST /api/group/leave/:groupId - No Mocking
    ‚úì should return 200 and successfully leave a group (19 ms)
    ‚úì should return 500 when group not found in leaveGroup (8 ms)
    ‚úì should return 500 when user not found (7 ms)
    ‚úì should delete group and restaurant data when last member leaves (12 ms)
    ‚úì should preserve restaurant data when member leaves (group not deleted) (41 ms)
    ‚úì should verify restaurant field remains after completionTime if not cleared (20 ms)
  Group Model Methods - Integration Tests
    ‚úì should access groupId virtual property through API response (10 ms)
    ‚úì should use toJSON transform to convert Maps to objects (28 ms)
    ‚úì should add vote when user has no previous vote and use || 0 fallback (9 ms)
    ‚úì should handle previous vote when adding new vote (8 ms)
    ‚úì should handle previous vote when restaurantVotes.get returns undefined (8 ms)
    ‚úì should remove vote when restaurantId exists (12 ms)
    ‚úì should use || 0 fallback when removing vote for restaurant not in restaurantVotes (10 ms)
    ‚úì should get winning restaurant when votes exist (15 ms)
    ‚úì should return null when no votes exist in getWinningRestaurant (6 ms)
    ‚úì should handle equal votes in getWinningRestaurant (7 ms)
    ‚úì should check if all members have voted (6 ms)
    ‚úì should remove member from group (8 ms)

  console.log
    [dotenv@17.2.3] injecting env (3) from .env.test -- tip: üîê prevent building .env in docker: https://dotenvx.com/prebuild

      at _log (node_modules/dotenv/lib/main.js:142:11)

  console.log
    Starting test suite...

      at Object.<anonymous> (tests/setup.ts:9:11)

  console.log
    
    üöÄ Starting Matching Tests (No Mocking)...

      at Object.<anonymous> (tests/no-mocks/matching.test.ts:39:11)

  console.log
    ‚úÖ Socket.IO initialized successfully

      at initializeSocket (src/config/socket.ts:151:11)

  console.log
    ‚úÖ Socket.IO initialized successfully

      at initializeSocket (src/config/socket.ts:151:11)

  console.log
    ‚úÖ SocketManager initialized

      at SocketManager.log [as initialize] (src/utils/socketManager.ts:35:13)

  console.log
    ‚úÖ Test Socket.IO server initialized on port 60625

      at Server.<anonymous> (tests/helpers/socket.helper.ts:28:15)

  console.log
    MongoDB Atlas connected successfully

      at connectDatabase (src/config/database.ts:22:13)

  console.log
    
    ‚úÖ Test setup complete. Ready to run tests.

      at Object.<anonymous> (tests/no-mocks/matching.test.ts:50:11)

  console.log
    ‚úÖ Created new room: 691041c0b5acd9afc5853e8b (cuisine: italian)

      at MatchingService.log [as joinMatching] (src/services/matchingService.ts:126:15)

  console.log
    üì§ Emitted room_update for room 691041c0b5acd9afc5853e8b

      at SocketEmitter.emitRoomUpdate (src/config/socket.ts:174:13)

  console.warn
    ‚ö†Ô∏è emitToUser: No socket found for user 691041c0b5acd9afc5853e76

      175 |     }
      176 |
    > 177 |     console.warn(`‚ö†Ô∏è emitToUser: No socket found for user ${userId}`);
          |             ^
      178 |   }
      179 | }
      180 |

      at SocketManager.warn (src/utils/socketManager.ts:177:13)
      at MatchingService.emitToUser [as joinMatching] (src/services/matchingService.ts:151:19)
      at MatchingController.joinMatching (src/controllers/matching.controller.ts:17:22)
      at src/routes/matching.routes.ts:14:3
      at src/middleware/errorHandler.ts:58:9

  console.log
    üì§ Emitted member_joined for room 691041c0b5acd9afc5853e8b

      at SocketEmitter.emitMemberJoined (src/config/socket.ts:250:13)

  console.log
    ‚úÖ Best room match found with score: 90

      at MatchingService.log [as findBestMatchingRoom] (src/services/matchingService.ts:65:15)

  console.log
    ‚úÖ User 691041c0b5acd9afc5853e77 joined room: 691041c0b5acd9afc5853e9b (members: 2/10)

      at MatchingService.log [as joinMatching] (src/services/matchingService.ts:135:15)

  console.log
    üì§ Emitted room_update for room 691041c0b5acd9afc5853e9b

      at SocketEmitter.emitRoomUpdate (src/config/socket.ts:174:13)

  console.warn
    ‚ö†Ô∏è emitToUser: No socket found for user 691041c0b5acd9afc5853e77

      175 |     }
      176 |
    > 177 |     console.warn(`‚ö†Ô∏è emitToUser: No socket found for user ${userId}`);
          |             ^
      178 |   }
      179 | }
      180 |

      at SocketManager.warn [as emitToUser] (src/utils/socketManager.ts:177:13)
      at MatchingService.emitToUser [as joinMatching] (src/services/matchingService.ts:151:19)
      at MatchingController.joinMatching (src/controllers/matching.controller.ts:17:22)
      at src/routes/matching.routes.ts:14:3
      at src/middleware/errorHandler.ts:58:9

  console.log
    üì§ Emitted member_joined for room 691041c0b5acd9afc5853e9b

      at SocketEmitter.emitMemberJoined (src/config/socket.ts:250:13)

  console.log
    ‚úÖ Created new room: 691041c0b5acd9afc5853ebb (cuisine: very-unique-cuisine-that-does-not-exist)

      at MatchingService.log [as joinMatching] (src/services/matchingService.ts:126:15)

  console.log
    üì§ Emitted room_update for room 691041c0b5acd9afc5853ebb

      at SocketEmitter.emitRoomUpdate (src/config/socket.ts:174:13)

  console.warn
    ‚ö†Ô∏è emitToUser: No socket found for user 691041c0b5acd9afc5853e7a

      175 |     }
      176 |
    > 177 |     console.warn(`‚ö†Ô∏è emitToUser: No socket found for user ${userId}`);
          |             ^
      178 |   }
      179 | }
      180 |

      at SocketManager.warn [as emitToUser] (src/utils/socketManager.ts:177:13)
      at MatchingService.emitToUser [as joinMatching] (src/services/matchingService.ts:151:19)
      at MatchingController.joinMatching (src/controllers/matching.controller.ts:17:22)
      at src/routes/matching.routes.ts:14:3
      at src/middleware/errorHandler.ts:58:9

  console.log
    üì§ Emitted member_joined for room 691041c0b5acd9afc5853ebb

      at SocketEmitter.emitMemberJoined (src/config/socket.ts:250:13)

  console.error
    Error: {
      message: 'User is already in a room or group',
      statusCode: 500,
      stack: 'Error: User is already in a room or group\n' +
        '    at MatchingService.joinMatching (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/src/services/matchingService.ts:93:13)\n' +
        '    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n' +
        '    at MatchingController.joinMatching (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/src/controllers/matching.controller.ts:17:22)\n' +
        '    at /Users/hashim/Desktop/Development/FeastFriends/321-project/backend/src/routes/matching.routes.ts:14:3\n' +
        '    at /Users/hashim/Desktop/Development/FeastFriends/321-project/backend/src/middleware/errorHandler.ts:58:9',
      timestamp: '2025-11-09T07:24:48.850Z',
      path: '/api/matching/join',
      method: 'POST'
    }

      90 |   }
      91 |
    > 92 |   console.error('Error:', {
         |           ^
      93 |     message: err.message,
      94 |     statusCode,
      95 |     stack: err.stack,

      at error (src/middleware/errorHandler.ts:92:11)
      at Layer.handleError (node_modules/router/lib/layer.js:116:17)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at Layer.handleError (node_modules/router/lib/layer.js:111:12)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at node_modules/router/index.js:688:15
      at next (node_modules/router/index.js:276:14)
      at next (node_modules/router/lib/route.js:132:14)
      at MatchingController.next [as joinMatching] (src/controllers/matching.controller.ts:29:7)
      at src/routes/matching.routes.ts:14:3
      at src/middleware/errorHandler.ts:58:9

  console.log
    üì§ Emitted member_left for room 691041c0b5acd9afc5853ee6

      at SocketEmitter.emitMemberLeft (src/config/socket.ts:263:13)

  console.log
    üì§ Emitted room_update for room 691041c0b5acd9afc5853ee6

      at SocketEmitter.emitRoomUpdate (src/config/socket.ts:174:13)

  console.log
    ‚úÖ User 691041c0b5acd9afc5853ee2 left room 691041c0b5acd9afc5853ee6

      at MatchingService.log [as leaveRoom] (src/services/matchingService.ts:253:13)

  console.log
    üì§ Emitted member_left for room 691041c0b5acd9afc5853ef4

      at SocketEmitter.emitMemberLeft (src/config/socket.ts:263:13)

  console.log
    üóëÔ∏è Deleted empty room: 691041c0b5acd9afc5853ef4

      at MatchingService.log [as leaveRoom] (src/services/matchingService.ts:238:15)

  console.log
    ‚úÖ User 691041c0b5acd9afc5853ef2 left room 691041c0b5acd9afc5853ef4

      at MatchingService.log [as leaveRoom] (src/services/matchingService.ts:253:13)

  console.log
    Room 691041c0b5acd9afc5853f08 not found - clearing user's roomID anyway

      at MatchingService.log [as leaveRoom] (src/services/matchingService.ts:204:15)

  console.log
    ‚úÖ Cleared stale roomID for user 691041c0b5acd9afc5853e76

      at MatchingService.log [as leaveRoom] (src/services/matchingService.ts:211:17)

  console.error
    Error: {
      message: 'Room not found',
      statusCode: 500,
      stack: 'Error: Room not found\n' +
        '    at MatchingService.getRoomStatus (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/src/services/matchingService.ts:321:13)\n' +
        '    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n' +
        '    at MatchingController.getRoomStatus (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/src/controllers/matching.controller.ts:88:22)\n' +
        '    at /Users/hashim/Desktop/Development/FeastFriends/321-project/backend/src/routes/matching.routes.ts:41:3\n' +
        '    at /Users/hashim/Desktop/Development/FeastFriends/321-project/backend/src/middleware/errorHandler.ts:58:9',
      timestamp: '2025-11-09T07:24:49.541Z',
      path: '/api/matching/status/691041c1b5acd9afc5853f2b',
      method: 'GET'
    }

      90 |   }
      91 |
    > 92 |   console.error('Error:', {
         |           ^
      93 |     message: err.message,
      94 |     statusCode,
      95 |     stack: err.stack,

      at error (src/middleware/errorHandler.ts:92:11)
      at Layer.handleError (node_modules/router/lib/layer.js:116:17)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at Layer.handleError (node_modules/router/lib/layer.js:111:12)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at node_modules/router/index.js:688:15
      at next (node_modules/router/index.js:276:14)
      at next (node_modules/router/lib/route.js:132:14)
      at MatchingController.next [as getRoomStatus] (src/controllers/matching.controller.ts:96:7)
      at src/routes/matching.routes.ts:41:3
      at src/middleware/errorHandler.ts:58:9

  console.log
    üì§ Emitted group_ready for room 691041c1b5acd9afc5853f63 ‚Üí group 691041c1b5acd9afc5853f64

      at SocketEmitter.emitGroupReady (src/config/socket.ts:187:13)

  console.log
    üì§ Emitted room_expired for room 691041c1b5acd9afc5853f6e

      at SocketEmitter.emitRoomExpired (src/config/socket.ts:199:13)

  console.log
    üì§ Emitted room_expired for room 691041c1b5acd9afc5853f6e

      at SocketEmitter.emitRoomExpired (src/config/socket.ts:199:13)

  console.log
    Test suite completed.

      at Object.<anonymous> (tests/setup.ts:14:11)

  console.log
    
    üßπ Cleaning up after tests...

      at Object.<anonymous> (tests/no-mocks/matching.test.ts:54:11)

  console.log
    üßπ Cleaning matching test data...

      at cleanMatchingTestData (tests/helpers/matching.helper.ts:122:11)

  console.log
    ‚úÖ Matching test data cleaned

      at cleanMatchingTestData (tests/helpers/matching.helper.ts:135:11)

  console.warn
    MongoDB disconnected. Attempting to reconnect...

      28 |
      29 |     mongoose.connection.on('disconnected', () => {
    > 30 |       console.warn('MongoDB disconnected. Attempting to reconnect...');
         |               ^
      31 |     });
      32 |
      33 |     mongoose.connection.on('reconnected', () => {

      at NativeConnection.<anonymous> (src/config/database.ts:30:15)
      at NativeConnection.set (node_modules/mongoose/lib/connection.js:145:12)
      at NativeConnection.onClose (node_modules/mongoose/lib/connection.js:1315:19)
      at NativeConnection._close (node_modules/mongoose/lib/connection.js:1264:12)
      at disconnectDatabase (src/config/database.ts:55:5)
      at Object.<anonymous> (tests/no-mocks/matching.test.ts:58:3)

  console.log
    MongoDB disconnected successfully

      at disconnectDatabase (src/config/database.ts:56:13)

  console.log
    ‚úÖ HTTP server closed

      at Server.<anonymous> (tests/helpers/socket.helper.ts:44:15)

  console.log
    ‚úÖ Socket.IO server closed

      at tests/helpers/socket.helper.ts:40:15

  console.log
    ‚úÖ Cleanup complete.

      at Object.<anonymous> (tests/no-mocks/matching.test.ts:63:11)

PASS tests/no-mocks/matching.test.ts
  POST /api/matching/join - No Mocking
    ‚úì should create new room when no matching rooms exist and update user preferences (36 ms)
    ‚úì should join existing room with matching preferences (36 ms)
    ‚úì should return 401 without authentication (15 ms)
    ‚úì should return 200 with null roomId when no good match found (covers matchingService lines 69-70) (54 ms)
    ‚úì should return 500 when user already in room (40 ms)
  POST /api/matching/join/:roomId - No Mocking
    ‚úì should return 501 Not Implemented (13 ms)
  PUT /api/matching/leave/:roomId - No Mocking
    ‚úì should successfully leave room and delete room when last member leaves (43 ms)
    ‚úì should handle leaving non-existent room gracefully (73 ms)
  GET /api/matching/status/:roomId - No Mocking
    ‚úì should return room status for valid roomId (139 ms)
    ‚úì should return 500 for non-existent room (439 ms)
  GET /api/matching/users/:roomId - No Mocking
    ‚úì should return list of users in room (22 ms)
  Room Model Methods - Integration Tests
    ‚úì should trigger pre-save hook to expire room (81 ms)
  SocketManager - Integration Tests
    ‚úì should warn and return early when initialize is called twice (20 ms)
    ‚úì should call emitGroupReady through socketManager (17 ms)
    ‚úì should call emitRoomExpired through socketManager (11 ms)
    ‚úì should throw error when getIO is called before initialize (24 ms)
    ‚úì should emit event to user when socket with matching userId is found (9 ms)
    ‚úì should log warning when no socket with matching userId is found (16 ms)

  console.log
    [dotenv@17.2.3] injecting env (3) from .env.test -- tip: üîë add access controls to secrets: https://dotenvx.com/ops

      at _log (node_modules/dotenv/lib/main.js:142:11)

  console.log
    Starting test suite...

      at Object.<anonymous> (tests/setup.ts:9:11)

  console.log
    
    üöÄ Starting Group Tests (With Mocks - Failure Scenarios)...

      at Object.<anonymous> (tests/with-mocks/group.mock.test.ts:68:11)

  console.log
    MongoDB Atlas connected successfully

      at connectDatabase (src/config/database.ts:22:13)

  console.log
    ‚úÖ Test setup complete.

      at Object.<anonymous> (tests/with-mocks/group.mock.test.ts:71:11)

  console.error
    Error: {
      message: 'MongoNetworkError: connection refused',
      statusCode: 500,
      stack: 'Error: MongoNetworkError: connection refused\n' +
        '    at Object.<anonymous> (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/tests/with-mocks/group.mock.test.ts:101:7)\n' +
        '    at Promise.finally.completed (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:1557:28)\n' +
        '    at new Promise (<anonymous>)\n' +
        '    at callAsyncCircusFn (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:1497:10)\n' +
        '    at _callCircusTest (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:1007:40)\n' +
        '    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n' +
        '    at _runTest (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:947:3)\n' +
        '    at /Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:849:7\n' +
        '    at _runTestsForDescribeBlock (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:862:11)\n' +
        '    at _runTestsForDescribeBlock (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:857:11)\n' +
        '    at run (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:761:3)\n' +
        '    at runAndTransformResultsToJestFormat (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:1918:21)\n' +
        '    at jestAdapter (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/runner.js:101:19)\n' +
        '    at runTestInternal (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-runner/build/index.js:275:16)\n' +
        '    at runTest (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-runner/build/index.js:343:7)',
      timestamp: '2025-11-09T07:24:50.010Z',
      path: '/api/group/status',
      method: 'GET'
    }

      90 |   }
      91 |
    > 92 |   console.error('Error:', {
         |           ^
      93 |     message: err.message,
      94 |     statusCode,
      95 |     stack: err.stack,

      at error (src/middleware/errorHandler.ts:92:11)
      at Layer.handleError (node_modules/router/lib/layer.js:116:17)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at Layer.handleError (node_modules/router/lib/layer.js:111:12)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at node_modules/router/index.js:688:15
      at next (node_modules/router/index.js:276:14)
      at next (node_modules/router/lib/route.js:132:14)
      at GroupController.next [as getGroupStatus] (src/controllers/group.controller.ts:36:7)
      at src/routes/group.routes.ts:14:3
      at src/middleware/errorHandler.ts:58:9

  console.error
    Error: {
      message: 'MongoServerError: operation exceeded time limit',
      statusCode: 500,
      stack: 'Error: MongoServerError: operation exceeded time limit\n' +
        '    at Object.<anonymous> (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/tests/with-mocks/group.mock.test.ts:132:7)\n' +
        '    at processTicksAndRejections (node:internal/process/task_queues:105:5)',
      timestamp: '2025-11-09T07:24:50.017Z',
      path: '/api/group/status',
      method: 'GET'
    }

      90 |   }
      91 |
    > 92 |   console.error('Error:', {
         |           ^
      93 |     message: err.message,
      94 |     statusCode,
      95 |     stack: err.stack,

      at error (src/middleware/errorHandler.ts:92:11)
      at Layer.handleError (node_modules/router/lib/layer.js:116:17)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at Layer.handleError (node_modules/router/lib/layer.js:111:12)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at node_modules/router/index.js:688:15
      at next (node_modules/router/index.js:276:14)
      at next (node_modules/router/lib/route.js:132:14)
      at GroupController.next [as getGroupStatus] (src/controllers/group.controller.ts:36:7)
      at src/routes/group.routes.ts:14:3
      at src/middleware/errorHandler.ts:58:9

  console.error
    Error: {
      message: 'MongoServerSelectionError: server selection timed out',
      statusCode: 500,
      stack: 'Error: MongoServerSelectionError: server selection timed out\n' +
        '    at Object.<anonymous> (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/tests/with-mocks/group.mock.test.ts:161:7)\n' +
        '    at processTicksAndRejections (node:internal/process/task_queues:105:5)',
      timestamp: '2025-11-09T07:24:50.025Z',
      path: '/api/group/status',
      method: 'GET'
    }

      90 |   }
      91 |
    > 92 |   console.error('Error:', {
         |           ^
      93 |     message: err.message,
      94 |     statusCode,
      95 |     stack: err.stack,

      at error (src/middleware/errorHandler.ts:92:11)
      at Layer.handleError (node_modules/router/lib/layer.js:116:17)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at Layer.handleError (node_modules/router/lib/layer.js:111:12)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at node_modules/router/index.js:688:15
      at next (node_modules/router/index.js:276:14)
      at next (node_modules/router/lib/route.js:132:14)
      at GroupController.next [as getGroupStatus] (src/controllers/group.controller.ts:36:7)
      at src/routes/group.routes.ts:14:3
      at src/middleware/errorHandler.ts:58:9

  console.error
    Error: {
      message: 'MongoNetworkError: socket timeout',
      statusCode: 500,
      stack: 'Error: MongoNetworkError: socket timeout\n' +
        '    at Object.<anonymous> (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/tests/with-mocks/group.mock.test.ts:188:7)\n' +
        '    at Promise.finally.completed (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:1557:28)\n' +
        '    at new Promise (<anonymous>)\n' +
        '    at callAsyncCircusFn (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:1497:10)\n' +
        '    at _callCircusTest (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:1007:40)\n' +
        '    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n' +
        '    at _runTest (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:947:3)\n' +
        '    at /Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:849:7\n' +
        '    at _runTestsForDescribeBlock (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:862:11)\n' +
        '    at _runTestsForDescribeBlock (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:857:11)\n' +
        '    at run (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:761:3)\n' +
        '    at runAndTransformResultsToJestFormat (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:1918:21)\n' +
        '    at jestAdapter (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/runner.js:101:19)\n' +
        '    at runTestInternal (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-runner/build/index.js:275:16)\n' +
        '    at runTest (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-runner/build/index.js:343:7)',
      timestamp: '2025-11-09T07:24:50.030Z',
      path: '/api/group/vote/some-group-id',
      method: 'POST'
    }

      90 |   }
      91 |
    > 92 |   console.error('Error:', {
         |           ^
      93 |     message: err.message,
      94 |     statusCode,
      95 |     stack: err.stack,

      at error (src/middleware/errorHandler.ts:92:11)
      at Layer.handleError (node_modules/router/lib/layer.js:116:17)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at Layer.handleError (node_modules/router/lib/layer.js:111:12)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at node_modules/router/index.js:688:15
      at next (node_modules/router/index.js:276:14)
      at next (node_modules/router/lib/route.js:132:14)
      at GroupController.next [as voteForRestaurant] (src/controllers/group.controller.ts:75:7)
      at src/routes/group.routes.ts:23:3
      at src/middleware/errorHandler.ts:58:9

  console.error
    Error: {
      message: 'MongoServerError: write operation failed',
      statusCode: 500,
      stack: 'Error: MongoServerError: write operation failed\n' +
        '    at Object.<anonymous> (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/tests/with-mocks/group.mock.test.ts:224:7)\n' +
        '    at processTicksAndRejections (node:internal/process/task_queues:105:5)',
      timestamp: '2025-11-09T07:24:50.038Z',
      path: '/api/group/vote/691041c23dc313ede14becec',
      method: 'POST'
    }

      90 |   }
      91 |
    > 92 |   console.error('Error:', {
         |           ^
      93 |     message: err.message,
      94 |     statusCode,
      95 |     stack: err.stack,

      at error (src/middleware/errorHandler.ts:92:11)
      at Layer.handleError (node_modules/router/lib/layer.js:116:17)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at Layer.handleError (node_modules/router/lib/layer.js:111:12)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at node_modules/router/index.js:688:15
      at next (node_modules/router/index.js:276:14)
      at next (node_modules/router/lib/route.js:132:14)
      at GroupController.next [as voteForRestaurant] (src/controllers/group.controller.ts:75:7)
      at src/routes/group.routes.ts:23:3
      at src/middleware/errorHandler.ts:58:9

  console.error
    Failed to emit vote update: Error: WebSocket connection closed
        at Object.<anonymous> (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/tests/with-mocks/group.mock.test.ts:260:13)
        at /Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-mock/build/index.js:305:39
        at Object.<anonymous> (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-mock/build/index.js:312:13)
        at Object.mockConstructor [as emitVoteUpdate] (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-mock/build/index.js:102:19)
        at GroupService.emitVoteUpdate [as voteForRestaurant] (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/src/services/groupService.ts:97:21)
        at processTicksAndRejections (node:internal/process/task_queues:105:5)
        at GroupController.voteForRestaurant (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/src/controllers/group.controller.ts:59:22)
        at /Users/hashim/Desktop/Development/FeastFriends/321-project/backend/src/routes/group.routes.ts:23:3
        at /Users/hashim/Desktop/Development/FeastFriends/321-project/backend/src/middleware/errorHandler.ts:58:9

      103 |       );
      104 |     } catch (error) {
    > 105 |       console.error('Failed to emit vote update:', error);
          |               ^
      106 |       // Continue execution - socket failure shouldn't block voting
      107 |     }
      108 |

      at GroupService.error [as voteForRestaurant] (src/services/groupService.ts:105:15)
      at GroupController.voteForRestaurant (src/controllers/group.controller.ts:59:22)
      at src/routes/group.routes.ts:23:3
      at src/middleware/errorHandler.ts:58:9

  console.error
    Failed to send notification: Error: FirebaseError: service unavailable
        at Object.<anonymous> (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/tests/with-mocks/group.mock.test.ts:297:7)
        at processTicksAndRejections (node:internal/process/task_queues:105:5)

      147 |           );
      148 |         } catch (error) {
    > 149 |           console.error('Failed to send notification:', error);
          |                   ^
      150 |         }
      151 |
      152 |         console.log(`√¢≈ì‚Ä¶ Restaurant selected for group ${groupId}`);

      at GroupService.error [as voteForRestaurant] (src/services/groupService.ts:149:19)
      at GroupController.voteForRestaurant (src/controllers/group.controller.ts:59:22)
      at src/routes/group.routes.ts:23:3
      at src/middleware/errorHandler.ts:58:9

  console.log
    √¢≈ì‚Ä¶ Restaurant selected for group 691041c23dc313ede14becf5

      at GroupService.log [as voteForRestaurant] (src/services/groupService.ts:152:17)

  console.error
    Failed to send notification: Error: Request timeout
        at Timeout._onTimeout (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/tests/with-mocks/group.mock.test.ts:342:33)
        at listOnTimeout (node:internal/timers:588:17)
        at processTimers (node:internal/timers:523:7)

      147 |           );
      148 |         } catch (error) {
    > 149 |           console.error('Failed to send notification:', error);
          |                   ^
      150 |         }
      151 |
      152 |         console.log(`√¢≈ì‚Ä¶ Restaurant selected for group ${groupId}`);

      at GroupService.error [as voteForRestaurant] (src/services/groupService.ts:149:19)
      at GroupController.voteForRestaurant (src/controllers/group.controller.ts:59:22)
      at src/routes/group.routes.ts:23:3
      at src/middleware/errorHandler.ts:58:9

  console.log
    √¢≈ì‚Ä¶ Restaurant selected for group 691041c23dc313ede14becfb

      at GroupService.log [as voteForRestaurant] (src/services/groupService.ts:152:17)

  console.error
    Error: {
      message: 'MongoNetworkError: connection lost',
      statusCode: 500,
      stack: 'Error: MongoNetworkError: connection lost\n' +
        '    at Object.<anonymous> (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/tests/with-mocks/group.mock.test.ts:386:30)\n' +
        '    at processTicksAndRejections (node:internal/process/task_queues:105:5)',
      timestamp: '2025-11-09T07:24:50.211Z',
      path: '/api/group/vote/691041c23dc313ede14bed01',
      method: 'POST'
    }

      90 |   }
      91 |
    > 92 |   console.error('Error:', {
         |           ^
      93 |     message: err.message,
      94 |     statusCode,
      95 |     stack: err.stack,

      at error (src/middleware/errorHandler.ts:92:11)
      at Layer.handleError (node_modules/router/lib/layer.js:116:17)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at Layer.handleError (node_modules/router/lib/layer.js:111:12)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at node_modules/router/index.js:688:15
      at next (node_modules/router/index.js:276:14)
      at next (node_modules/router/lib/route.js:132:14)
      at GroupController.next [as voteForRestaurant] (src/controllers/group.controller.ts:75:7)
      at src/routes/group.routes.ts:23:3
      at src/middleware/errorHandler.ts:58:9

  console.error
    Error: {
      message: 'MongoNetworkError: no connection available',
      statusCode: 500,
      stack: 'Error: MongoNetworkError: no connection available\n' +
        '    at Object.<anonymous> (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/tests/with-mocks/group.mock.test.ts:420:7)\n' +
        '    at Promise.finally.completed (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:1557:28)\n' +
        '    at new Promise (<anonymous>)\n' +
        '    at callAsyncCircusFn (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:1497:10)\n' +
        '    at _callCircusTest (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:1007:40)\n' +
        '    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n' +
        '    at _runTest (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:947:3)\n' +
        '    at /Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:849:7\n' +
        '    at _runTestsForDescribeBlock (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:862:11)\n' +
        '    at _runTestsForDescribeBlock (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:857:11)\n' +
        '    at run (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:761:3)\n' +
        '    at runAndTransformResultsToJestFormat (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:1918:21)\n' +
        '    at jestAdapter (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/runner.js:101:19)\n' +
        '    at runTestInternal (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-runner/build/index.js:275:16)\n' +
        '    at runTest (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-runner/build/index.js:343:7)',
      timestamp: '2025-11-09T07:24:50.214Z',
      path: '/api/group/leave/some-group-id',
      method: 'POST'
    }

      90 |   }
      91 |
    > 92 |   console.error('Error:', {
         |           ^
      93 |     message: err.message,
      94 |     statusCode,
      95 |     stack: err.stack,

      at error (src/middleware/errorHandler.ts:92:11)
      at Layer.handleError (node_modules/router/lib/layer.js:116:17)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at Layer.handleError (node_modules/router/lib/layer.js:111:12)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at Immediate.next (node_modules/router/index.js:291:5)
      at Immediate._onImmediate (node_modules/router/index.js:688:15)

  console.error
    Error: {
      message: 'MongoServerError: cursor timeout',
      statusCode: 500,
      stack: 'Error: MongoServerError: cursor timeout\n' +
        '    at Object.<anonymous> (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/tests/with-mocks/group.mock.test.ts:450:7)\n' +
        '    at processTicksAndRejections (node:internal/process/task_queues:105:5)',
      timestamp: '2025-11-09T07:24:50.224Z',
      path: '/api/group/leave/691041c23dc313ede14bed05',
      method: 'POST'
    }

      90 |   }
      91 |
    > 92 |   console.error('Error:', {
         |           ^
      93 |     message: err.message,
      94 |     statusCode,
      95 |     stack: err.stack,

      at error (src/middleware/errorHandler.ts:92:11)
      at Layer.handleError (node_modules/router/lib/layer.js:116:17)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at Layer.handleError (node_modules/router/lib/layer.js:111:12)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at Immediate.next (node_modules/router/index.js:291:5)
      at Immediate._onImmediate (node_modules/router/index.js:688:15)

  console.error
    Error: {
      message: 'MongoServerError: disk full',
      statusCode: 500,
      stack: 'Error: MongoServerError: disk full\n' +
        '    at Object.<anonymous> (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/tests/with-mocks/group.mock.test.ts:485:7)\n' +
        '    at processTicksAndRejections (node:internal/process/task_queues:105:5)',
      timestamp: '2025-11-09T07:24:50.231Z',
      path: '/api/group/leave/691041c23dc313ede14bed08',
      method: 'POST'
    }

      90 |   }
      91 |
    > 92 |   console.error('Error:', {
         |           ^
      93 |     message: err.message,
      94 |     statusCode,
      95 |     stack: err.stack,

      at error (src/middleware/errorHandler.ts:92:11)
      at Layer.handleError (node_modules/router/lib/layer.js:116:17)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at Layer.handleError (node_modules/router/lib/layer.js:111:12)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at Immediate.next (node_modules/router/index.js:291:5)
      at Immediate._onImmediate (node_modules/router/index.js:688:15)

  console.error
    Error: {
      message: 'MongoServerError: write operation failed',
      statusCode: 500,
      stack: 'Error: MongoServerError: write operation failed\n' +
        '    at Object.<anonymous> (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/tests/with-mocks/group.mock.test.ts:520:7)\n' +
        '    at processTicksAndRejections (node:internal/process/task_queues:105:5)',
      timestamp: '2025-11-09T07:24:50.239Z',
      path: '/api/group/leave/691041c23dc313ede14bed0d',
      method: 'POST'
    }

      90 |   }
      91 |
    > 92 |   console.error('Error:', {
         |           ^
      93 |     message: err.message,
      94 |     statusCode,
      95 |     stack: err.stack,

      at error (src/middleware/errorHandler.ts:92:11)
      at Layer.handleError (node_modules/router/lib/layer.js:116:17)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at Layer.handleError (node_modules/router/lib/layer.js:111:12)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at Immediate.next (node_modules/router/index.js:291:5)
      at Immediate._onImmediate (node_modules/router/index.js:688:15)

  console.error
    Error: {
      message: 'MongoNetworkError: connection closed',
      statusCode: 500,
      stack: 'Error: MongoNetworkError: connection closed\n' +
        '    at Object.<anonymous> (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/tests/with-mocks/group.mock.test.ts:555:7)\n' +
        '    at processTicksAndRejections (node:internal/process/task_queues:105:5)',
      timestamp: '2025-11-09T07:24:50.247Z',
      path: '/api/group/leave/691041c23dc313ede14bed13',
      method: 'POST'
    }

      90 |   }
      91 |
    > 92 |   console.error('Error:', {
         |           ^
      93 |     message: err.message,
      94 |     statusCode,
      95 |     stack: err.stack,

      at error (src/middleware/errorHandler.ts:92:11)
      at Layer.handleError (node_modules/router/lib/layer.js:116:17)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at Layer.handleError (node_modules/router/lib/layer.js:111:12)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at Immediate.next (node_modules/router/index.js:291:5)
      at Immediate._onImmediate (node_modules/router/index.js:688:15)

  console.error
    Failed to emit member left: Error: Socket.IO error: transport closed
        at Object.<anonymous> (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/tests/with-mocks/group.mock.test.ts:594:13)
        at /Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-mock/build/index.js:305:39
        at Object.<anonymous> (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-mock/build/index.js:312:13)
        at Object.mockConstructor [as emitMemberLeft] (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-mock/build/index.js:102:19)
        at GroupService.emitMemberLeft [as leaveGroup] (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/src/services/groupService.ts:201:23)
        at processTicksAndRejections (node:internal/process/task_queues:105:5)
        at GroupController.leaveGroup (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/src/controllers/group.controller.ts:88:7)
        at /Users/hashim/Desktop/Development/FeastFriends/321-project/backend/src/routes/group.routes.ts:32:3
        at /Users/hashim/Desktop/Development/FeastFriends/321-project/backend/src/middleware/errorHandler.ts:58:9

      206 |         );
      207 |       } catch (error) {
    > 208 |         console.error('Failed to emit member left:', error);
          |                 ^
      209 |       }
      210 |
      211 |       // Check if restaurant should be auto-selected (all remaining voted)

      at GroupService.error [as leaveGroup] (src/services/groupService.ts:208:17)
      at GroupController.leaveGroup (src/controllers/group.controller.ts:88:7)
      at src/routes/group.routes.ts:32:3
      at src/middleware/errorHandler.ts:58:9

  console.error
    Failed to send notification: Error: FirebaseError: messaging/server-unavailable
        at Object.<anonymous> (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/tests/with-mocks/group.mock.test.ts:649:7)
        at processTicksAndRejections (node:internal/process/task_queues:105:5)

      257 |             );
      258 |           } catch (error) {
    > 259 |             console.error('Failed to send notification:', error);
          |                     ^
      260 |           }
      261 |         }
      262 |       }

      at GroupService.error [as leaveGroup] (src/services/groupService.ts:259:21)
      at GroupController.leaveGroup (src/controllers/group.controller.ts:88:7)
      at src/routes/group.routes.ts:32:3
      at src/middleware/errorHandler.ts:58:9

  console.error
    Error: {
      message: 'MongoServerError: replica set not available',
      statusCode: 500,
      stack: 'Error: MongoServerError: replica set not available\n' +
        '    at Object.<anonymous> (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/tests/with-mocks/group.mock.test.ts:702:30)\n' +
        '    at processTicksAndRejections (node:internal/process/task_queues:105:5)',
      timestamp: '2025-11-09T07:24:50.282Z',
      path: '/api/group/leave/691041c23dc313ede14bed2c',
      method: 'POST'
    }

      90 |   }
      91 |
    > 92 |   console.error('Error:', {
         |           ^
      93 |     message: err.message,
      94 |     statusCode,
      95 |     stack: err.stack,

      at error (src/middleware/errorHandler.ts:92:11)
      at Layer.handleError (node_modules/router/lib/layer.js:116:17)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at Layer.handleError (node_modules/router/lib/layer.js:111:12)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at Immediate.next (node_modules/router/index.js:291:5)
      at Immediate._onImmediate (node_modules/router/index.js:688:15)

  console.error
    Failed to emit vote update: Error: Socket error
        at Object.<anonymous> (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/tests/with-mocks/group.mock.test.ts:738:13)
        at /Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-mock/build/index.js:305:39
        at Object.<anonymous> (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-mock/build/index.js:312:13)
        at Object.mockConstructor [as emitVoteUpdate] (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-mock/build/index.js:102:19)
        at GroupService.emitVoteUpdate [as voteForRestaurant] (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/src/services/groupService.ts:97:21)
        at processTicksAndRejections (node:internal/process/task_queues:105:5)
        at GroupController.voteForRestaurant (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/src/controllers/group.controller.ts:59:22)
        at /Users/hashim/Desktop/Development/FeastFriends/321-project/backend/src/routes/group.routes.ts:23:3
        at /Users/hashim/Desktop/Development/FeastFriends/321-project/backend/src/middleware/errorHandler.ts:58:9

      103 |       );
      104 |     } catch (error) {
    > 105 |       console.error('Failed to emit vote update:', error);
          |               ^
      106 |       // Continue execution - socket failure shouldn't block voting
      107 |     }
      108 |

      at GroupService.error [as voteForRestaurant] (src/services/groupService.ts:105:15)
      at GroupController.voteForRestaurant (src/controllers/group.controller.ts:59:22)
      at src/routes/group.routes.ts:23:3
      at src/middleware/errorHandler.ts:58:9

  console.error
    Failed to emit restaurant selected: Error: Socket error
        at Object.<anonymous> (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/tests/with-mocks/group.mock.test.ts:741:13)
        at /Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-mock/build/index.js:305:39
        at Object.<anonymous> (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-mock/build/index.js:312:13)
        at Object.mockConstructor [as emitRestaurantSelected] (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-mock/build/index.js:102:19)
        at GroupService.emitRestaurantSelected [as voteForRestaurant] (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/src/services/groupService.ts:124:25)
        at processTicksAndRejections (node:internal/process/task_queues:105:5)
        at GroupController.voteForRestaurant (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/src/controllers/group.controller.ts:59:22)
        at /Users/hashim/Desktop/Development/FeastFriends/321-project/backend/src/routes/group.routes.ts:23:3
        at /Users/hashim/Desktop/Development/FeastFriends/321-project/backend/src/middleware/errorHandler.ts:58:9

      129 |           );
      130 |         } catch (error) {
    > 131 |           console.error('Failed to emit restaurant selected:', error);
          |                   ^
      132 |         }
      133 |
      134 |         // // Send notifications

      at GroupService.error [as voteForRestaurant] (src/services/groupService.ts:131:19)
      at GroupController.voteForRestaurant (src/controllers/group.controller.ts:59:22)
      at src/routes/group.routes.ts:23:3
      at src/middleware/errorHandler.ts:58:9

  console.error
    Failed to send notification: Error: Firebase error
        at Object.<anonymous> (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/tests/with-mocks/group.mock.test.ts:744:7)
        at processTicksAndRejections (node:internal/process/task_queues:105:5)

      147 |           );
      148 |         } catch (error) {
    > 149 |           console.error('Failed to send notification:', error);
          |                   ^
      150 |         }
      151 |
      152 |         console.log(`√¢≈ì‚Ä¶ Restaurant selected for group ${groupId}`);

      at GroupService.error [as voteForRestaurant] (src/services/groupService.ts:149:19)
      at GroupController.voteForRestaurant (src/controllers/group.controller.ts:59:22)
      at src/routes/group.routes.ts:23:3
      at src/middleware/errorHandler.ts:58:9

  console.log
    √¢≈ì‚Ä¶ Restaurant selected for group 691041c23dc313ede14bed35

      at GroupService.log [as voteForRestaurant] (src/services/groupService.ts:152:17)

  console.error
    Error: {
      message: 'MongoNetworkError: network partition detected',
      statusCode: 500,
      stack: 'Error: MongoNetworkError: network partition detected\n' +
        '    at Object.<anonymous> (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/tests/with-mocks/group.mock.test.ts:814:7)\n' +
        '    at processTicksAndRejections (node:internal/process/task_queues:105:5)',
      timestamp: '2025-11-09T07:24:50.305Z',
      path: '/api/group/vote/691041c23dc313ede14bed3b',
      method: 'POST'
    }

      90 |   }
      91 |
    > 92 |   console.error('Error:', {
         |           ^
      93 |     message: err.message,
      94 |     statusCode,
      95 |     stack: err.stack,

      at error (src/middleware/errorHandler.ts:92:11)
      at Layer.handleError (node_modules/router/lib/layer.js:116:17)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at Layer.handleError (node_modules/router/lib/layer.js:111:12)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at node_modules/router/index.js:688:15
      at next (node_modules/router/index.js:276:14)
      at next (node_modules/router/lib/route.js:132:14)
      at GroupController.next [as voteForRestaurant] (src/controllers/group.controller.ts:75:7)
      at src/routes/group.routes.ts:23:3
      at src/middleware/errorHandler.ts:58:9

  console.log
    Test suite completed.

      at Object.<anonymous> (tests/setup.ts:14:11)

  console.log
    
    üßπ Cleaning up after tests...

      at Object.<anonymous> (tests/with-mocks/group.mock.test.ts:75:11)

  console.warn
    MongoDB disconnected. Attempting to reconnect...

      28 |
      29 |     mongoose.connection.on('disconnected', () => {
    > 30 |       console.warn('MongoDB disconnected. Attempting to reconnect...');
         |               ^
      31 |     });
      32 |
      33 |     mongoose.connection.on('reconnected', () => {

      at NativeConnection.<anonymous> (src/config/database.ts:30:15)
      at NativeConnection.set (node_modules/mongoose/lib/connection.js:145:12)
      at NativeConnection.onClose (node_modules/mongoose/lib/connection.js:1315:19)
      at NativeConnection._close (node_modules/mongoose/lib/connection.js:1264:12)
      at disconnectDatabase (src/config/database.ts:55:5)
      at Object.<anonymous> (tests/with-mocks/group.mock.test.ts:77:3)

  console.log
    MongoDB disconnected successfully

      at disconnectDatabase (src/config/database.ts:56:13)

  console.log
    ‚úÖ Cleanup complete.

      at Object.<anonymous> (tests/with-mocks/group.mock.test.ts:78:11)

PASS tests/with-mocks/group.mock.test.ts
  GET /api/group/status - External Failures
    ‚úì should return 500 when database connection fails during User.findById (11 ms)
    ‚úì should return 500 when database timeout occurs during Group.findById (7 ms)
    ‚úì should return 500 when MongoDB server is unavailable (7 ms)
  POST /api/group/vote/:groupId - External Failures
    ‚úì should return 500 when database fails during Group.findById (5 ms)
    ‚úì should return 500 when database fails during group.save() (8 ms)
    ‚úì should handle Socket.IO emission failure gracefully (15 ms)
    ‚úì should handle Firebase notification failure when restaurant selected (11 ms)
    ‚úì should handle Firebase timeout when sending notifications (139 ms)
    ‚úì should return 500 when second save() fails during restaurant selection (8 ms)
  POST /api/group/leave/:groupId - External Failures
    ‚úì should return 500 when database fails during Group.findById (5 ms)
    ‚úì should return 500 when database fails during User.findById (7 ms)
    ‚úì should return 500 when user.save() fails (7 ms)
    ‚úì should return 500 when Group.findByIdAndDelete fails (empty group) (8 ms)
    ‚úì should return 500 when group.save() fails (non-empty group) (8 ms)
    ‚úì should handle Socket.IO emission failure when member leaves (9 ms)
    ‚úì should handle Firebase failure when notifying after auto-selection (15 ms)
    ‚úì should return 500 when auto-selection save fails (12 ms)
  Edge Case: Multiple Simultaneous Failures
    ‚úì should handle cascade of failures gracefully (13 ms)
  Network Timeout Scenarios
    ‚úì should handle database query timeout (2 ms)
    ‚úì should handle network partition during write (7 ms)

  console.log
    [dotenv@17.2.3] injecting env (3) from .env.test -- tip: ‚öôÔ∏è  suppress all logs with { quiet: true }

      at _log (node_modules/dotenv/lib/main.js:142:11)

  console.log
    Starting test suite...

      at Object.<anonymous> (tests/setup.ts:9:11)

  console.error
    Error: {
      message: 'User not found',
      statusCode: 500,
      stack: 'Error: User not found\n' +
        '    at MatchingService.joinMatching (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/src/services/matchingService.ts:88:13)\n' +
        '    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n' +
        '    at MatchingController.joinMatching (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/src/controllers/matching.controller.ts:17:22)\n' +
        '    at /Users/hashim/Desktop/Development/FeastFriends/321-project/backend/src/routes/matching.routes.ts:14:3\n' +
        '    at /Users/hashim/Desktop/Development/FeastFriends/321-project/backend/src/middleware/errorHandler.ts:58:9',
      timestamp: '2025-11-09T07:24:50.667Z',
      path: '/api/matching/join',
      method: 'POST'
    }

      90 |   }
      91 |
    > 92 |   console.error('Error:', {
         |           ^
      93 |     message: err.message,
      94 |     statusCode,
      95 |     stack: err.stack,

      at error (src/middleware/errorHandler.ts:92:11)
      at Layer.handleError (node_modules/router/lib/layer.js:116:17)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at Layer.handleError (node_modules/router/lib/layer.js:111:12)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at node_modules/router/index.js:688:15
      at next (node_modules/router/index.js:276:14)
      at next (node_modules/router/lib/route.js:132:14)
      at MatchingController.next [as joinMatching] (src/controllers/matching.controller.ts:29:7)
      at src/routes/matching.routes.ts:14:3
      at src/middleware/errorHandler.ts:58:9

  console.error
    Error: {
      message: 'Database connection lost',
      statusCode: 500,
      stack: 'Error: Database connection lost\n' +
        '    at Object.<anonymous> (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/tests/with-mocks/matching.mock.test.ts:157:43)\n' +
        '    at Promise.finally.completed (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:1557:28)\n' +
        '    at new Promise (<anonymous>)\n' +
        '    at callAsyncCircusFn (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:1497:10)\n' +
        '    at _callCircusTest (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:1007:40)\n' +
        '    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n' +
        '    at _runTest (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:947:3)\n' +
        '    at /Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:849:7\n' +
        '    at _runTestsForDescribeBlock (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:862:11)\n' +
        '    at _runTestsForDescribeBlock (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:857:11)\n' +
        '    at run (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:761:3)\n' +
        '    at runAndTransformResultsToJestFormat (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:1918:21)\n' +
        '    at jestAdapter (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/runner.js:101:19)\n' +
        '    at runTestInternal (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-runner/build/index.js:275:16)\n' +
        '    at runTest (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-runner/build/index.js:343:7)',
      timestamp: '2025-11-09T07:24:50.677Z',
      path: '/api/matching/join',
      method: 'POST'
    }

      90 |   }
      91 |
    > 92 |   console.error('Error:', {
         |           ^
      93 |     message: err.message,
      94 |     statusCode,
      95 |     stack: err.stack,

      at error (src/middleware/errorHandler.ts:92:11)
      at Layer.handleError (node_modules/router/lib/layer.js:116:17)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at Layer.handleError (node_modules/router/lib/layer.js:111:12)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at node_modules/router/index.js:688:15
      at next (node_modules/router/index.js:276:14)
      at next (node_modules/router/lib/route.js:132:14)
      at MatchingController.next [as joinMatching] (src/controllers/matching.controller.ts:29:7)
      at src/routes/matching.routes.ts:14:3
      at src/middleware/errorHandler.ts:58:9

  console.error
    Error: {
      message: 'User is already in a room or group',
      statusCode: 500,
      stack: 'Error: User is already in a room or group\n' +
        '    at MatchingService.joinMatching (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/src/services/matchingService.ts:93:13)\n' +
        '    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n' +
        '    at MatchingController.joinMatching (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/src/controllers/matching.controller.ts:17:22)\n' +
        '    at /Users/hashim/Desktop/Development/FeastFriends/321-project/backend/src/routes/matching.routes.ts:14:3\n' +
        '    at /Users/hashim/Desktop/Development/FeastFriends/321-project/backend/src/middleware/errorHandler.ts:58:9',
      timestamp: '2025-11-09T07:24:50.680Z',
      path: '/api/matching/join',
      method: 'POST'
    }

      90 |   }
      91 |
    > 92 |   console.error('Error:', {
         |           ^
      93 |     message: err.message,
      94 |     statusCode,
      95 |     stack: err.stack,

      at error (src/middleware/errorHandler.ts:92:11)
      at Layer.handleError (node_modules/router/lib/layer.js:116:17)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at Layer.handleError (node_modules/router/lib/layer.js:111:12)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at node_modules/router/index.js:688:15
      at next (node_modules/router/index.js:276:14)
      at next (node_modules/router/lib/route.js:132:14)
      at MatchingController.next [as joinMatching] (src/controllers/matching.controller.ts:29:7)
      at src/routes/matching.routes.ts:14:3
      at src/middleware/errorHandler.ts:58:9

  console.error
    Error: {
      message: 'Query timeout',
      statusCode: 500,
      stack: 'Error: Query timeout\n' +
        '    at Object.<anonymous> (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/tests/with-mocks/matching.mock.test.ts:242:39)\n' +
        '    at Promise.finally.completed (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:1557:28)\n' +
        '    at new Promise (<anonymous>)\n' +
        '    at callAsyncCircusFn (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:1497:10)\n' +
        '    at _callCircusTest (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:1007:40)\n' +
        '    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n' +
        '    at _runTest (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:947:3)\n' +
        '    at /Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:849:7\n' +
        '    at _runTestsForDescribeBlock (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:862:11)\n' +
        '    at _runTestsForDescribeBlock (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:857:11)\n' +
        '    at run (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:761:3)\n' +
        '    at runAndTransformResultsToJestFormat (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:1918:21)\n' +
        '    at jestAdapter (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/runner.js:101:19)\n' +
        '    at runTestInternal (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-runner/build/index.js:275:16)\n' +
        '    at runTest (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-runner/build/index.js:343:7)',
      timestamp: '2025-11-09T07:24:50.683Z',
      path: '/api/matching/join',
      method: 'POST'
    }

      90 |   }
      91 |
    > 92 |   console.error('Error:', {
         |           ^
      93 |     message: err.message,
      94 |     statusCode,
      95 |     stack: err.stack,

      at error (src/middleware/errorHandler.ts:92:11)
      at Layer.handleError (node_modules/router/lib/layer.js:116:17)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at Layer.handleError (node_modules/router/lib/layer.js:111:12)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at node_modules/router/index.js:688:15
      at next (node_modules/router/index.js:276:14)
      at next (node_modules/router/lib/route.js:132:14)
      at MatchingController.next [as joinMatching] (src/controllers/matching.controller.ts:29:7)
      at src/routes/matching.routes.ts:14:3
      at src/middleware/errorHandler.ts:58:9

  console.error
    Error: {
      message: 'Failed to create room',
      statusCode: 500,
      stack: 'Error: Failed to create room\n' +
        '    at Object.<anonymous> (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/tests/with-mocks/matching.mock.test.ts:290:41)\n' +
        '    at Promise.finally.completed (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:1557:28)\n' +
        '    at new Promise (<anonymous>)\n' +
        '    at callAsyncCircusFn (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:1497:10)\n' +
        '    at _callCircusTest (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:1007:40)\n' +
        '    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n' +
        '    at _runTest (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:947:3)\n' +
        '    at /Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:849:7\n' +
        '    at _runTestsForDescribeBlock (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:862:11)\n' +
        '    at _runTestsForDescribeBlock (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:857:11)\n' +
        '    at run (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:761:3)\n' +
        '    at runAndTransformResultsToJestFormat (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:1918:21)\n' +
        '    at jestAdapter (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/runner.js:101:19)\n' +
        '    at runTestInternal (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-runner/build/index.js:275:16)\n' +
        '    at runTest (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-runner/build/index.js:343:7)',
      timestamp: '2025-11-09T07:24:50.685Z',
      path: '/api/matching/join',
      method: 'POST'
    }

      90 |   }
      91 |
    > 92 |   console.error('Error:', {
         |           ^
      93 |     message: err.message,
      94 |     statusCode,
      95 |     stack: err.stack,

      at error (src/middleware/errorHandler.ts:92:11)
      at Layer.handleError (node_modules/router/lib/layer.js:116:17)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at Layer.handleError (node_modules/router/lib/layer.js:111:12)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at node_modules/router/index.js:688:15
      at next (node_modules/router/index.js:276:14)
      at next (node_modules/router/lib/route.js:132:14)
      at MatchingController.next [as joinMatching] (src/controllers/matching.controller.ts:29:7)
      at src/routes/matching.routes.ts:14:3
      at src/middleware/errorHandler.ts:58:9

  console.error
    Error: {
      message: 'Cast to ObjectId failed',
      statusCode: 400,
      stack: 'CastError: Cast to ObjectId failed\n' +
        '    at Object.<anonymous> (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/tests/with-mocks/matching.mock.test.ts:323:23)\n' +
        '    at Promise.finally.completed (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:1557:28)\n' +
        '    at new Promise (<anonymous>)\n' +
        '    at callAsyncCircusFn (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:1497:10)\n' +
        '    at _callCircusTest (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:1007:40)\n' +
        '    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n' +
        '    at _runTest (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:947:3)\n' +
        '    at /Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:849:7\n' +
        '    at _runTestsForDescribeBlock (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:862:11)\n' +
        '    at _runTestsForDescribeBlock (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:857:11)\n' +
        '    at run (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:761:3)\n' +
        '    at runAndTransformResultsToJestFormat (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:1918:21)\n' +
        '    at jestAdapter (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/runner.js:101:19)\n' +
        '    at runTestInternal (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-runner/build/index.js:275:16)\n' +
        '    at runTest (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-runner/build/index.js:343:7)',
      timestamp: '2025-11-09T07:24:50.688Z',
      path: '/api/matching/join',
      method: 'POST'
    }

      90 |   }
      91 |
    > 92 |   console.error('Error:', {
         |           ^
      93 |     message: err.message,
      94 |     statusCode,
      95 |     stack: err.stack,

      at error (src/middleware/errorHandler.ts:92:11)
      at Layer.handleError (node_modules/router/lib/layer.js:116:17)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at Layer.handleError (node_modules/router/lib/layer.js:111:12)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at node_modules/router/index.js:688:15
      at next (node_modules/router/index.js:276:14)
      at next (node_modules/router/lib/route.js:132:14)
      at MatchingController.next [as joinMatching] (src/controllers/matching.controller.ts:29:7)
      at src/routes/matching.routes.ts:14:3
      at src/middleware/errorHandler.ts:58:9

  console.error
    Error: {
      message: 'Validation failed: budget must be positive',
      statusCode: 400,
      stack: 'ValidationError: Validation failed: budget must be positive\n' +
        '    at Object.<anonymous> (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/tests/with-mocks/matching.mock.test.ts:361:29)\n' +
        '    at Promise.finally.completed (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:1557:28)\n' +
        '    at new Promise (<anonymous>)\n' +
        '    at callAsyncCircusFn (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:1497:10)\n' +
        '    at _callCircusTest (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:1007:40)\n' +
        '    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n' +
        '    at _runTest (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:947:3)\n' +
        '    at /Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:849:7\n' +
        '    at _runTestsForDescribeBlock (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:862:11)\n' +
        '    at _runTestsForDescribeBlock (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:857:11)\n' +
        '    at run (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:761:3)\n' +
        '    at runAndTransformResultsToJestFormat (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:1918:21)\n' +
        '    at jestAdapter (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/runner.js:101:19)\n' +
        '    at runTestInternal (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-runner/build/index.js:275:16)\n' +
        '    at runTest (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-runner/build/index.js:343:7)',
      timestamp: '2025-11-09T07:24:50.690Z',
      path: '/api/matching/join',
      method: 'POST'
    }

      90 |   }
      91 |
    > 92 |   console.error('Error:', {
         |           ^
      93 |     message: err.message,
      94 |     statusCode,
      95 |     stack: err.stack,

      at error (src/middleware/errorHandler.ts:92:11)
      at Layer.handleError (node_modules/router/lib/layer.js:116:17)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at Layer.handleError (node_modules/router/lib/layer.js:111:12)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at node_modules/router/index.js:688:15
      at next (node_modules/router/index.js:276:14)
      at next (node_modules/router/lib/route.js:132:14)
      at MatchingController.next [as joinMatching] (src/controllers/matching.controller.ts:29:7)
      at src/routes/matching.routes.ts:14:3
      at src/middleware/errorHandler.ts:58:9

  console.error
    Error: {
      message: 'User not found',
      statusCode: 500,
      stack: 'Error: User not found\n' +
        '    at MatchingService.leaveRoom (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/src/services/matchingService.ts:197:13)\n' +
        '    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n' +
        '    at MatchingController.leaveRoom (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/src/controllers/matching.controller.ts:68:7)\n' +
        '    at /Users/hashim/Desktop/Development/FeastFriends/321-project/backend/src/routes/matching.routes.ts:32:3\n' +
        '    at /Users/hashim/Desktop/Development/FeastFriends/321-project/backend/src/middleware/errorHandler.ts:58:9',
      timestamp: '2025-11-09T07:24:50.693Z',
      path: '/api/matching/leave/691041c20c7da2a93bae42c6',
      method: 'PUT'
    }

      90 |   }
      91 |
    > 92 |   console.error('Error:', {
         |           ^
      93 |     message: err.message,
      94 |     statusCode,
      95 |     stack: err.stack,

      at error (src/middleware/errorHandler.ts:92:11)
      at Layer.handleError (node_modules/router/lib/layer.js:116:17)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at Layer.handleError (node_modules/router/lib/layer.js:111:12)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at node_modules/router/index.js:688:15
      at next (node_modules/router/index.js:276:14)
      at next (node_modules/router/lib/route.js:132:14)
      at MatchingController.next [as leaveRoom] (src/controllers/matching.controller.ts:76:7)
      at src/routes/matching.routes.ts:32:3
      at src/middleware/errorHandler.ts:58:9

  console.error
    Error: {
      message: 'Database timeout',
      statusCode: 500,
      stack: 'Error: Database timeout\n' +
        '    at Object.<anonymous> (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/tests/with-mocks/matching.mock.test.ts:457:43)\n' +
        '    at Promise.finally.completed (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:1557:28)\n' +
        '    at new Promise (<anonymous>)\n' +
        '    at callAsyncCircusFn (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:1497:10)\n' +
        '    at _callCircusTest (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:1007:40)\n' +
        '    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n' +
        '    at _runTest (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:947:3)\n' +
        '    at /Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:849:7\n' +
        '    at _runTestsForDescribeBlock (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:862:11)\n' +
        '    at _runTestsForDescribeBlock (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:857:11)\n' +
        '    at run (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:761:3)\n' +
        '    at runAndTransformResultsToJestFormat (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:1918:21)\n' +
        '    at jestAdapter (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/runner.js:101:19)\n' +
        '    at runTestInternal (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-runner/build/index.js:275:16)\n' +
        '    at runTest (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-runner/build/index.js:343:7)',
      timestamp: '2025-11-09T07:24:50.695Z',
      path: '/api/matching/leave/room-123',
      method: 'PUT'
    }

      90 |   }
      91 |
    > 92 |   console.error('Error:', {
         |           ^
      93 |     message: err.message,
      94 |     statusCode,
      95 |     stack: err.stack,

      at error (src/middleware/errorHandler.ts:92:11)
      at Layer.handleError (node_modules/router/lib/layer.js:116:17)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at Layer.handleError (node_modules/router/lib/layer.js:111:12)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at node_modules/router/index.js:688:15
      at next (node_modules/router/index.js:276:14)
      at next (node_modules/router/lib/route.js:132:14)
      at MatchingController.next [as leaveRoom] (src/controllers/matching.controller.ts:76:7)
      at src/routes/matching.routes.ts:32:3
      at src/middleware/errorHandler.ts:58:9

  console.log
    Room non-existent-room not found - clearing user's roomID anyway

      at MatchingService.log [as leaveRoom] (src/services/matchingService.ts:204:15)

  console.log
    ‚úÖ Cleared stale roomID for user test-user-123

      at MatchingService.log [as leaveRoom] (src/services/matchingService.ts:211:17)

  console.error
    Error: {
      message: 'Failed to update room',
      statusCode: 500,
      stack: 'Error: Failed to update room\n' +
        '    at Object.<anonymous> (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/tests/with-mocks/matching.mock.test.ts:553:41)\n' +
        '    at Promise.finally.completed (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:1557:28)\n' +
        '    at new Promise (<anonymous>)\n' +
        '    at callAsyncCircusFn (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:1497:10)\n' +
        '    at _callCircusTest (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:1007:40)\n' +
        '    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n' +
        '    at _runTest (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:947:3)\n' +
        '    at /Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:849:7\n' +
        '    at _runTestsForDescribeBlock (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:862:11)\n' +
        '    at _runTestsForDescribeBlock (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:857:11)\n' +
        '    at run (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:761:3)\n' +
        '    at runAndTransformResultsToJestFormat (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:1918:21)\n' +
        '    at jestAdapter (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/runner.js:101:19)\n' +
        '    at runTestInternal (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-runner/build/index.js:275:16)\n' +
        '    at runTest (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-runner/build/index.js:343:7)',
      timestamp: '2025-11-09T07:24:50.699Z',
      path: '/api/matching/leave/room-123',
      method: 'PUT'
    }

      90 |   }
      91 |
    > 92 |   console.error('Error:', {
         |           ^
      93 |     message: err.message,
      94 |     statusCode,
      95 |     stack: err.stack,

      at error (src/middleware/errorHandler.ts:92:11)
      at Layer.handleError (node_modules/router/lib/layer.js:116:17)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at Layer.handleError (node_modules/router/lib/layer.js:111:12)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at node_modules/router/index.js:688:15
      at next (node_modules/router/index.js:276:14)
      at next (node_modules/router/lib/route.js:132:14)
      at MatchingController.next [as leaveRoom] (src/controllers/matching.controller.ts:76:7)
      at src/routes/matching.routes.ts:32:3
      at src/middleware/errorHandler.ts:58:9

  console.error
    Error: {
      message: 'Delete failed',
      statusCode: 500,
      stack: 'Error: Delete failed\n' +
        '    at Object.<anonymous> (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/tests/with-mocks/matching.mock.test.ts:610:52)\n' +
        '    at Promise.finally.completed (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:1557:28)\n' +
        '    at new Promise (<anonymous>)\n' +
        '    at callAsyncCircusFn (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:1497:10)\n' +
        '    at _callCircusTest (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:1007:40)\n' +
        '    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n' +
        '    at _runTest (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:947:3)\n' +
        '    at /Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:849:7\n' +
        '    at _runTestsForDescribeBlock (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:862:11)\n' +
        '    at _runTestsForDescribeBlock (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:857:11)\n' +
        '    at run (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:761:3)\n' +
        '    at runAndTransformResultsToJestFormat (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:1918:21)\n' +
        '    at jestAdapter (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/runner.js:101:19)\n' +
        '    at runTestInternal (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-runner/build/index.js:275:16)\n' +
        '    at runTest (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-runner/build/index.js:343:7)',
      timestamp: '2025-11-09T07:24:50.704Z',
      path: '/api/matching/leave/room-123',
      method: 'PUT'
    }

      90 |   }
      91 |
    > 92 |   console.error('Error:', {
         |           ^
      93 |     message: err.message,
      94 |     statusCode,
      95 |     stack: err.stack,

      at error (src/middleware/errorHandler.ts:92:11)
      at Layer.handleError (node_modules/router/lib/layer.js:116:17)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at Layer.handleError (node_modules/router/lib/layer.js:111:12)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at node_modules/router/index.js:688:15
      at next (node_modules/router/index.js:276:14)
      at next (node_modules/router/lib/route.js:132:14)
      at MatchingController.next [as leaveRoom] (src/controllers/matching.controller.ts:76:7)
      at src/routes/matching.routes.ts:32:3
      at src/middleware/errorHandler.ts:58:9

  console.error
    Error: {
      message: 'Room not found',
      statusCode: 500,
      stack: 'Error: Room not found\n' +
        '    at MatchingService.getRoomStatus (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/src/services/matchingService.ts:321:13)\n' +
        '    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n' +
        '    at MatchingController.getRoomStatus (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/src/controllers/matching.controller.ts:88:22)\n' +
        '    at /Users/hashim/Desktop/Development/FeastFriends/321-project/backend/src/routes/matching.routes.ts:41:3\n' +
        '    at /Users/hashim/Desktop/Development/FeastFriends/321-project/backend/src/middleware/errorHandler.ts:58:9',
      timestamp: '2025-11-09T07:24:50.706Z',
      path: '/api/matching/status/691041c20c7da2a93bae42c7',
      method: 'GET'
    }

      90 |   }
      91 |
    > 92 |   console.error('Error:', {
         |           ^
      93 |     message: err.message,
      94 |     statusCode,
      95 |     stack: err.stack,

      at error (src/middleware/errorHandler.ts:92:11)
      at Layer.handleError (node_modules/router/lib/layer.js:116:17)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at Layer.handleError (node_modules/router/lib/layer.js:111:12)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at node_modules/router/index.js:688:15
      at next (node_modules/router/index.js:276:14)
      at next (node_modules/router/lib/route.js:132:14)
      at MatchingController.next [as getRoomStatus] (src/controllers/matching.controller.ts:96:7)
      at src/routes/matching.routes.ts:41:3
      at src/middleware/errorHandler.ts:58:9

  console.error
    Error: {
      message: 'Connection refused',
      statusCode: 500,
      stack: 'Error: Connection refused\n' +
        '    at Object.<anonymous> (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/tests/with-mocks/matching.mock.test.ts:686:43)\n' +
        '    at Promise.finally.completed (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:1557:28)\n' +
        '    at new Promise (<anonymous>)\n' +
        '    at callAsyncCircusFn (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:1497:10)\n' +
        '    at _callCircusTest (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:1007:40)\n' +
        '    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n' +
        '    at _runTest (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:947:3)\n' +
        '    at /Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:849:7\n' +
        '    at _runTestsForDescribeBlock (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:862:11)\n' +
        '    at _runTestsForDescribeBlock (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:857:11)\n' +
        '    at run (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:761:3)\n' +
        '    at runAndTransformResultsToJestFormat (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:1918:21)\n' +
        '    at jestAdapter (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/runner.js:101:19)\n' +
        '    at runTestInternal (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-runner/build/index.js:275:16)\n' +
        '    at runTest (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-runner/build/index.js:343:7)',
      timestamp: '2025-11-09T07:24:50.708Z',
      path: '/api/matching/status/691041c20c7da2a93bae42c8',
      method: 'GET'
    }

      90 |   }
      91 |
    > 92 |   console.error('Error:', {
         |           ^
      93 |     message: err.message,
      94 |     statusCode,
      95 |     stack: err.stack,

      at error (src/middleware/errorHandler.ts:92:11)
      at Layer.handleError (node_modules/router/lib/layer.js:116:17)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at Layer.handleError (node_modules/router/lib/layer.js:111:12)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at node_modules/router/index.js:688:15
      at next (node_modules/router/index.js:276:14)
      at next (node_modules/router/lib/route.js:132:14)
      at MatchingController.next [as getRoomStatus] (src/controllers/matching.controller.ts:96:7)
      at src/routes/matching.routes.ts:41:3
      at src/middleware/errorHandler.ts:58:9

  console.error
    Error: {
      message: 'Cast to ObjectId failed',
      statusCode: 400,
      stack: 'CastError: Cast to ObjectId failed\n' +
        '    at Object.<anonymous> (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/tests/with-mocks/matching.mock.test.ts:718:23)\n' +
        '    at Promise.finally.completed (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:1557:28)\n' +
        '    at new Promise (<anonymous>)\n' +
        '    at callAsyncCircusFn (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:1497:10)\n' +
        '    at _callCircusTest (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:1007:40)\n' +
        '    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n' +
        '    at _runTest (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:947:3)\n' +
        '    at /Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:849:7\n' +
        '    at _runTestsForDescribeBlock (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:862:11)\n' +
        '    at _runTestsForDescribeBlock (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:857:11)\n' +
        '    at run (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:761:3)\n' +
        '    at runAndTransformResultsToJestFormat (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:1918:21)\n' +
        '    at jestAdapter (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/runner.js:101:19)\n' +
        '    at runTestInternal (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-runner/build/index.js:275:16)\n' +
        '    at runTest (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-runner/build/index.js:343:7)',
      timestamp: '2025-11-09T07:24:50.711Z',
      path: '/api/matching/status/invalid-id-format',
      method: 'GET'
    }

      90 |   }
      91 |
    > 92 |   console.error('Error:', {
         |           ^
      93 |     message: err.message,
      94 |     statusCode,
      95 |     stack: err.stack,

      at error (src/middleware/errorHandler.ts:92:11)
      at Layer.handleError (node_modules/router/lib/layer.js:116:17)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at Layer.handleError (node_modules/router/lib/layer.js:111:12)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at node_modules/router/index.js:688:15
      at next (node_modules/router/index.js:276:14)
      at next (node_modules/router/lib/route.js:132:14)
      at MatchingController.next [as getRoomStatus] (src/controllers/matching.controller.ts:96:7)
      at src/routes/matching.routes.ts:41:3
      at src/middleware/errorHandler.ts:58:9

  console.error
    Error: {
      message: 'Room not found',
      statusCode: 500,
      stack: 'Error: Room not found\n' +
        '    at MatchingService.getRoomUsers (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/src/services/matchingService.ts:339:13)\n' +
        '    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n' +
        '    at MatchingController.getRoomUsers (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/src/controllers/matching.controller.ts:108:21)\n' +
        '    at /Users/hashim/Desktop/Development/FeastFriends/321-project/backend/src/routes/matching.routes.ts:50:3\n' +
        '    at /Users/hashim/Desktop/Development/FeastFriends/321-project/backend/src/middleware/errorHandler.ts:58:9',
      timestamp: '2025-11-09T07:24:50.713Z',
      path: '/api/matching/users/691041c20c7da2a93bae42c9',
      method: 'GET'
    }

      90 |   }
      91 |
    > 92 |   console.error('Error:', {
         |           ^
      93 |     message: err.message,
      94 |     statusCode,
      95 |     stack: err.stack,

      at error (src/middleware/errorHandler.ts:92:11)
      at Layer.handleError (node_modules/router/lib/layer.js:116:17)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at Layer.handleError (node_modules/router/lib/layer.js:111:12)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at Immediate.next (node_modules/router/index.js:291:5)
      at Immediate._onImmediate (node_modules/router/index.js:688:15)

  console.error
    Error: {
      message: 'Network error',
      statusCode: 500,
      stack: 'Error: Network error\n' +
        '    at Object.<anonymous> (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/tests/with-mocks/matching.mock.test.ts:796:43)\n' +
        '    at Promise.finally.completed (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:1557:28)\n' +
        '    at new Promise (<anonymous>)\n' +
        '    at callAsyncCircusFn (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:1497:10)\n' +
        '    at _callCircusTest (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:1007:40)\n' +
        '    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n' +
        '    at _runTest (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:947:3)\n' +
        '    at /Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:849:7\n' +
        '    at _runTestsForDescribeBlock (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:862:11)\n' +
        '    at _runTestsForDescribeBlock (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:857:11)\n' +
        '    at run (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:761:3)\n' +
        '    at runAndTransformResultsToJestFormat (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:1918:21)\n' +
        '    at jestAdapter (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/runner.js:101:19)\n' +
        '    at runTestInternal (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-runner/build/index.js:275:16)\n' +
        '    at runTest (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-runner/build/index.js:343:7)',
      timestamp: '2025-11-09T07:24:50.716Z',
      path: '/api/matching/users/691041c20c7da2a93bae42ca',
      method: 'GET'
    }

      90 |   }
      91 |
    > 92 |   console.error('Error:', {
         |           ^
      93 |     message: err.message,
      94 |     statusCode,
      95 |     stack: err.stack,

      at error (src/middleware/errorHandler.ts:92:11)
      at Layer.handleError (node_modules/router/lib/layer.js:116:17)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at Layer.handleError (node_modules/router/lib/layer.js:111:12)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at Immediate.next (node_modules/router/index.js:291:5)
      at Immediate._onImmediate (node_modules/router/index.js:688:15)

  console.log
    Test suite completed.

      at Object.<anonymous> (tests/setup.ts:14:11)

PASS tests/with-mocks/matching.mock.test.ts
  POST /api/matching/join - With Mocking
    ‚úì should return 500 when user not found in database (16 ms)
    ‚úì should return 500 when database connection fails (7 ms)
    ‚úì should return 500 when user already in room (3 ms)
    ‚úì should return 500 when Room.find() fails (2 ms)
    ‚úì should return 500 when Room.create() fails (3 ms)
    ‚úì should return 400 when invalid ObjectId format (2 ms)
    ‚úì should return 400 when user.save() fails with ValidationError (2 ms)
  PUT /api/matching/leave/:roomId - With Mocking
    ‚úì should return 500 when user not found (2 ms)
    ‚úì should return 500 when Room.findById() fails (2 ms)
    ‚úì should handle gracefully when room not found (cleanup stale state) (2 ms)
    ‚úì should return 500 when room.save() fails (5 ms)
    ‚úì should return 500 when Room.findByIdAndDelete() fails (2 ms)
  GET /api/matching/status/:roomId - With Mocking
    ‚úì should return 500 when room not found (2 ms)
    ‚úì should return 500 when database query fails (3 ms)
    ‚úì should return 400 for invalid ObjectId format (2 ms)
  GET /api/matching/users/:roomId - With Mocking
    ‚úì should return 500 when room not found (3 ms)
    ‚úì should return 500 when database connection fails (2 ms)

  console.log
    [dotenv@17.2.3] injecting env (3) from .env.test -- tip: ‚öôÔ∏è  enable debug logging with { debug: true }

      at _log (node_modules/dotenv/lib/main.js:142:11)

  console.log
    Starting test suite...

      at Object.<anonymous> (tests/setup.ts:9:11)

  console.log
    
    üöÄ Starting User Tests (No Mocking)...

      at Object.<anonymous> (tests/no-mocks/user.test.ts:18:11)

  console.log
    MongoDB Atlas connected successfully

      at connectDatabase (src/config/database.ts:22:13)

  console.log
    
    ‚úÖ Test setup complete. Ready to run tests.

      at Object.<anonymous> (tests/no-mocks/user.test.ts:26:11)

  console.error
    Error: {
      message: 'Cast to ObjectId failed for value "invalid-id-format-123" (type string) at path "_id" for model "User"',
      statusCode: 400,
      stack: 'CastError: Cast to ObjectId failed for value "invalid-id-format-123" (type string) at path "_id" for model "User"\n' +
        '    at SchemaObjectId.cast (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/mongoose/lib/schema/objectId.js:251:11)\n' +
        '    at SchemaObjectId.SchemaType.applySetters (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/mongoose/lib/schemaType.js:1259:12)\n' +
        '    at SchemaObjectId.SchemaType.castForQuery (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/mongoose/lib/schemaType.js:1695:17)\n' +
        '    at /Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/mongoose/lib/schemaType.js:1650:18\n' +
        '    at Array.map (<anonymous>)\n' +
        '    at SchemaObjectId.handle$in (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/mongoose/lib/schemaType.js:1646:14)\n' +
        '    at SchemaObjectId.SchemaType.castForQuery (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/mongoose/lib/schemaType.js:1691:20)\n' +
        '    at cast (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/mongoose/lib/cast.js:367:39)\n' +
        '    at model.Query.Query.cast (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/mongoose/lib/query.js:5060:12)\n' +
        '    at model.Query.Query._castConditions (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/mongoose/lib/query.js:2374:10)\n' +
        '    at model.Query._find (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/mongoose/lib/query.js:2401:8)\n' +
        '    at model.Query.exec (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/mongoose/lib/query.js:4627:80)\n' +
        '    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n' +
        '    at UserService.getUserProfiles (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/src/services/userService.ts:40:19)\n' +
        '    at UserController.getUserProfiles (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/src/controllers/user.controller.ts:18:24)\n' +
        '    at /Users/hashim/Desktop/Development/FeastFriends/321-project/backend/src/routes/user.routes.ts:14:3\n' +
        '    at /Users/hashim/Desktop/Development/FeastFriends/321-project/backend/src/middleware/errorHandler.ts:58:9',
      timestamp: '2025-11-09T07:24:50.896Z',
      path: '/api/user/profile/invalid-id-format-123',
      method: 'GET'
    }

      90 |   }
      91 |
    > 92 |   console.error('Error:', {
         |           ^
      93 |     message: err.message,
      94 |     statusCode,
      95 |     stack: err.stack,

      at error (src/middleware/errorHandler.ts:92:11)
      at Layer.handleError (node_modules/router/lib/layer.js:116:17)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at Layer.handleError (node_modules/router/lib/layer.js:111:12)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at node_modules/router/index.js:688:15
      at next (node_modules/router/index.js:276:14)
      at next (node_modules/router/lib/route.js:132:14)
      at UserController.next [as getUserProfiles] (src/controllers/user.controller.ts:26:7)
      at src/routes/user.routes.ts:14:3
      at src/middleware/errorHandler.ts:58:9

  console.log
    [UserService] getUserSettings called for userId: 691041c2f88d8212d2e8b5af

      at UserService.log [as getUserSettings] (src/services/userService.ts:55:13)

  console.log
    [UserService] User found. profilePicture: "https://example.com/pic1.jpg"

      at UserService.log [as getUserSettings] (src/services/userService.ts:63:13)

  console.log
    [UserService] getUserSettings called for userId: 691041c2f88d8212d2e8b5c0

      at UserService.log [as getUserSettings] (src/services/userService.ts:55:13)

  console.error
    Error: {
      message: 'User not found',
      statusCode: 500,
      stack: 'Error: User not found\n' +
        '    at UserService.getUserSettings (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/src/services/userService.ts:60:13)\n' +
        '    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n' +
        '    at UserController.getUserSettings (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/src/controllers/user.controller.ts:38:24)\n' +
        '    at /Users/hashim/Desktop/Development/FeastFriends/321-project/backend/src/routes/user.routes.ts:23:3\n' +
        '    at /Users/hashim/Desktop/Development/FeastFriends/321-project/backend/src/middleware/errorHandler.ts:58:9',
      timestamp: '2025-11-09T07:24:50.916Z',
      path: '/api/user/settings',
      method: 'GET'
    }

      90 |   }
      91 |
    > 92 |   console.error('Error:', {
         |           ^
      93 |     message: err.message,
      94 |     statusCode,
      95 |     stack: err.stack,

      at error (src/middleware/errorHandler.ts:92:11)
      at Layer.handleError (node_modules/router/lib/layer.js:116:17)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at Layer.handleError (node_modules/router/lib/layer.js:111:12)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at node_modules/router/index.js:688:15
      at next (node_modules/router/index.js:276:14)
      at next (node_modules/router/lib/route.js:132:14)
      at UserController.next [as getUserSettings] (src/controllers/user.controller.ts:46:7)
      at src/routes/user.routes.ts:23:3
      at src/middleware/errorHandler.ts:58:9

  console.log
    [UserService] updateUserSettings called for userId: 691041c2f88d8212d2e8b5b0

      at UserService.log [as updateUserSettings] (src/services/userService.ts:130:13)

  console.log
    [UserService] Data received: {
      name: 'Settings Updated Name',
      bio: 'Settings updated bio',
      preference: [ 'vegetarian', 'italian', 'mexican' ],
      profilePicture: undefined,
      contactNumber: undefined,
      budget: 100,
      radiusKm: 25
    }

      at UserService.log [as updateUserSettings] (src/services/userService.ts:131:13)

  console.log
    [UserService] User saved. Current profilePicture: "https://example.com/pic2.jpg"

      at UserService.log [as updateUserSettings] (src/services/userService.ts:154:13)

  console.log
    [UserService] getUserSettings called for userId: 691041c2f88d8212d2e8b5b0

      at UserService.log [as getUserSettings] (src/services/userService.ts:55:13)

  console.log
    [UserService] User found. profilePicture: "https://example.com/pic2.jpg"

      at UserService.log [as getUserSettings] (src/services/userService.ts:63:13)

  console.log
    [UserService] updateUserSettings called for userId: 691041c2f88d8212d2e8b5b0

      at UserService.log [as updateUserSettings] (src/services/userService.ts:130:13)

  console.log
    [UserService] Data received: {
      name: undefined,
      bio: undefined,
      preference: undefined,
      profilePicture: undefined,
      contactNumber: undefined,
      budget: 150,
      radiusKm: 30
    }

      at UserService.log [as updateUserSettings] (src/services/userService.ts:131:13)

  console.log
    [UserService] User saved. Current profilePicture: "https://example.com/pic2.jpg"

      at UserService.log [as updateUserSettings] (src/services/userService.ts:154:13)

  console.log
    [UserService] getUserSettings called for userId: 691041c2f88d8212d2e8b5b0

      at UserService.log [as getUserSettings] (src/services/userService.ts:55:13)

  console.log
    [UserService] User found. profilePicture: "https://example.com/pic2.jpg"

      at UserService.log [as getUserSettings] (src/services/userService.ts:63:13)

  console.error
    Error: {
      message: 'Cannot delete account while in a room or group',
      statusCode: 500,
      stack: 'Error: Cannot delete account while in a room or group\n' +
        '    at UserService.deleteUser (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/src/services/userService.ts:214:13)\n' +
        '    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n' +
        '    at UserController.deleteUser (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/src/controllers/user.controller.ts:156:22)\n' +
        '    at /Users/hashim/Desktop/Development/FeastFriends/321-project/backend/src/routes/user.routes.ts:59:3\n' +
        '    at /Users/hashim/Desktop/Development/FeastFriends/321-project/backend/src/middleware/errorHandler.ts:58:9',
      timestamp: '2025-11-09T07:24:50.979Z',
      path: '/api/user/691041c2f88d8212d2e8b5b1',
      method: 'DELETE'
    }

      90 |   }
      91 |
    > 92 |   console.error('Error:', {
         |           ^
      93 |     message: err.message,
      94 |     statusCode,
      95 |     stack: err.stack,

      at error (src/middleware/errorHandler.ts:92:11)
      at Layer.handleError (node_modules/router/lib/layer.js:116:17)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at Layer.handleError (node_modules/router/lib/layer.js:111:12)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at Immediate.next (node_modules/router/index.js:291:5)
      at Immediate._onImmediate (node_modules/router/index.js:688:15)

  console.error
    Error: {
      message: 'Cannot delete account while in a room or group',
      statusCode: 500,
      stack: 'Error: Cannot delete account while in a room or group\n' +
        '    at UserService.deleteUser (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/src/services/userService.ts:214:13)\n' +
        '    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n' +
        '    at UserController.deleteUser (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/src/controllers/user.controller.ts:156:22)\n' +
        '    at /Users/hashim/Desktop/Development/FeastFriends/321-project/backend/src/routes/user.routes.ts:59:3\n' +
        '    at /Users/hashim/Desktop/Development/FeastFriends/321-project/backend/src/middleware/errorHandler.ts:58:9',
      timestamp: '2025-11-09T07:24:50.983Z',
      path: '/api/user/691041c2f88d8212d2e8b5b2',
      method: 'DELETE'
    }

      90 |   }
      91 |
    > 92 |   console.error('Error:', {
         |           ^
      93 |     message: err.message,
      94 |     statusCode,
      95 |     stack: err.stack,

      at error (src/middleware/errorHandler.ts:92:11)
      at Layer.handleError (node_modules/router/lib/layer.js:116:17)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at Layer.handleError (node_modules/router/lib/layer.js:111:12)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at Immediate.next (node_modules/router/index.js:291:5)
      at Immediate._onImmediate (node_modules/router/index.js:688:15)

  console.error
    Error: {
      message: 'User not found',
      statusCode: 500,
      stack: 'Error: User not found\n' +
        '    at UserService.deleteUser (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/src/services/userService.ts:210:13)\n' +
        '    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n' +
        '    at UserController.deleteUser (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/src/controllers/user.controller.ts:156:22)\n' +
        '    at /Users/hashim/Desktop/Development/FeastFriends/321-project/backend/src/routes/user.routes.ts:59:3\n' +
        '    at /Users/hashim/Desktop/Development/FeastFriends/321-project/backend/src/middleware/errorHandler.ts:58:9',
      timestamp: '2025-11-09T07:24:50.995Z',
      path: '/api/user/691041c2f88d8212d2e8b5dc',
      method: 'DELETE'
    }

      90 |   }
      91 |
    > 92 |   console.error('Error:', {
         |           ^
      93 |     message: err.message,
      94 |     statusCode,
      95 |     stack: err.stack,

      at error (src/middleware/errorHandler.ts:92:11)
      at Layer.handleError (node_modules/router/lib/layer.js:116:17)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at Layer.handleError (node_modules/router/lib/layer.js:111:12)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at Immediate.next (node_modules/router/index.js:291:5)
      at Immediate._onImmediate (node_modules/router/index.js:688:15)

  console.log
    Test suite completed.

      at Object.<anonymous> (tests/setup.ts:14:11)

  console.log
    
    üßπ Cleaning up after tests...

      at Object.<anonymous> (tests/no-mocks/user.test.ts:30:11)

  console.warn
    MongoDB disconnected. Attempting to reconnect...

      28 |
      29 |     mongoose.connection.on('disconnected', () => {
    > 30 |       console.warn('MongoDB disconnected. Attempting to reconnect...');
         |               ^
      31 |     });
      32 |
      33 |     mongoose.connection.on('reconnected', () => {

      at NativeConnection.<anonymous> (src/config/database.ts:30:15)
      at NativeConnection.set (node_modules/mongoose/lib/connection.js:145:12)
      at NativeConnection.onClose (node_modules/mongoose/lib/connection.js:1315:19)
      at NativeConnection._close (node_modules/mongoose/lib/connection.js:1264:12)
      at disconnectDatabase (src/config/database.ts:55:5)
      at Object.<anonymous> (tests/no-mocks/user.test.ts:36:3)

  console.log
    MongoDB disconnected successfully

      at disconnectDatabase (src/config/database.ts:56:13)

  console.log
    ‚úÖ Cleanup complete.

      at Object.<anonymous> (tests/no-mocks/user.test.ts:38:11)

PASS tests/no-mocks/user.test.ts
  GET /api/user/profile/:ids - No Mocking
    ‚úì should return 200 and user profiles for valid IDs (5 ms)
    ‚úì should return 200 with empty array for non-existent IDs (2 ms)
    ‚úì should handle single and multiple IDs correctly (5 ms)
    ‚úì should return 400 for invalid MongoDB ObjectId format (11 ms)
  GET /api/user/settings - No Mocking
    ‚úì should return 200 and user settings with valid authentication (7 ms)
    ‚úì should return 401 without authentication token (1 ms)
    ‚úì should return 401 with invalid token (1 ms)
    ‚úì should return 401 with expired token (1 ms)
    ‚úì should return 500 when user not found in database (8 ms)
  POST /api/user/profile - No Mocking
    ‚úì should create/update profile with valid data (12 ms)
    ‚úì should handle partial updates and empty body (7 ms)
  POST /api/user/settings - No Mocking
    ‚úì should update settings with full and partial data (19 ms)
  PUT /api/user/profile - No Mocking
    ‚úì should update profile with full and partial data (7 ms)
    ‚úì should handle non-Google profile picture URL (covers convertGoogleProfilePictureToBase64 early return) (7 ms)
  DELETE /api/user/:userId - No Mocking
    ‚úì should return 403 when trying to delete different user (3 ms)
    ‚úì should return 500 when user is in a waiting room (6 ms)
    ‚úì should return 500 when user is in a group (4 ms)
    ‚úì should successfully delete user not in room or group (9 ms)
    ‚úì should return 500 when trying to delete non-existent user (3 ms)
  User Model Methods - Integration Tests
    ‚úì should access userId virtual property directly on document (5 ms)
    ‚úì should access userId virtual property through API response (3 ms)
    ‚úì should use toJSON transform to include userId (9 ms)
    ‚úì should call toJSON transform directly on User document (2 ms)
    ‚úì should trigger pre-save hook when roomId is set (5 ms)
    ‚úì should trigger pre-save hook when groupId is set (5 ms)
    ‚úì should trigger pre-save hook when roomId is removed (5 ms)
    ‚úì should trigger pre-save hook when groupId is removed (9 ms)

  console.log
    [dotenv@17.2.3] injecting env (3) from .env.test -- tip: üîê encrypt with Dotenvx: https://dotenvx.com

      at _log (node_modules/dotenv/lib/main.js:142:11)

  console.log
    Starting test suite...

      at Object.<anonymous> (tests/setup.ts:9:11)

  console.log
    
    üöÄ Starting Auth Tests (With Mocks - Uncontrollable Failures)...

      at Object.<anonymous> (tests/with-mocks/auth.mock.test.ts:31:11)

  console.log
    MongoDB Atlas connected successfully

      at connectDatabase (src/config/database.ts:22:13)

  console.log
    ‚úÖ Test setup complete.

      at Object.<anonymous> (tests/with-mocks/auth.mock.test.ts:34:11)

  console.error
    Error: {
      message: 'MongoNetworkError: connection lost',
      statusCode: 500,
      stack: 'Error: MongoNetworkError: connection lost\n' +
        '    at Object.<anonymous> (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/tests/with-mocks/auth.mock.test.ts:51:7)\n' +
        '    at Promise.finally.completed (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:1557:28)\n' +
        '    at new Promise (<anonymous>)\n' +
        '    at callAsyncCircusFn (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:1497:10)\n' +
        '    at _callCircusTest (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:1007:40)\n' +
        '    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n' +
        '    at _runTest (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:947:3)\n' +
        '    at /Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:849:7\n' +
        '    at _runTestsForDescribeBlock (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:862:11)\n' +
        '    at _runTestsForDescribeBlock (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:857:11)\n' +
        '    at run (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:761:3)\n' +
        '    at runAndTransformResultsToJestFormat (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:1918:21)\n' +
        '    at jestAdapter (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/runner.js:101:19)\n' +
        '    at runTestInternal (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-runner/build/index.js:275:16)\n' +
        '    at runTest (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-runner/build/index.js:343:7)',
      timestamp: '2025-11-09T07:24:51.223Z',
      path: '/api/auth/logout',
      method: 'POST'
    }

      90 |   }
      91 |
    > 92 |   console.error('Error:', {
         |           ^
      93 |     message: err.message,
      94 |     statusCode,
      95 |     stack: err.stack,

      at error (src/middleware/errorHandler.ts:92:11)
      at Layer.handleError (node_modules/router/lib/layer.js:116:17)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at Layer.handleError (node_modules/router/lib/layer.js:111:12)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at node_modules/router/index.js:688:15
      at next (node_modules/router/index.js:276:14)
      at next (node_modules/router/lib/route.js:132:14)
      at AuthController.next [as logout] (src/controllers/auth.controller.ts:274:7)

  console.error
    Error: {
      message: 'MongoServerError: write failed',
      statusCode: 500,
      stack: 'Error: MongoServerError: write failed\n' +
        '    at Object.<anonymous> (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/tests/with-mocks/auth.mock.test.ts:72:41)\n' +
        '    at Promise.finally.completed (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:1557:28)\n' +
        '    at new Promise (<anonymous>)\n' +
        '    at callAsyncCircusFn (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:1497:10)\n' +
        '    at _callCircusTest (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:1007:40)\n' +
        '    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n' +
        '    at _runTest (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:947:3)\n' +
        '    at /Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:849:7\n' +
        '    at _runTestsForDescribeBlock (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:862:11)\n' +
        '    at _runTestsForDescribeBlock (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:857:11)\n' +
        '    at run (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:761:3)\n' +
        '    at runAndTransformResultsToJestFormat (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:1918:21)\n' +
        '    at jestAdapter (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/runner.js:101:19)\n' +
        '    at runTestInternal (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-runner/build/index.js:275:16)\n' +
        '    at runTest (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-runner/build/index.js:343:7)',
      timestamp: '2025-11-09T07:24:51.226Z',
      path: '/api/auth/logout',
      method: 'POST'
    }

      90 |   }
      91 |
    > 92 |   console.error('Error:', {
         |           ^
      93 |     message: err.message,
      94 |     statusCode,
      95 |     stack: err.stack,

      at error (src/middleware/errorHandler.ts:92:11)
      at Layer.handleError (node_modules/router/lib/layer.js:116:17)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at Layer.handleError (node_modules/router/lib/layer.js:111:12)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at node_modules/router/index.js:688:15
      at next (node_modules/router/index.js:276:14)
      at next (node_modules/router/lib/route.js:132:14)
      at AuthController.next [as logout] (src/controllers/auth.controller.ts:274:7)

  console.error
    Error: {
      message: 'MongoServerError: operation exceeded time limit',
      statusCode: 500,
      stack: 'Error: MongoServerError: operation exceeded time limit\n' +
        '    at Object.<anonymous> (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/tests/with-mocks/auth.mock.test.ts:93:7)\n' +
        '    at Promise.finally.completed (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:1557:28)\n' +
        '    at new Promise (<anonymous>)\n' +
        '    at callAsyncCircusFn (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:1497:10)\n' +
        '    at _callCircusTest (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:1007:40)\n' +
        '    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n' +
        '    at _runTest (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:947:3)\n' +
        '    at /Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:849:7\n' +
        '    at _runTestsForDescribeBlock (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:862:11)\n' +
        '    at _runTestsForDescribeBlock (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:857:11)\n' +
        '    at run (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:761:3)\n' +
        '    at runAndTransformResultsToJestFormat (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:1918:21)\n' +
        '    at jestAdapter (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/runner.js:101:19)\n' +
        '    at runTestInternal (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-runner/build/index.js:275:16)\n' +
        '    at runTest (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-runner/build/index.js:343:7)',
      timestamp: '2025-11-09T07:24:51.229Z',
      path: '/api/auth/logout',
      method: 'POST'
    }

      90 |   }
      91 |
    > 92 |   console.error('Error:', {
         |           ^
      93 |     message: err.message,
      94 |     statusCode,
      95 |     stack: err.stack,

      at error (src/middleware/errorHandler.ts:92:11)
      at Layer.handleError (node_modules/router/lib/layer.js:116:17)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at Layer.handleError (node_modules/router/lib/layer.js:111:12)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at node_modules/router/index.js:688:15
      at next (node_modules/router/index.js:276:14)
      at next (node_modules/router/lib/route.js:132:14)
      at AuthController.next [as logout] (src/controllers/auth.controller.ts:274:7)

  console.error
    Error: {
      message: 'MongoNetworkError: network partition detected',
      statusCode: 500,
      stack: 'Error: MongoNetworkError: network partition detected\n' +
        '    at Object.<anonymous> (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/tests/with-mocks/auth.mock.test.ts:112:7)\n' +
        '    at Promise.finally.completed (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:1557:28)\n' +
        '    at new Promise (<anonymous>)\n' +
        '    at callAsyncCircusFn (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:1497:10)\n' +
        '    at _callCircusTest (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:1007:40)\n' +
        '    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n' +
        '    at _runTest (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:947:3)\n' +
        '    at /Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:849:7\n' +
        '    at _runTestsForDescribeBlock (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:862:11)\n' +
        '    at _runTestsForDescribeBlock (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:857:11)\n' +
        '    at run (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:761:3)\n' +
        '    at runAndTransformResultsToJestFormat (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:1918:21)\n' +
        '    at jestAdapter (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/runner.js:101:19)\n' +
        '    at runTestInternal (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-runner/build/index.js:275:16)\n' +
        '    at runTest (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-runner/build/index.js:343:7)',
      timestamp: '2025-11-09T07:24:51.231Z',
      path: '/api/auth/logout',
      method: 'POST'
    }

      90 |   }
      91 |
    > 92 |   console.error('Error:', {
         |           ^
      93 |     message: err.message,
      94 |     statusCode,
      95 |     stack: err.stack,

      at error (src/middleware/errorHandler.ts:92:11)
      at Layer.handleError (node_modules/router/lib/layer.js:116:17)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at Layer.handleError (node_modules/router/lib/layer.js:111:12)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at node_modules/router/index.js:688:15
      at next (node_modules/router/index.js:276:14)
      at next (node_modules/router/lib/route.js:132:14)
      at AuthController.next [as logout] (src/controllers/auth.controller.ts:274:7)

  console.error
    Error: {
      message: 'MongoNetworkError: connection refused',
      statusCode: 500,
      stack: 'Error: MongoNetworkError: connection refused\n' +
        '    at Object.<anonymous> (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/tests/with-mocks/auth.mock.test.ts:133:7)\n' +
        '    at Promise.finally.completed (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:1557:28)\n' +
        '    at new Promise (<anonymous>)\n' +
        '    at callAsyncCircusFn (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:1497:10)\n' +
        '    at _callCircusTest (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:1007:40)\n' +
        '    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n' +
        '    at _runTest (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:947:3)\n' +
        '    at /Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:849:7\n' +
        '    at _runTestsForDescribeBlock (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:862:11)\n' +
        '    at _runTestsForDescribeBlock (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:857:11)\n' +
        '    at run (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:761:3)\n' +
        '    at runAndTransformResultsToJestFormat (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:1918:21)\n' +
        '    at jestAdapter (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/runner.js:101:19)\n' +
        '    at runTestInternal (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-runner/build/index.js:275:16)\n' +
        '    at runTest (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-runner/build/index.js:343:7)',
      timestamp: '2025-11-09T07:24:51.234Z',
      path: '/api/auth/verify',
      method: 'GET'
    }

      90 |   }
      91 |
    > 92 |   console.error('Error:', {
         |           ^
      93 |     message: err.message,
      94 |     statusCode,
      95 |     stack: err.stack,

      at error (src/middleware/errorHandler.ts:92:11)
      at Layer.handleError (node_modules/router/lib/layer.js:116:17)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at Layer.handleError (node_modules/router/lib/layer.js:111:12)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at Immediate.next (node_modules/router/index.js:291:5)
      at Immediate._onImmediate (node_modules/router/index.js:688:15)

  console.error
    Error: {
      message: 'MongoServerSelectionError: server selection timed out',
      statusCode: 500,
      stack: 'Error: MongoServerSelectionError: server selection timed out\n' +
        '    at Object.<anonymous> (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/tests/with-mocks/auth.mock.test.ts:152:7)\n' +
        '    at Promise.finally.completed (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:1557:28)\n' +
        '    at new Promise (<anonymous>)\n' +
        '    at callAsyncCircusFn (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:1497:10)\n' +
        '    at _callCircusTest (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:1007:40)\n' +
        '    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n' +
        '    at _runTest (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:947:3)\n' +
        '    at /Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:849:7\n' +
        '    at _runTestsForDescribeBlock (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:862:11)\n' +
        '    at _runTestsForDescribeBlock (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:857:11)\n' +
        '    at run (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:761:3)\n' +
        '    at runAndTransformResultsToJestFormat (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:1918:21)\n' +
        '    at jestAdapter (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/runner.js:101:19)\n' +
        '    at runTestInternal (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-runner/build/index.js:275:16)\n' +
        '    at runTest (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-runner/build/index.js:343:7)',
      timestamp: '2025-11-09T07:24:51.237Z',
      path: '/api/auth/verify',
      method: 'GET'
    }

      90 |   }
      91 |
    > 92 |   console.error('Error:', {
         |           ^
      93 |     message: err.message,
      94 |     statusCode,
      95 |     stack: err.stack,

      at error (src/middleware/errorHandler.ts:92:11)
      at Layer.handleError (node_modules/router/lib/layer.js:116:17)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at Layer.handleError (node_modules/router/lib/layer.js:111:12)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at Immediate.next (node_modules/router/index.js:291:5)
      at Immediate._onImmediate (node_modules/router/index.js:688:15)

  console.error
    Error: {
      message: 'MongoServerError: replica set not available',
      statusCode: 500,
      stack: 'Error: MongoServerError: replica set not available\n' +
        '    at Object.<anonymous> (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/tests/with-mocks/auth.mock.test.ts:171:7)\n' +
        '    at Promise.finally.completed (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:1557:28)\n' +
        '    at new Promise (<anonymous>)\n' +
        '    at callAsyncCircusFn (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:1497:10)\n' +
        '    at _callCircusTest (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:1007:40)\n' +
        '    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n' +
        '    at _runTest (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:947:3)\n' +
        '    at /Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:849:7\n' +
        '    at _runTestsForDescribeBlock (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:862:11)\n' +
        '    at _runTestsForDescribeBlock (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:857:11)\n' +
        '    at run (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:761:3)\n' +
        '    at runAndTransformResultsToJestFormat (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:1918:21)\n' +
        '    at jestAdapter (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/runner.js:101:19)\n' +
        '    at runTestInternal (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-runner/build/index.js:275:16)\n' +
        '    at runTest (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-runner/build/index.js:343:7)',
      timestamp: '2025-11-09T07:24:51.239Z',
      path: '/api/auth/verify',
      method: 'GET'
    }

      90 |   }
      91 |
    > 92 |   console.error('Error:', {
         |           ^
      93 |     message: err.message,
      94 |     statusCode,
      95 |     stack: err.stack,

      at error (src/middleware/errorHandler.ts:92:11)
      at Layer.handleError (node_modules/router/lib/layer.js:116:17)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at Layer.handleError (node_modules/router/lib/layer.js:111:12)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at Immediate.next (node_modules/router/index.js:291:5)
      at Immediate._onImmediate (node_modules/router/index.js:688:15)

  console.error
    Error: {
      message: 'MongoNetworkError: socket closed',
      statusCode: 500,
      stack: 'Error: MongoNetworkError: socket closed\n' +
        '    at Object.<anonymous> (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/tests/with-mocks/auth.mock.test.ts:192:7)\n' +
        '    at Promise.finally.completed (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:1557:28)\n' +
        '    at new Promise (<anonymous>)\n' +
        '    at callAsyncCircusFn (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:1497:10)\n' +
        '    at _callCircusTest (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:1007:40)\n' +
        '    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n' +
        '    at _runTest (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:947:3)\n' +
        '    at /Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:849:7\n' +
        '    at _runTestsForDescribeBlock (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:862:11)\n' +
        '    at _runTestsForDescribeBlock (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:857:11)\n' +
        '    at run (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:761:3)\n' +
        '    at runAndTransformResultsToJestFormat (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:1918:21)\n' +
        '    at jestAdapter (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/runner.js:101:19)\n' +
        '    at runTestInternal (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-runner/build/index.js:275:16)\n' +
        '    at runTest (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-runner/build/index.js:343:7)',
      timestamp: '2025-11-09T07:24:51.243Z',
      path: '/api/auth/fcm-token',
      method: 'POST'
    }

      90 |   }
      91 |
    > 92 |   console.error('Error:', {
         |           ^
      93 |     message: err.message,
      94 |     statusCode,
      95 |     stack: err.stack,

      at error (src/middleware/errorHandler.ts:92:11)
      at Layer.handleError (node_modules/router/lib/layer.js:116:17)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at Layer.handleError (node_modules/router/lib/layer.js:111:12)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at node_modules/router/index.js:688:15
      at next (node_modules/router/index.js:276:14)
      at next (node_modules/router/lib/route.js:132:14)
      at AuthController.next [as updateFCMToken] (src/controllers/auth.controller.ts:358:7)

  console.error
    Error: {
      message: 'MongoServerError: disk full',
      statusCode: 500,
      stack: 'Error: MongoServerError: disk full\n' +
        '    at Object.<anonymous> (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/tests/with-mocks/auth.mock.test.ts:214:41)\n' +
        '    at Promise.finally.completed (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:1557:28)\n' +
        '    at new Promise (<anonymous>)\n' +
        '    at callAsyncCircusFn (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:1497:10)\n' +
        '    at _callCircusTest (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:1007:40)\n' +
        '    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n' +
        '    at _runTest (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:947:3)\n' +
        '    at /Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:849:7\n' +
        '    at _runTestsForDescribeBlock (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:862:11)\n' +
        '    at _runTestsForDescribeBlock (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:857:11)\n' +
        '    at run (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:761:3)\n' +
        '    at runAndTransformResultsToJestFormat (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:1918:21)\n' +
        '    at jestAdapter (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/runner.js:101:19)\n' +
        '    at runTestInternal (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-runner/build/index.js:275:16)\n' +
        '    at runTest (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-runner/build/index.js:343:7)',
      timestamp: '2025-11-09T07:24:51.246Z',
      path: '/api/auth/fcm-token',
      method: 'POST'
    }

      90 |   }
      91 |
    > 92 |   console.error('Error:', {
         |           ^
      93 |     message: err.message,
      94 |     statusCode,
      95 |     stack: err.stack,

      at error (src/middleware/errorHandler.ts:92:11)
      at Layer.handleError (node_modules/router/lib/layer.js:116:17)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at Layer.handleError (node_modules/router/lib/layer.js:111:12)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at node_modules/router/index.js:688:15
      at next (node_modules/router/index.js:276:14)
      at next (node_modules/router/lib/route.js:132:14)
      at AuthController.next [as updateFCMToken] (src/controllers/auth.controller.ts:358:7)

  console.error
    Error: {
      message: 'MongoNetworkError: network partition detected',
      statusCode: 500,
      stack: 'Error: MongoNetworkError: network partition detected\n' +
        '    at Object.<anonymous> (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/tests/with-mocks/auth.mock.test.ts:236:7)\n' +
        '    at Promise.finally.completed (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:1557:28)\n' +
        '    at new Promise (<anonymous>)\n' +
        '    at callAsyncCircusFn (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:1497:10)\n' +
        '    at _callCircusTest (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:1007:40)\n' +
        '    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n' +
        '    at _runTest (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:947:3)\n' +
        '    at /Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:849:7\n' +
        '    at _runTestsForDescribeBlock (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:862:11)\n' +
        '    at _runTestsForDescribeBlock (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:857:11)\n' +
        '    at run (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:761:3)\n' +
        '    at runAndTransformResultsToJestFormat (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:1918:21)\n' +
        '    at jestAdapter (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/runner.js:101:19)\n' +
        '    at runTestInternal (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-runner/build/index.js:275:16)\n' +
        '    at runTest (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-runner/build/index.js:343:7)',
      timestamp: '2025-11-09T07:24:51.250Z',
      path: '/api/auth/fcm-token',
      method: 'POST'
    }

      90 |   }
      91 |
    > 92 |   console.error('Error:', {
         |           ^
      93 |     message: err.message,
      94 |     statusCode,
      95 |     stack: err.stack,

      at error (src/middleware/errorHandler.ts:92:11)
      at Layer.handleError (node_modules/router/lib/layer.js:116:17)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at Layer.handleError (node_modules/router/lib/layer.js:111:12)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at node_modules/router/index.js:688:15
      at next (node_modules/router/index.js:276:14)
      at next (node_modules/router/lib/route.js:132:14)
      at AuthController.next [as updateFCMToken] (src/controllers/auth.controller.ts:358:7)

  console.error
    Error: {
      message: 'MongoServerError: cursor timeout',
      statusCode: 500,
      stack: 'Error: MongoServerError: cursor timeout\n' +
        '    at Object.<anonymous> (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/tests/with-mocks/auth.mock.test.ts:256:7)\n' +
        '    at Promise.finally.completed (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:1557:28)\n' +
        '    at new Promise (<anonymous>)\n' +
        '    at callAsyncCircusFn (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:1497:10)\n' +
        '    at _callCircusTest (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:1007:40)\n' +
        '    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n' +
        '    at _runTest (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:947:3)\n' +
        '    at /Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:849:7\n' +
        '    at _runTestsForDescribeBlock (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:862:11)\n' +
        '    at _runTestsForDescribeBlock (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:857:11)\n' +
        '    at run (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:761:3)\n' +
        '    at runAndTransformResultsToJestFormat (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:1918:21)\n' +
        '    at jestAdapter (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/runner.js:101:19)\n' +
        '    at runTestInternal (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-runner/build/index.js:275:16)\n' +
        '    at runTest (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-runner/build/index.js:343:7)',
      timestamp: '2025-11-09T07:24:51.253Z',
      path: '/api/auth/fcm-token',
      method: 'POST'
    }

      90 |   }
      91 |
    > 92 |   console.error('Error:', {
         |           ^
      93 |     message: err.message,
      94 |     statusCode,
      95 |     stack: err.stack,

      at error (src/middleware/errorHandler.ts:92:11)
      at Layer.handleError (node_modules/router/lib/layer.js:116:17)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at Layer.handleError (node_modules/router/lib/layer.js:111:12)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at node_modules/router/index.js:688:15
      at next (node_modules/router/index.js:276:14)
      at next (node_modules/router/lib/route.js:132:14)
      at AuthController.next [as updateFCMToken] (src/controllers/auth.controller.ts:358:7)

  console.error
    Error: {
      message: 'MongoNetworkError: no connection available',
      statusCode: 500,
      stack: 'Error: MongoNetworkError: no connection available\n' +
        '    at Object.<anonymous> (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/tests/with-mocks/auth.mock.test.ts:278:7)\n' +
        '    at Promise.finally.completed (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:1557:28)\n' +
        '    at new Promise (<anonymous>)\n' +
        '    at callAsyncCircusFn (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:1497:10)\n' +
        '    at _callCircusTest (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:1007:40)\n' +
        '    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n' +
        '    at _runTest (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:947:3)\n' +
        '    at /Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:849:7\n' +
        '    at _runTestsForDescribeBlock (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:862:11)\n' +
        '    at _runTestsForDescribeBlock (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:857:11)\n' +
        '    at run (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:761:3)\n' +
        '    at runAndTransformResultsToJestFormat (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:1918:21)\n' +
        '    at jestAdapter (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/runner.js:101:19)\n' +
        '    at runTestInternal (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-runner/build/index.js:275:16)\n' +
        '    at runTest (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-runner/build/index.js:343:7)',
      timestamp: '2025-11-09T07:24:51.255Z',
      path: '/api/auth/account',
      method: 'DELETE'
    }

      90 |   }
      91 |
    > 92 |   console.error('Error:', {
         |           ^
      93 |     message: err.message,
      94 |     statusCode,
      95 |     stack: err.stack,

      at error (src/middleware/errorHandler.ts:92:11)
      at Layer.handleError (node_modules/router/lib/layer.js:116:17)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at Layer.handleError (node_modules/router/lib/layer.js:111:12)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at node_modules/router/index.js:688:15
      at next (node_modules/router/index.js:276:14)
      at next (node_modules/router/lib/route.js:132:14)
      at AuthController.next [as deleteAccount] (src/controllers/auth.controller.ts:400:7)

  console.error
    Error: {
      message: 'MongoServerError: delete operation failed',
      statusCode: 500,
      stack: 'Error: MongoServerError: delete operation failed\n' +
        '    at Object.<anonymous> (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/tests/with-mocks/auth.mock.test.ts:304:7)\n' +
        '    at Promise.finally.completed (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:1557:28)\n' +
        '    at new Promise (<anonymous>)\n' +
        '    at callAsyncCircusFn (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:1497:10)\n' +
        '    at _callCircusTest (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:1007:40)\n' +
        '    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n' +
        '    at _runTest (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:947:3)\n' +
        '    at /Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:849:7\n' +
        '    at _runTestsForDescribeBlock (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:862:11)\n' +
        '    at _runTestsForDescribeBlock (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:857:11)\n' +
        '    at run (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:761:3)\n' +
        '    at runAndTransformResultsToJestFormat (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:1918:21)\n' +
        '    at jestAdapter (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/runner.js:101:19)\n' +
        '    at runTestInternal (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-runner/build/index.js:275:16)\n' +
        '    at runTest (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-runner/build/index.js:343:7)',
      timestamp: '2025-11-09T07:24:51.257Z',
      path: '/api/auth/account',
      method: 'DELETE'
    }

      90 |   }
      91 |
    > 92 |   console.error('Error:', {
         |           ^
      93 |     message: err.message,
      94 |     statusCode,
      95 |     stack: err.stack,

      at error (src/middleware/errorHandler.ts:92:11)
      at Layer.handleError (node_modules/router/lib/layer.js:116:17)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at Layer.handleError (node_modules/router/lib/layer.js:111:12)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at node_modules/router/index.js:688:15
      at next (node_modules/router/index.js:276:14)
      at next (node_modules/router/lib/route.js:132:14)
      at AuthController.next [as deleteAccount] (src/controllers/auth.controller.ts:400:7)

  console.error
    Error: {
      message: 'MongoServerError: replica set not available',
      statusCode: 500,
      stack: 'Error: MongoServerError: replica set not available\n' +
        '    at Object.<anonymous> (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/tests/with-mocks/auth.mock.test.ts:323:7)\n' +
        '    at Promise.finally.completed (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:1557:28)\n' +
        '    at new Promise (<anonymous>)\n' +
        '    at callAsyncCircusFn (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:1497:10)\n' +
        '    at _callCircusTest (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:1007:40)\n' +
        '    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n' +
        '    at _runTest (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:947:3)\n' +
        '    at /Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:849:7\n' +
        '    at _runTestsForDescribeBlock (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:862:11)\n' +
        '    at _runTestsForDescribeBlock (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:857:11)\n' +
        '    at run (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:761:3)\n' +
        '    at runAndTransformResultsToJestFormat (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:1918:21)\n' +
        '    at jestAdapter (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/runner.js:101:19)\n' +
        '    at runTestInternal (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-runner/build/index.js:275:16)\n' +
        '    at runTest (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-runner/build/index.js:343:7)',
      timestamp: '2025-11-09T07:24:51.260Z',
      path: '/api/auth/account',
      method: 'DELETE'
    }

      90 |   }
      91 |
    > 92 |   console.error('Error:', {
         |           ^
      93 |     message: err.message,
      94 |     statusCode,
      95 |     stack: err.stack,

      at error (src/middleware/errorHandler.ts:92:11)
      at Layer.handleError (node_modules/router/lib/layer.js:116:17)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at Layer.handleError (node_modules/router/lib/layer.js:111:12)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at node_modules/router/index.js:688:15
      at next (node_modules/router/index.js:276:14)
      at next (node_modules/router/lib/route.js:132:14)
      at AuthController.next [as deleteAccount] (src/controllers/auth.controller.ts:400:7)

  console.error
    Error: {
      message: 'MongoNetworkError: connection closed',
      statusCode: 500,
      stack: 'Error: MongoNetworkError: connection closed\n' +
        '    at Object.<anonymous> (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/tests/with-mocks/auth.mock.test.ts:342:7)\n' +
        '    at Promise.finally.completed (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:1557:28)\n' +
        '    at new Promise (<anonymous>)\n' +
        '    at callAsyncCircusFn (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:1497:10)\n' +
        '    at _callCircusTest (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:1007:40)\n' +
        '    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n' +
        '    at _runTest (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:947:3)\n' +
        '    at /Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:849:7\n' +
        '    at _runTestsForDescribeBlock (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:862:11)\n' +
        '    at _runTestsForDescribeBlock (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:857:11)\n' +
        '    at run (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:761:3)\n' +
        '    at runAndTransformResultsToJestFormat (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:1918:21)\n' +
        '    at jestAdapter (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/runner.js:101:19)\n' +
        '    at runTestInternal (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-runner/build/index.js:275:16)\n' +
        '    at runTest (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-runner/build/index.js:343:7)',
      timestamp: '2025-11-09T07:24:51.263Z',
      path: '/api/auth/account',
      method: 'DELETE'
    }

      90 |   }
      91 |
    > 92 |   console.error('Error:', {
         |           ^
      93 |     message: err.message,
      94 |     statusCode,
      95 |     stack: err.stack,

      at error (src/middleware/errorHandler.ts:92:11)
      at Layer.handleError (node_modules/router/lib/layer.js:116:17)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at Layer.handleError (node_modules/router/lib/layer.js:111:12)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at node_modules/router/index.js:688:15
      at next (node_modules/router/index.js:276:14)
      at next (node_modules/router/lib/route.js:132:14)
      at AuthController.next [as deleteAccount] (src/controllers/auth.controller.ts:400:7)

  console.error
    Error: {
      message: 'MongoServerError: operation exceeded time limit',
      statusCode: 500,
      stack: 'Error: MongoServerError: operation exceeded time limit\n' +
        '    at Object.<anonymous> (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/tests/with-mocks/auth.mock.test.ts:363:7)\n' +
        '    at Promise.finally.completed (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:1557:28)\n' +
        '    at new Promise (<anonymous>)\n' +
        '    at callAsyncCircusFn (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:1497:10)\n' +
        '    at _callCircusTest (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:1007:40)\n' +
        '    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n' +
        '    at _runTest (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:947:3)\n' +
        '    at /Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:849:7\n' +
        '    at _runTestsForDescribeBlock (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:862:11)\n' +
        '    at _runTestsForDescribeBlock (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:857:11)\n' +
        '    at run (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:761:3)\n' +
        '    at runAndTransformResultsToJestFormat (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:1918:21)\n' +
        '    at jestAdapter (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/runner.js:101:19)\n' +
        '    at runTestInternal (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-runner/build/index.js:275:16)\n' +
        '    at runTest (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-runner/build/index.js:343:7)',
      timestamp: '2025-11-09T07:24:51.266Z',
      path: '/api/auth/logout',
      method: 'POST'
    }

      90 |   }
      91 |
    > 92 |   console.error('Error:', {
         |           ^
      93 |     message: err.message,
      94 |     statusCode,
      95 |     stack: err.stack,

      at error (src/middleware/errorHandler.ts:92:11)
      at Layer.handleError (node_modules/router/lib/layer.js:116:17)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at Layer.handleError (node_modules/router/lib/layer.js:111:12)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at node_modules/router/index.js:688:15
      at next (node_modules/router/index.js:276:14)
      at next (node_modules/router/lib/route.js:132:14)
      at AuthController.next [as logout] (src/controllers/auth.controller.ts:274:7)

  console.error
    Error: {
      message: 'MongoServerError: cursor timeout',
      statusCode: 500,
      stack: 'Error: MongoServerError: cursor timeout\n' +
        '    at Object.<anonymous> (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/tests/with-mocks/auth.mock.test.ts:382:7)\n' +
        '    at Promise.finally.completed (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:1557:28)\n' +
        '    at new Promise (<anonymous>)\n' +
        '    at callAsyncCircusFn (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:1497:10)\n' +
        '    at _callCircusTest (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:1007:40)\n' +
        '    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n' +
        '    at _runTest (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:947:3)\n' +
        '    at /Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:849:7\n' +
        '    at _runTestsForDescribeBlock (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:862:11)\n' +
        '    at _runTestsForDescribeBlock (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:857:11)\n' +
        '    at run (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:761:3)\n' +
        '    at runAndTransformResultsToJestFormat (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:1918:21)\n' +
        '    at jestAdapter (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/runner.js:101:19)\n' +
        '    at runTestInternal (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-runner/build/index.js:275:16)\n' +
        '    at runTest (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-runner/build/index.js:343:7)',
      timestamp: '2025-11-09T07:24:51.269Z',
      path: '/api/auth/verify',
      method: 'GET'
    }

      90 |   }
      91 |
    > 92 |   console.error('Error:', {
         |           ^
      93 |     message: err.message,
      94 |     statusCode,
      95 |     stack: err.stack,

      at error (src/middleware/errorHandler.ts:92:11)
      at Layer.handleError (node_modules/router/lib/layer.js:116:17)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at Layer.handleError (node_modules/router/lib/layer.js:111:12)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at Immediate.next (node_modules/router/index.js:291:5)
      at Immediate._onImmediate (node_modules/router/index.js:688:15)

  console.error
    Error: {
      message: 'MongoServerError: connection pool exhausted',
      statusCode: 500,
      stack: 'Error: MongoServerError: connection pool exhausted\n' +
        '    at Object.<anonymous> (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/tests/with-mocks/auth.mock.test.ts:401:7)\n' +
        '    at Promise.finally.completed (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:1557:28)\n' +
        '    at new Promise (<anonymous>)\n' +
        '    at callAsyncCircusFn (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:1497:10)\n' +
        '    at _callCircusTest (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:1007:40)\n' +
        '    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n' +
        '    at _runTest (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:947:3)\n' +
        '    at /Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:849:7\n' +
        '    at _runTestsForDescribeBlock (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:862:11)\n' +
        '    at _runTestsForDescribeBlock (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:857:11)\n' +
        '    at run (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:761:3)\n' +
        '    at runAndTransformResultsToJestFormat (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:1918:21)\n' +
        '    at jestAdapter (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/runner.js:101:19)\n' +
        '    at runTestInternal (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-runner/build/index.js:275:16)\n' +
        '    at runTest (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-runner/build/index.js:343:7)',
      timestamp: '2025-11-09T07:24:51.271Z',
      path: '/api/auth/logout',
      method: 'POST'
    }

      90 |   }
      91 |
    > 92 |   console.error('Error:', {
         |           ^
      93 |     message: err.message,
      94 |     statusCode,
      95 |     stack: err.stack,

      at error (src/middleware/errorHandler.ts:92:11)
      at Layer.handleError (node_modules/router/lib/layer.js:116:17)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at Layer.handleError (node_modules/router/lib/layer.js:111:12)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at node_modules/router/index.js:688:15
      at next (node_modules/router/index.js:276:14)
      at next (node_modules/router/lib/route.js:132:14)
      at AuthController.next [as logout] (src/controllers/auth.controller.ts:274:7)

  console.log
    Test suite completed.

      at Object.<anonymous> (tests/setup.ts:14:11)

  console.log
    
    üßπ Cleaning up after tests...

      at Object.<anonymous> (tests/with-mocks/auth.mock.test.ts:38:11)

  console.warn
    MongoDB disconnected. Attempting to reconnect...

      28 |
      29 |     mongoose.connection.on('disconnected', () => {
    > 30 |       console.warn('MongoDB disconnected. Attempting to reconnect...');
         |               ^
      31 |     });
      32 |
      33 |     mongoose.connection.on('reconnected', () => {

      at NativeConnection.<anonymous> (src/config/database.ts:30:15)
      at NativeConnection.set (node_modules/mongoose/lib/connection.js:145:12)
      at NativeConnection.onClose (node_modules/mongoose/lib/connection.js:1315:19)
      at NativeConnection._close (node_modules/mongoose/lib/connection.js:1264:12)
      at disconnectDatabase (src/config/database.ts:55:5)
      at Object.<anonymous> (tests/with-mocks/auth.mock.test.ts:40:3)

  console.log
    MongoDB disconnected successfully

      at disconnectDatabase (src/config/database.ts:56:13)

  console.log
    ‚úÖ Cleanup complete.

      at Object.<anonymous> (tests/with-mocks/auth.mock.test.ts:41:11)

PASS tests/with-mocks/auth.mock.test.ts
  POST /api/auth/logout - Database Failures
    ‚úì should return 500 when User.findById() fails (11 ms)
    ‚úì should return 500 when user.save() fails (3 ms)
    ‚úì should return 500 when database timeout occurs (2 ms)
    ‚úì should return 500 when network partition occurs (3 ms)
  GET /api/auth/verify - Database Failures
    ‚úì should return 500 when User.findById() fails (3 ms)
    ‚úì should return 500 when database timeout occurs (2 ms)
    ‚úì should return 500 when replica set fails (2 ms)
  POST /api/auth/fcm-token - Database Failures
    ‚úì should return 500 when User.findById() fails (3 ms)
    ‚úì should return 500 when user.save() fails (5 ms)
    ‚úì should return 500 when network partition occurs (3 ms)
    ‚úì should return 500 when cursor timeout occurs (2 ms)
  DELETE /api/auth/account - Database Failures
    ‚úì should return 500 when User.findById() fails (2 ms)
    ‚úì should return 500 when User.findByIdAndDelete() fails (3 ms)
    ‚úì should return 500 when replica set is unavailable (3 ms)
    ‚úì should return 500 when database connection is lost (2 ms)
  Network Timeout Scenarios
    ‚úì should handle database query timeout in logout (3 ms)
    ‚úì should handle cursor timeout in verify (3 ms)
    ‚úì should handle connection pool exhaustion (2 ms)

  console.log
    [dotenv@17.2.3] injecting env (3) from .env.test -- tip: üóÇÔ∏è backup and recover secrets: https://dotenvx.com/ops

      at _log (node_modules/dotenv/lib/main.js:142:11)

  console.log
    Starting test suite...

      at Object.<anonymous> (tests/setup.ts:9:11)

  console.error
    Error: {
      message: 'Database connection failed',
      statusCode: 500,
      stack: 'Error: Database connection failed\n' +
        '    at Object.<anonymous> (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/tests/with-mocks/user.mock.test.ts:51:39)\n' +
        '    at Promise.finally.completed (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:1557:28)\n' +
        '    at new Promise (<anonymous>)\n' +
        '    at callAsyncCircusFn (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:1497:10)\n' +
        '    at _callCircusTest (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:1007:40)\n' +
        '    at _runTest (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:947:3)\n' +
        '    at /Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:849:7\n' +
        '    at _runTestsForDescribeBlock (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:862:11)\n' +
        '    at _runTestsForDescribeBlock (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:857:11)\n' +
        '    at run (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:761:3)\n' +
        '    at runAndTransformResultsToJestFormat (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:1918:21)\n' +
        '    at jestAdapter (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/runner.js:101:19)\n' +
        '    at runTestInternal (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-runner/build/index.js:275:16)\n' +
        '    at runTest (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-runner/build/index.js:343:7)',
      timestamp: '2025-11-09T07:24:51.473Z',
      path: '/api/user/profile/user123',
      method: 'GET'
    }

      90 |   }
      91 |
    > 92 |   console.error('Error:', {
         |           ^
      93 |     message: err.message,
      94 |     statusCode,
      95 |     stack: err.stack,

      at error (src/middleware/errorHandler.ts:92:11)
      at Layer.handleError (node_modules/router/lib/layer.js:116:17)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at Layer.handleError (node_modules/router/lib/layer.js:111:12)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at node_modules/router/index.js:688:15
      at next (node_modules/router/index.js:276:14)
      at next (node_modules/router/lib/route.js:132:14)
      at UserController.next [as getUserProfiles] (src/controllers/user.controller.ts:26:7)
      at src/routes/user.routes.ts:14:3
      at src/middleware/errorHandler.ts:58:9

  console.error
    Error: {
      message: 'Cast to ObjectId failed',
      statusCode: 400,
      stack: 'CastError: Cast to ObjectId failed\n' +
        '    at Object.<anonymous> (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/tests/with-mocks/user.mock.test.ts:75:23)\n' +
        '    at Promise.finally.completed (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:1557:28)\n' +
        '    at new Promise (<anonymous>)\n' +
        '    at callAsyncCircusFn (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:1497:10)\n' +
        '    at _callCircusTest (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:1007:40)\n' +
        '    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n' +
        '    at _runTest (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:947:3)\n' +
        '    at /Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:849:7\n' +
        '    at _runTestsForDescribeBlock (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:862:11)\n' +
        '    at _runTestsForDescribeBlock (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:857:11)\n' +
        '    at run (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:761:3)\n' +
        '    at runAndTransformResultsToJestFormat (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:1918:21)\n' +
        '    at jestAdapter (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/runner.js:101:19)\n' +
        '    at runTestInternal (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-runner/build/index.js:275:16)\n' +
        '    at runTest (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-runner/build/index.js:343:7)',
      timestamp: '2025-11-09T07:24:51.477Z',
      path: '/api/user/profile/invalid-id',
      method: 'GET'
    }

      90 |   }
      91 |
    > 92 |   console.error('Error:', {
         |           ^
      93 |     message: err.message,
      94 |     statusCode,
      95 |     stack: err.stack,

      at error (src/middleware/errorHandler.ts:92:11)
      at Layer.handleError (node_modules/router/lib/layer.js:116:17)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at Layer.handleError (node_modules/router/lib/layer.js:111:12)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at node_modules/router/index.js:688:15
      at next (node_modules/router/index.js:276:14)
      at next (node_modules/router/lib/route.js:132:14)
      at UserController.next [as getUserProfiles] (src/controllers/user.controller.ts:26:7)
      at src/routes/user.routes.ts:14:3
      at src/middleware/errorHandler.ts:58:9

  console.error
    Error: {
      message: 'Operation timed out',
      statusCode: 500,
      stack: 'Error: Operation timed out\n' +
        '    at Object.<anonymous> (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/tests/with-mocks/user.mock.test.ts:101:39)\n' +
        '    at Promise.finally.completed (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:1557:28)\n' +
        '    at new Promise (<anonymous>)\n' +
        '    at callAsyncCircusFn (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:1497:10)\n' +
        '    at _callCircusTest (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:1007:40)\n' +
        '    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n' +
        '    at _runTest (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:947:3)\n' +
        '    at /Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:849:7\n' +
        '    at _runTestsForDescribeBlock (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:862:11)\n' +
        '    at _runTestsForDescribeBlock (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:857:11)\n' +
        '    at run (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:761:3)\n' +
        '    at runAndTransformResultsToJestFormat (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:1918:21)\n' +
        '    at jestAdapter (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/runner.js:101:19)\n' +
        '    at runTestInternal (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-runner/build/index.js:275:16)\n' +
        '    at runTest (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-runner/build/index.js:343:7)',
      timestamp: '2025-11-09T07:24:51.479Z',
      path: '/api/user/profile/user123',
      method: 'GET'
    }

      90 |   }
      91 |
    > 92 |   console.error('Error:', {
         |           ^
      93 |     message: err.message,
      94 |     statusCode,
      95 |     stack: err.stack,

      at error (src/middleware/errorHandler.ts:92:11)
      at Layer.handleError (node_modules/router/lib/layer.js:116:17)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at Layer.handleError (node_modules/router/lib/layer.js:111:12)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at node_modules/router/index.js:688:15
      at next (node_modules/router/index.js:276:14)
      at next (node_modules/router/lib/route.js:132:14)
      at UserController.next [as getUserProfiles] (src/controllers/user.controller.ts:26:7)
      at src/routes/user.routes.ts:14:3
      at src/middleware/errorHandler.ts:58:9

  console.log
    [UserService] getUserSettings called for userId: test-user-id-123

      at UserService.log [as getUserSettings] (src/services/userService.ts:55:13)

  console.error
    Error: {
      message: 'User not found',
      statusCode: 500,
      stack: 'Error: User not found\n' +
        '    at UserService.getUserSettings (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/src/services/userService.ts:60:13)\n' +
        '    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n' +
        '    at UserController.getUserSettings (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/src/controllers/user.controller.ts:38:24)\n' +
        '    at /Users/hashim/Desktop/Development/FeastFriends/321-project/backend/src/routes/user.routes.ts:23:3\n' +
        '    at /Users/hashim/Desktop/Development/FeastFriends/321-project/backend/src/middleware/errorHandler.ts:58:9',
      timestamp: '2025-11-09T07:24:51.490Z',
      path: '/api/user/settings',
      method: 'GET'
    }

      90 |   }
      91 |
    > 92 |   console.error('Error:', {
         |           ^
      93 |     message: err.message,
      94 |     statusCode,
      95 |     stack: err.stack,

      at error (src/middleware/errorHandler.ts:92:11)
      at Layer.handleError (node_modules/router/lib/layer.js:116:17)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at Layer.handleError (node_modules/router/lib/layer.js:111:12)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at node_modules/router/index.js:688:15
      at next (node_modules/router/index.js:276:14)
      at next (node_modules/router/lib/route.js:132:14)
      at UserController.next [as getUserSettings] (src/controllers/user.controller.ts:46:7)
      at src/routes/user.routes.ts:23:3
      at src/middleware/errorHandler.ts:58:9

  console.log
    [UserService] getUserSettings called for userId: test-user-id-123

      at UserService.log [as getUserSettings] (src/services/userService.ts:55:13)

  console.error
    Error: {
      message: 'Connection lost',
      statusCode: 500,
      stack: 'Error: Connection lost\n' +
        '    at Object.<anonymous> (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/tests/with-mocks/user.mock.test.ts:185:43)\n' +
        '    at Promise.finally.completed (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:1557:28)\n' +
        '    at new Promise (<anonymous>)\n' +
        '    at callAsyncCircusFn (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:1497:10)\n' +
        '    at _callCircusTest (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:1007:40)\n' +
        '    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n' +
        '    at _runTest (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:947:3)\n' +
        '    at /Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:849:7\n' +
        '    at _runTestsForDescribeBlock (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:862:11)\n' +
        '    at _runTestsForDescribeBlock (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:857:11)\n' +
        '    at run (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:761:3)\n' +
        '    at runAndTransformResultsToJestFormat (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:1918:21)\n' +
        '    at jestAdapter (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/runner.js:101:19)\n' +
        '    at runTestInternal (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-runner/build/index.js:275:16)\n' +
        '    at runTest (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-runner/build/index.js:343:7)',
      timestamp: '2025-11-09T07:24:51.497Z',
      path: '/api/user/settings',
      method: 'GET'
    }

      90 |   }
      91 |
    > 92 |   console.error('Error:', {
         |           ^
      93 |     message: err.message,
      94 |     statusCode,
      95 |     stack: err.stack,

      at error (src/middleware/errorHandler.ts:92:11)
      at Layer.handleError (node_modules/router/lib/layer.js:116:17)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at Layer.handleError (node_modules/router/lib/layer.js:111:12)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at node_modules/router/index.js:688:15
      at next (node_modules/router/index.js:276:14)
      at next (node_modules/router/lib/route.js:132:14)
      at UserController.next [as getUserSettings] (src/controllers/user.controller.ts:46:7)
      at src/routes/user.routes.ts:23:3
      at src/middleware/errorHandler.ts:58:9

  console.log
    [UserService] getUserSettings called for userId: invalid-format

      at UserService.log [as getUserSettings] (src/services/userService.ts:55:13)

  console.error
    Error: {
      message: 'Invalid ObjectId',
      statusCode: 400,
      stack: 'CastError: Invalid ObjectId\n' +
        '    at Object.<anonymous> (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/tests/with-mocks/user.mock.test.ts:211:23)\n' +
        '    at Promise.finally.completed (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:1557:28)\n' +
        '    at new Promise (<anonymous>)\n' +
        '    at callAsyncCircusFn (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:1497:10)\n' +
        '    at _callCircusTest (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:1007:40)\n' +
        '    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n' +
        '    at _runTest (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:947:3)\n' +
        '    at /Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:849:7\n' +
        '    at _runTestsForDescribeBlock (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:862:11)\n' +
        '    at _runTestsForDescribeBlock (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:857:11)\n' +
        '    at run (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:761:3)\n' +
        '    at runAndTransformResultsToJestFormat (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:1918:21)\n' +
        '    at jestAdapter (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/runner.js:101:19)\n' +
        '    at runTestInternal (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-runner/build/index.js:275:16)\n' +
        '    at runTest (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-runner/build/index.js:343:7)',
      timestamp: '2025-11-09T07:24:51.500Z',
      path: '/api/user/settings',
      method: 'GET'
    }

      90 |   }
      91 |
    > 92 |   console.error('Error:', {
         |           ^
      93 |     message: err.message,
      94 |     statusCode,
      95 |     stack: err.stack,

      at error (src/middleware/errorHandler.ts:92:11)
      at Layer.handleError (node_modules/router/lib/layer.js:116:17)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at Layer.handleError (node_modules/router/lib/layer.js:111:12)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at node_modules/router/index.js:688:15
      at next (node_modules/router/index.js:276:14)
      at next (node_modules/router/lib/route.js:132:14)
      at UserController.next [as getUserSettings] (src/controllers/user.controller.ts:46:7)
      at src/routes/user.routes.ts:23:3
      at src/middleware/errorHandler.ts:58:9

  console.error
    Error: {
      message: 'User not found',
      statusCode: 500,
      stack: 'Error: User not found\n' +
        '    at UserService.createUserProfile (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/src/services/userService.ts:96:13)\n' +
        '    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n' +
        '    at UserController.createUserProfile (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/src/controllers/user.controller.ts:60:23)\n' +
        '    at /Users/hashim/Desktop/Development/FeastFriends/321-project/backend/src/routes/user.routes.ts:32:3\n' +
        '    at /Users/hashim/Desktop/Development/FeastFriends/321-project/backend/src/middleware/errorHandler.ts:58:9',
      timestamp: '2025-11-09T07:24:51.504Z',
      path: '/api/user/profile',
      method: 'POST'
    }

      90 |   }
      91 |
    > 92 |   console.error('Error:', {
         |           ^
      93 |     message: err.message,
      94 |     statusCode,
      95 |     stack: err.stack,

      at error (src/middleware/errorHandler.ts:92:11)
      at Layer.handleError (node_modules/router/lib/layer.js:116:17)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at Layer.handleError (node_modules/router/lib/layer.js:111:12)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at node_modules/router/index.js:688:15
      at next (node_modules/router/index.js:276:14)
      at next (node_modules/router/lib/route.js:132:14)
      at UserController.next [as createUserProfile] (src/controllers/user.controller.ts:73:7)
      at src/routes/user.routes.ts:32:3
      at src/middleware/errorHandler.ts:58:9

  console.error
    Error: {
      message: 'Write failed',
      statusCode: 500,
      stack: 'Error: Write failed\n' +
        '    at Object.<anonymous> (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/tests/with-mocks/user.mock.test.ts:285:41)\n' +
        '    at Promise.finally.completed (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:1557:28)\n' +
        '    at new Promise (<anonymous>)\n' +
        '    at callAsyncCircusFn (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:1497:10)\n' +
        '    at _callCircusTest (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:1007:40)\n' +
        '    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n' +
        '    at _runTest (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:947:3)\n' +
        '    at /Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:849:7\n' +
        '    at _runTestsForDescribeBlock (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:862:11)\n' +
        '    at _runTestsForDescribeBlock (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:857:11)\n' +
        '    at run (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:761:3)\n' +
        '    at runAndTransformResultsToJestFormat (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:1918:21)\n' +
        '    at jestAdapter (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/runner.js:101:19)\n' +
        '    at runTestInternal (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-runner/build/index.js:275:16)\n' +
        '    at runTest (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-runner/build/index.js:343:7)',
      timestamp: '2025-11-09T07:24:51.507Z',
      path: '/api/user/profile',
      method: 'POST'
    }

      90 |   }
      91 |
    > 92 |   console.error('Error:', {
         |           ^
      93 |     message: err.message,
      94 |     statusCode,
      95 |     stack: err.stack,

      at error (src/middleware/errorHandler.ts:92:11)
      at Layer.handleError (node_modules/router/lib/layer.js:116:17)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at Layer.handleError (node_modules/router/lib/layer.js:111:12)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at node_modules/router/index.js:688:15
      at next (node_modules/router/index.js:276:14)
      at next (node_modules/router/lib/route.js:132:14)
      at UserController.next [as createUserProfile] (src/controllers/user.controller.ts:73:7)
      at src/routes/user.routes.ts:32:3
      at src/middleware/errorHandler.ts:58:9

  console.error
    Error: {
      message: 'Validation failed: name is required',
      statusCode: 400,
      stack: 'ValidationError: Validation failed: name is required\n' +
        '    at Object.<anonymous> (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/tests/with-mocks/user.mock.test.ts:317:29)\n' +
        '    at Promise.finally.completed (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:1557:28)\n' +
        '    at new Promise (<anonymous>)\n' +
        '    at callAsyncCircusFn (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:1497:10)\n' +
        '    at _callCircusTest (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:1007:40)\n' +
        '    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n' +
        '    at _runTest (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:947:3)\n' +
        '    at /Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:849:7\n' +
        '    at _runTestsForDescribeBlock (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:862:11)\n' +
        '    at _runTestsForDescribeBlock (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:857:11)\n' +
        '    at run (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:761:3)\n' +
        '    at runAndTransformResultsToJestFormat (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:1918:21)\n' +
        '    at jestAdapter (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/runner.js:101:19)\n' +
        '    at runTestInternal (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-runner/build/index.js:275:16)\n' +
        '    at runTest (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-runner/build/index.js:343:7)',
      timestamp: '2025-11-09T07:24:51.509Z',
      path: '/api/user/profile',
      method: 'POST'
    }

      90 |   }
      91 |
    > 92 |   console.error('Error:', {
         |           ^
      93 |     message: err.message,
      94 |     statusCode,
      95 |     stack: err.stack,

      at error (src/middleware/errorHandler.ts:92:11)
      at Layer.handleError (node_modules/router/lib/layer.js:116:17)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at Layer.handleError (node_modules/router/lib/layer.js:111:12)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at node_modules/router/index.js:688:15
      at next (node_modules/router/index.js:276:14)
      at next (node_modules/router/lib/route.js:132:14)
      at UserController.next [as createUserProfile] (src/controllers/user.controller.ts:73:7)
      at src/routes/user.routes.ts:32:3
      at src/middleware/errorHandler.ts:58:9

  console.log
    [UserService] updateUserSettings called for userId: test-user-id-123

      at UserService.log [as updateUserSettings] (src/services/userService.ts:130:13)

  console.log
    [UserService] Data received: {
      name: undefined,
      bio: undefined,
      preference: undefined,
      profilePicture: undefined,
      contactNumber: undefined,
      budget: 50,
      radiusKm: undefined
    }

      at UserService.log [as updateUserSettings] (src/services/userService.ts:131:13)

  console.error
    Error: {
      message: 'User not found',
      statusCode: 500,
      stack: 'Error: User not found\n' +
        '    at UserService.updateUserSettings (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/src/services/userService.ts:136:13)\n' +
        '    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n' +
        '    at UserController.updateUserSettings (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/src/controllers/user.controller.ts:87:24)\n' +
        '    at /Users/hashim/Desktop/Development/FeastFriends/321-project/backend/src/routes/user.routes.ts:41:3\n' +
        '    at /Users/hashim/Desktop/Development/FeastFriends/321-project/backend/src/middleware/errorHandler.ts:58:9',
      timestamp: '2025-11-09T07:24:51.514Z',
      path: '/api/user/settings',
      method: 'POST'
    }

      90 |   }
      91 |
    > 92 |   console.error('Error:', {
         |           ^
      93 |     message: err.message,
      94 |     statusCode,
      95 |     stack: err.stack,

      at error (src/middleware/errorHandler.ts:92:11)
      at Layer.handleError (node_modules/router/lib/layer.js:116:17)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at Layer.handleError (node_modules/router/lib/layer.js:111:12)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at node_modules/router/index.js:688:15
      at next (node_modules/router/index.js:276:14)
      at next (node_modules/router/lib/route.js:132:14)
      at UserController.next [as updateUserSettings] (src/controllers/user.controller.ts:103:7)
      at src/routes/user.routes.ts:41:3
      at src/middleware/errorHandler.ts:58:9

  console.log
    [UserService] updateUserSettings called for userId: test-user-id-123

      at UserService.log [as updateUserSettings] (src/services/userService.ts:130:13)

  console.log
    [UserService] Data received: {
      name: undefined,
      bio: undefined,
      preference: undefined,
      profilePicture: undefined,
      contactNumber: undefined,
      budget: 100,
      radiusKm: undefined
    }

      at UserService.log [as updateUserSettings] (src/services/userService.ts:131:13)

  console.error
    Error: {
      message: 'Database write error',
      statusCode: 500,
      stack: 'Error: Database write error\n' +
        '    at Object.<anonymous> (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/tests/with-mocks/user.mock.test.ts:394:41)\n' +
        '    at Promise.finally.completed (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:1557:28)\n' +
        '    at new Promise (<anonymous>)\n' +
        '    at callAsyncCircusFn (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:1497:10)\n' +
        '    at _callCircusTest (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:1007:40)\n' +
        '    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n' +
        '    at _runTest (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:947:3)\n' +
        '    at /Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:849:7\n' +
        '    at _runTestsForDescribeBlock (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:862:11)\n' +
        '    at _runTestsForDescribeBlock (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:857:11)\n' +
        '    at run (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:761:3)\n' +
        '    at runAndTransformResultsToJestFormat (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:1918:21)\n' +
        '    at jestAdapter (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/runner.js:101:19)\n' +
        '    at runTestInternal (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-runner/build/index.js:275:16)\n' +
        '    at runTest (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-runner/build/index.js:343:7)',
      timestamp: '2025-11-09T07:24:51.518Z',
      path: '/api/user/settings',
      method: 'POST'
    }

      90 |   }
      91 |
    > 92 |   console.error('Error:', {
         |           ^
      93 |     message: err.message,
      94 |     statusCode,
      95 |     stack: err.stack,

      at error (src/middleware/errorHandler.ts:92:11)
      at Layer.handleError (node_modules/router/lib/layer.js:116:17)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at Layer.handleError (node_modules/router/lib/layer.js:111:12)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at node_modules/router/index.js:688:15
      at next (node_modules/router/index.js:276:14)
      at next (node_modules/router/lib/route.js:132:14)
      at UserController.next [as updateUserSettings] (src/controllers/user.controller.ts:103:7)
      at src/routes/user.routes.ts:41:3
      at src/middleware/errorHandler.ts:58:9

  console.log
    [UserService] updateUserSettings called for userId: test-user-id-123

      at UserService.log [as updateUserSettings] (src/services/userService.ts:130:13)

  console.log
    [UserService] Data received: {
      name: undefined,
      bio: undefined,
      preference: undefined,
      profilePicture: 'https://lh3.googleusercontent.com/test',
      contactNumber: undefined,
      budget: undefined,
      radiusKm: undefined
    }

      at UserService.log [as updateUserSettings] (src/services/userService.ts:131:13)

  console.log
    [UserService] Updating profilePicture from "" to "https://lh3.googleusercontent.com/test"

      at UserService.log [as updateUserSettings] (src/services/userService.ts:143:15)

  console.log
    [UserService] Converting Google profile picture to Base64: https://lh3.googleusercontent.com/test

      at UserService.log [as convertGoogleProfilePictureToBase64] (src/services/userService.ts:15:15)

  console.error
    [UserService] Failed to convert profile picture to Base64: Error: Network error
        at Object.<anonymous> (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/tests/with-mocks/user.mock.test.ts:426:39)
        at Promise.finally.completed (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:1557:28)
        at new Promise (<anonymous>)
        at callAsyncCircusFn (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:1497:10)
        at _callCircusTest (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:1007:40)
        at processTicksAndRejections (node:internal/process/task_queues:105:5)
        at _runTest (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:947:3)
        at /Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:849:7
        at _runTestsForDescribeBlock (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:862:11)
        at _runTestsForDescribeBlock (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:857:11)
        at run (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:761:3)
        at runAndTransformResultsToJestFormat (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:1918:21)
        at jestAdapter (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/runner.js:101:19)
        at runTestInternal (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-runner/build/index.js:275:16)
        at runTest (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-runner/build/index.js:343:7)

      29 |       return base64DataUri;
      30 |     } catch (error) {
    > 31 |       console.error(`[UserService] Failed to convert profile picture to Base64:`, error);
         |               ^
      32 |       return profilePictureUrl; // Return original URL if conversion fails
      33 |     }
      34 |   }

      at UserService.error [as convertGoogleProfilePictureToBase64] (src/services/userService.ts:31:15)
      at UserService.updateUserSettings (src/services/userService.ts:146:39)
      at UserController.updateUserSettings (src/controllers/user.controller.ts:87:24)
      at src/routes/user.routes.ts:41:3
      at src/middleware/errorHandler.ts:58:9

  console.log
    [UserService] User saved. Current profilePicture: "https://lh3.googleusercontent.com/test"

      at UserService.log [as updateUserSettings] (src/services/userService.ts:154:13)

  console.log
    [UserService] getUserSettings called for userId: test-user-id-123

      at UserService.log [as getUserSettings] (src/services/userService.ts:55:13)

  console.log
    [UserService] User found. profilePicture: "https://lh3.googleusercontent.com/test"

      at UserService.log [as getUserSettings] (src/services/userService.ts:63:13)

  console.error
    Error: {
      message: 'User not found',
      statusCode: 500,
      stack: 'Error: User not found\n' +
        '    at UserService.updateUserProfile (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/src/services/userService.ts:177:13)\n' +
        '    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n' +
        '    at UserController.updateUserProfile (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/src/controllers/user.controller.ts:117:23)\n' +
        '    at /Users/hashim/Desktop/Development/FeastFriends/321-project/backend/src/routes/user.routes.ts:50:3\n' +
        '    at /Users/hashim/Desktop/Development/FeastFriends/321-project/backend/src/middleware/errorHandler.ts:58:9',
      timestamp: '2025-11-09T07:24:51.530Z',
      path: '/api/user/profile',
      method: 'PUT'
    }

      90 |   }
      91 |
    > 92 |   console.error('Error:', {
         |           ^
      93 |     message: err.message,
      94 |     statusCode,
      95 |     stack: err.stack,

      at error (src/middleware/errorHandler.ts:92:11)
      at Layer.handleError (node_modules/router/lib/layer.js:116:17)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at Layer.handleError (node_modules/router/lib/layer.js:111:12)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at node_modules/router/index.js:688:15
      at next (node_modules/router/index.js:276:14)
      at next (node_modules/router/lib/route.js:132:14)
      at UserController.next [as updateUserProfile] (src/controllers/user.controller.ts:133:7)
      at src/routes/user.routes.ts:50:3
      at src/middleware/errorHandler.ts:58:9

  console.error
    Error: {
      message: 'Update failed',
      statusCode: 500,
      stack: 'Error: Update failed\n' +
        '    at Object.<anonymous> (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/tests/with-mocks/user.mock.test.ts:507:41)\n' +
        '    at Promise.finally.completed (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:1557:28)\n' +
        '    at new Promise (<anonymous>)\n' +
        '    at callAsyncCircusFn (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:1497:10)\n' +
        '    at _callCircusTest (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:1007:40)\n' +
        '    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n' +
        '    at _runTest (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:947:3)\n' +
        '    at /Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:849:7\n' +
        '    at _runTestsForDescribeBlock (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:862:11)\n' +
        '    at _runTestsForDescribeBlock (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:857:11)\n' +
        '    at run (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:761:3)\n' +
        '    at runAndTransformResultsToJestFormat (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:1918:21)\n' +
        '    at jestAdapter (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/runner.js:101:19)\n' +
        '    at runTestInternal (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-runner/build/index.js:275:16)\n' +
        '    at runTest (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-runner/build/index.js:343:7)',
      timestamp: '2025-11-09T07:24:51.532Z',
      path: '/api/user/profile',
      method: 'PUT'
    }

      90 |   }
      91 |
    > 92 |   console.error('Error:', {
         |           ^
      93 |     message: err.message,
      94 |     statusCode,
      95 |     stack: err.stack,

      at error (src/middleware/errorHandler.ts:92:11)
      at Layer.handleError (node_modules/router/lib/layer.js:116:17)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at Layer.handleError (node_modules/router/lib/layer.js:111:12)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at node_modules/router/index.js:688:15
      at next (node_modules/router/index.js:276:14)
      at next (node_modules/router/lib/route.js:132:14)
      at UserController.next [as updateUserProfile] (src/controllers/user.controller.ts:133:7)
      at src/routes/user.routes.ts:50:3
      at src/middleware/errorHandler.ts:58:9

  console.error
    Error: {
      message: 'Invalid field',
      statusCode: 400,
      stack: 'ValidationError: Invalid field\n' +
        '    at Object.<anonymous> (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/tests/with-mocks/user.mock.test.ts:537:29)\n' +
        '    at Promise.finally.completed (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:1557:28)\n' +
        '    at new Promise (<anonymous>)\n' +
        '    at callAsyncCircusFn (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:1497:10)\n' +
        '    at _callCircusTest (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:1007:40)\n' +
        '    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n' +
        '    at _runTest (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:947:3)\n' +
        '    at /Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:849:7\n' +
        '    at _runTestsForDescribeBlock (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:862:11)\n' +
        '    at _runTestsForDescribeBlock (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:857:11)\n' +
        '    at run (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:761:3)\n' +
        '    at runAndTransformResultsToJestFormat (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:1918:21)\n' +
        '    at jestAdapter (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/runner.js:101:19)\n' +
        '    at runTestInternal (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-runner/build/index.js:275:16)\n' +
        '    at runTest (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-runner/build/index.js:343:7)',
      timestamp: '2025-11-09T07:24:51.534Z',
      path: '/api/user/profile',
      method: 'PUT'
    }

      90 |   }
      91 |
    > 92 |   console.error('Error:', {
         |           ^
      93 |     message: err.message,
      94 |     statusCode,
      95 |     stack: err.stack,

      at error (src/middleware/errorHandler.ts:92:11)
      at Layer.handleError (node_modules/router/lib/layer.js:116:17)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at Layer.handleError (node_modules/router/lib/layer.js:111:12)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at node_modules/router/index.js:688:15
      at next (node_modules/router/index.js:276:14)
      at next (node_modules/router/lib/route.js:132:14)
      at UserController.next [as updateUserProfile] (src/controllers/user.controller.ts:133:7)
      at src/routes/user.routes.ts:50:3
      at src/middleware/errorHandler.ts:58:9

  console.error
    Error: {
      message: 'User not found',
      statusCode: 500,
      stack: 'Error: User not found\n' +
        '    at UserService.deleteUser (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/src/services/userService.ts:210:13)\n' +
        '    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n' +
        '    at UserController.deleteUser (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/src/controllers/user.controller.ts:156:22)\n' +
        '    at /Users/hashim/Desktop/Development/FeastFriends/321-project/backend/src/routes/user.routes.ts:59:3\n' +
        '    at /Users/hashim/Desktop/Development/FeastFriends/321-project/backend/src/middleware/errorHandler.ts:58:9',
      timestamp: '2025-11-09T07:24:51.537Z',
      path: '/api/user/test-user-id-123',
      method: 'DELETE'
    }

      90 |   }
      91 |
    > 92 |   console.error('Error:', {
         |           ^
      93 |     message: err.message,
      94 |     statusCode,
      95 |     stack: err.stack,

      at error (src/middleware/errorHandler.ts:92:11)
      at Layer.handleError (node_modules/router/lib/layer.js:116:17)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at Layer.handleError (node_modules/router/lib/layer.js:111:12)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at Immediate.next (node_modules/router/index.js:291:5)
      at Immediate._onImmediate (node_modules/router/index.js:688:15)

  console.error
    Error: {
      message: 'Cannot delete account while in a room or group',
      statusCode: 500,
      stack: 'Error: Cannot delete account while in a room or group\n' +
        '    at UserService.deleteUser (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/src/services/userService.ts:214:13)\n' +
        '    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n' +
        '    at UserController.deleteUser (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/src/controllers/user.controller.ts:156:22)\n' +
        '    at /Users/hashim/Desktop/Development/FeastFriends/321-project/backend/src/routes/user.routes.ts:59:3\n' +
        '    at /Users/hashim/Desktop/Development/FeastFriends/321-project/backend/src/middleware/errorHandler.ts:58:9',
      timestamp: '2025-11-09T07:24:51.539Z',
      path: '/api/user/user-in-room',
      method: 'DELETE'
    }

      90 |   }
      91 |
    > 92 |   console.error('Error:', {
         |           ^
      93 |     message: err.message,
      94 |     statusCode,
      95 |     stack: err.stack,

      at error (src/middleware/errorHandler.ts:92:11)
      at Layer.handleError (node_modules/router/lib/layer.js:116:17)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at Layer.handleError (node_modules/router/lib/layer.js:111:12)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at Immediate.next (node_modules/router/index.js:291:5)
      at Immediate._onImmediate (node_modules/router/index.js:688:15)

  console.error
    Error: {
      message: 'Cannot delete account while in a room or group',
      statusCode: 500,
      stack: 'Error: Cannot delete account while in a room or group\n' +
        '    at UserService.deleteUser (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/src/services/userService.ts:214:13)\n' +
        '    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n' +
        '    at UserController.deleteUser (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/src/controllers/user.controller.ts:156:22)\n' +
        '    at /Users/hashim/Desktop/Development/FeastFriends/321-project/backend/src/routes/user.routes.ts:59:3\n' +
        '    at /Users/hashim/Desktop/Development/FeastFriends/321-project/backend/src/middleware/errorHandler.ts:58:9',
      timestamp: '2025-11-09T07:24:51.541Z',
      path: '/api/user/user-in-group',
      method: 'DELETE'
    }

      90 |   }
      91 |
    > 92 |   console.error('Error:', {
         |           ^
      93 |     message: err.message,
      94 |     statusCode,
      95 |     stack: err.stack,

      at error (src/middleware/errorHandler.ts:92:11)
      at Layer.handleError (node_modules/router/lib/layer.js:116:17)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at Layer.handleError (node_modules/router/lib/layer.js:111:12)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at Immediate.next (node_modules/router/index.js:291:5)
      at Immediate._onImmediate (node_modules/router/index.js:688:15)

  console.error
    Error: {
      message: 'Delete operation failed',
      statusCode: 500,
      stack: 'Error: Delete operation failed\n' +
        '    at Object.<anonymous> (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/tests/with-mocks/user.mock.test.ts:683:52)\n' +
        '    at Promise.finally.completed (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:1557:28)\n' +
        '    at new Promise (<anonymous>)\n' +
        '    at callAsyncCircusFn (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:1497:10)\n' +
        '    at _callCircusTest (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:1007:40)\n' +
        '    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n' +
        '    at _runTest (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:947:3)\n' +
        '    at /Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:849:7\n' +
        '    at _runTestsForDescribeBlock (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:862:11)\n' +
        '    at _runTestsForDescribeBlock (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:857:11)\n' +
        '    at run (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:761:3)\n' +
        '    at runAndTransformResultsToJestFormat (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:1918:21)\n' +
        '    at jestAdapter (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/runner.js:101:19)\n' +
        '    at runTestInternal (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-runner/build/index.js:275:16)\n' +
        '    at runTest (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-runner/build/index.js:343:7)',
      timestamp: '2025-11-09T07:24:51.543Z',
      path: '/api/user/test-user-id-123',
      method: 'DELETE'
    }

      90 |   }
      91 |
    > 92 |   console.error('Error:', {
         |           ^
      93 |     message: err.message,
      94 |     statusCode,
      95 |     stack: err.stack,

      at error (src/middleware/errorHandler.ts:92:11)
      at Layer.handleError (node_modules/router/lib/layer.js:116:17)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at Layer.handleError (node_modules/router/lib/layer.js:111:12)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at Immediate.next (node_modules/router/index.js:291:5)
      at Immediate._onImmediate (node_modules/router/index.js:688:15)

  console.error
    Error: {
      message: 'Connection lost',
      statusCode: 500,
      stack: 'Error: Connection lost\n' +
        '    at Object.<anonymous> (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/tests/with-mocks/user.mock.test.ts:709:43)\n' +
        '    at Promise.finally.completed (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:1557:28)\n' +
        '    at new Promise (<anonymous>)\n' +
        '    at callAsyncCircusFn (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:1497:10)\n' +
        '    at _callCircusTest (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:1007:40)\n' +
        '    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n' +
        '    at _runTest (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:947:3)\n' +
        '    at /Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:849:7\n' +
        '    at _runTestsForDescribeBlock (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:862:11)\n' +
        '    at _runTestsForDescribeBlock (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:857:11)\n' +
        '    at run (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:761:3)\n' +
        '    at runAndTransformResultsToJestFormat (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/jestAdapterInit.js:1918:21)\n' +
        '    at jestAdapter (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-circus/build/runner.js:101:19)\n' +
        '    at runTestInternal (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-runner/build/index.js:275:16)\n' +
        '    at runTest (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-runner/build/index.js:343:7)',
      timestamp: '2025-11-09T07:24:51.547Z',
      path: '/api/user/test-user-id-123',
      method: 'DELETE'
    }

      90 |   }
      91 |
    > 92 |   console.error('Error:', {
         |           ^
      93 |     message: err.message,
      94 |     statusCode,
      95 |     stack: err.stack,

      at error (src/middleware/errorHandler.ts:92:11)
      at Layer.handleError (node_modules/router/lib/layer.js:116:17)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at Layer.handleError (node_modules/router/lib/layer.js:111:12)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at Immediate.next (node_modules/router/index.js:291:5)
      at Immediate._onImmediate (node_modules/router/index.js:688:15)

  console.log
    Test suite completed.

      at Object.<anonymous> (tests/setup.ts:14:11)

PASS tests/with-mocks/user.mock.test.ts
  GET /api/user/profile/:ids - With Mocking
    ‚úì should return 500 when database query fails (10 ms)
    ‚úì should return 400 when invalid ObjectId causes CastError (2 ms)
    ‚úì should handle database timeout gracefully (2 ms)
    ‚úì should return empty array when User.find returns empty (1 ms)
  GET /api/user/settings - With Mocking
    ‚úì should return 500 when user not found in database (9 ms)
    ‚úì should return 500 when database connection fails (7 ms)
    ‚úì should return 400 when invalid ObjectId format (3 ms)
  POST /api/user/profile - With Mocking
    ‚úì should return 500 when user not found (4 ms)
    ‚úì should return 500 when database save operation fails (3 ms)
    ‚úì should return 400 when Mongoose validation fails (3 ms)
  POST /api/user/settings - With Mocking
    ‚úì should return 500 when user not found (4 ms)
    ‚úì should return 500 when database update fails (4 ms)
    ‚úì should handle Google profile picture conversion failure gracefully (7 ms)
  PUT /api/user/profile - With Mocking
    ‚úì should return 500 when user not found (5 ms)
    ‚úì should return 500 when database update fails (2 ms)
    ‚úì should return 400 on validation error (2 ms)
  DELETE /api/user/:userId - With Mocking
    ‚úì should return 500 when user not found (3 ms)
    ‚úì should return 500 when user is in a room (2 ms)
    ‚úì should return 500 when user is in a group (2 ms)
    ‚úì should return 500 when database delete operation fails (3 ms)
    ‚úì should handle database connection loss during deletion (3 ms)

  console.log
    [dotenv@17.2.3] injecting env (3) from .env.test -- tip: ‚úÖ audit secrets and track compliance: https://dotenvx.com/ops

      at _log (node_modules/dotenv/lib/main.js:142:11)

  console.log
    Starting test suite...

      at Object.<anonymous> (tests/setup.ts:9:11)

  console.log
    
    üöÄ Starting Restaurant Tests (With Mocks - Failure Scenarios)...

      at Object.<anonymous> (tests/with-mocks/restaurant.mock.test.ts:42:11)

  console.log
    MongoDB Atlas connected successfully

      at connectDatabase (src/config/database.ts:22:13)

  console.log
    ‚úÖ Test setup complete.

      at Object.<anonymous> (tests/with-mocks/restaurant.mock.test.ts:52:11)

  console.log
    ‚úÖ Using Google Places API with key

      at RestaurantService.log [as searchRestaurants] (src/services/restaurantService.ts:45:15)

  console.error
    ‚ùå Failed to search restaurants: Service Unavailable

      81 |       if (error instanceof AppError) throw error;
      82 |       const errorMessage = error instanceof Error ? error.message : 'Unknown error';
    > 83 |       console.error('‚ùå Failed to search restaurants:', errorMessage);
         |               ^
      84 |       // Return mock data on error
      85 |       return this.getMockRestaurants();
      86 |     }

      at RestaurantService.error [as searchRestaurants] (src/services/restaurantService.ts:83:15)
      at RestaurantController.searchRestaurants (src/controllers/restaurant.controller.ts:30:27)
      at src/routes/restaurant.routes.ts:14:3
      at src/middleware/errorHandler.ts:58:9

  console.log
    ‚úÖ Using Google Places API with key

      at RestaurantService.log [as searchRestaurants] (src/services/restaurantService.ts:45:15)

  console.error
    ‚ùå Failed to search restaurants: ETIMEDOUT

      81 |       if (error instanceof AppError) throw error;
      82 |       const errorMessage = error instanceof Error ? error.message : 'Unknown error';
    > 83 |       console.error('‚ùå Failed to search restaurants:', errorMessage);
         |               ^
      84 |       // Return mock data on error
      85 |       return this.getMockRestaurants();
      86 |     }

      at RestaurantService.error [as searchRestaurants] (src/services/restaurantService.ts:83:15)
      at RestaurantController.searchRestaurants (src/controllers/restaurant.controller.ts:30:27)
      at src/routes/restaurant.routes.ts:14:3
      at src/middleware/errorHandler.ts:58:9

  console.log
    ‚úÖ Using Google Places API with key

      at RestaurantService.log [as searchRestaurants] (src/services/restaurantService.ts:45:15)

  console.error
    ‚ùå Failed to search restaurants: getaddrinfo ENOTFOUND maps.googleapis.com

      81 |       if (error instanceof AppError) throw error;
      82 |       const errorMessage = error instanceof Error ? error.message : 'Unknown error';
    > 83 |       console.error('‚ùå Failed to search restaurants:', errorMessage);
         |               ^
      84 |       // Return mock data on error
      85 |       return this.getMockRestaurants();
      86 |     }

      at RestaurantService.error [as searchRestaurants] (src/services/restaurantService.ts:83:15)
      at RestaurantController.searchRestaurants (src/controllers/restaurant.controller.ts:30:27)
      at src/routes/restaurant.routes.ts:14:3
      at src/middleware/errorHandler.ts:58:9

  console.log
    ‚úÖ Using Google Places API with key

      at RestaurantService.log [as searchRestaurants] (src/services/restaurantService.ts:45:15)

  console.log
    üì° Google API Response Status: OVER_QUERY_LIMIT

      at RestaurantService.log [as searchRestaurants] (src/services/restaurantService.ts:63:15)

  console.error
    Error: {
      message: 'Google Places API error: OVER_QUERY_LIMIT',
      statusCode: 500,
      stack: 'AppError: Google Places API error: OVER_QUERY_LIMIT\n' +
        '    at RestaurantService.searchRestaurants (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/src/services/restaurantService.ts:66:15)\n' +
        '    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n' +
        '    at RestaurantController.searchRestaurants (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/src/controllers/restaurant.controller.ts:30:27)\n' +
        '    at /Users/hashim/Desktop/Development/FeastFriends/321-project/backend/src/routes/restaurant.routes.ts:14:3\n' +
        '    at /Users/hashim/Desktop/Development/FeastFriends/321-project/backend/src/middleware/errorHandler.ts:58:9',
      timestamp: '2025-11-09T07:24:51.762Z',
      path: '/api/restaurant/search',
      method: 'GET'
    }

      90 |   }
      91 |
    > 92 |   console.error('Error:', {
         |           ^
      93 |     message: err.message,
      94 |     statusCode,
      95 |     stack: err.stack,

      at error (src/middleware/errorHandler.ts:92:11)
      at Layer.handleError (node_modules/router/lib/layer.js:116:17)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at Layer.handleError (node_modules/router/lib/layer.js:111:12)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at node_modules/router/index.js:688:15
      at next (node_modules/router/index.js:276:14)
      at next (node_modules/router/lib/route.js:132:14)
      at RestaurantController.next [as searchRestaurants] (src/controllers/restaurant.controller.ts:44:7)
      at src/routes/restaurant.routes.ts:14:3
      at src/middleware/errorHandler.ts:58:9

  console.log
    ‚úÖ Using Google Places API with key

      at RestaurantService.log [as searchRestaurants] (src/services/restaurantService.ts:45:15)

  console.log
    üì° Google API Response Status: REQUEST_DENIED

      at RestaurantService.log [as searchRestaurants] (src/services/restaurantService.ts:63:15)

  console.error
    Error: {
      message: 'Google Places API error: REQUEST_DENIED',
      statusCode: 500,
      stack: 'AppError: Google Places API error: REQUEST_DENIED\n' +
        '    at RestaurantService.searchRestaurants (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/src/services/restaurantService.ts:66:15)\n' +
        '    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n' +
        '    at RestaurantController.searchRestaurants (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/src/controllers/restaurant.controller.ts:30:27)\n' +
        '    at /Users/hashim/Desktop/Development/FeastFriends/321-project/backend/src/routes/restaurant.routes.ts:14:3\n' +
        '    at /Users/hashim/Desktop/Development/FeastFriends/321-project/backend/src/middleware/errorHandler.ts:58:9',
      timestamp: '2025-11-09T07:24:51.767Z',
      path: '/api/restaurant/search',
      method: 'GET'
    }

      90 |   }
      91 |
    > 92 |   console.error('Error:', {
         |           ^
      93 |     message: err.message,
      94 |     statusCode,
      95 |     stack: err.stack,

      at error (src/middleware/errorHandler.ts:92:11)
      at Layer.handleError (node_modules/router/lib/layer.js:116:17)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at Layer.handleError (node_modules/router/lib/layer.js:111:12)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at node_modules/router/index.js:688:15
      at next (node_modules/router/index.js:276:14)
      at next (node_modules/router/lib/route.js:132:14)
      at RestaurantController.next [as searchRestaurants] (src/controllers/restaurant.controller.ts:44:7)
      at src/routes/restaurant.routes.ts:14:3
      at src/middleware/errorHandler.ts:58:9

  console.log
    ‚úÖ Using Google Places API with key

      at RestaurantService.log [as searchRestaurants] (src/services/restaurantService.ts:45:15)

  console.log
    üì° Google API Response Status: INVALID_REQUEST

      at RestaurantService.log [as searchRestaurants] (src/services/restaurantService.ts:63:15)

  console.error
    Error: {
      message: 'Google Places API error: INVALID_REQUEST',
      statusCode: 500,
      stack: 'AppError: Google Places API error: INVALID_REQUEST\n' +
        '    at RestaurantService.searchRestaurants (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/src/services/restaurantService.ts:66:15)\n' +
        '    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n' +
        '    at RestaurantController.searchRestaurants (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/src/controllers/restaurant.controller.ts:30:27)\n' +
        '    at /Users/hashim/Desktop/Development/FeastFriends/321-project/backend/src/routes/restaurant.routes.ts:14:3\n' +
        '    at /Users/hashim/Desktop/Development/FeastFriends/321-project/backend/src/middleware/errorHandler.ts:58:9',
      timestamp: '2025-11-09T07:24:51.771Z',
      path: '/api/restaurant/search',
      method: 'GET'
    }

      90 |   }
      91 |
    > 92 |   console.error('Error:', {
         |           ^
      93 |     message: err.message,
      94 |     statusCode,
      95 |     stack: err.stack,

      at error (src/middleware/errorHandler.ts:92:11)
      at Layer.handleError (node_modules/router/lib/layer.js:116:17)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at Layer.handleError (node_modules/router/lib/layer.js:111:12)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at node_modules/router/index.js:688:15
      at next (node_modules/router/index.js:276:14)
      at next (node_modules/router/lib/route.js:132:14)
      at RestaurantController.next [as searchRestaurants] (src/controllers/restaurant.controller.ts:44:7)
      at src/routes/restaurant.routes.ts:14:3
      at src/middleware/errorHandler.ts:58:9

  console.log
    ‚úÖ Using Google Places API with key

      at RestaurantService.log [as searchRestaurants] (src/services/restaurantService.ts:45:15)

  console.log
    üì° Google API Response Status: OK

      at RestaurantService.log [as searchRestaurants] (src/services/restaurantService.ts:63:15)

  console.log
    üçΩÔ∏è Found 0 restaurants from Google Places

      at RestaurantService.log [as searchRestaurants] (src/services/restaurantService.ts:72:15)

  console.log
    ‚úÖ Using Google Places API with key

      at RestaurantService.log [as searchRestaurants] (src/services/restaurantService.ts:45:15)

  console.error
    ‚ùå Failed to search restaurants: connect ECONNREFUSED

      81 |       if (error instanceof AppError) throw error;
      82 |       const errorMessage = error instanceof Error ? error.message : 'Unknown error';
    > 83 |       console.error('‚ùå Failed to search restaurants:', errorMessage);
         |               ^
      84 |       // Return mock data on error
      85 |       return this.getMockRestaurants();
      86 |     }

      at RestaurantService.error [as searchRestaurants] (src/services/restaurantService.ts:83:15)
      at RestaurantController.searchRestaurants (src/controllers/restaurant.controller.ts:30:27)
      at src/routes/restaurant.routes.ts:14:3
      at src/middleware/errorHandler.ts:58:9

  console.log
    ‚úÖ Using Google Places API with key

      at RestaurantService.log [as searchRestaurants] (src/services/restaurantService.ts:45:15)

  console.error
    ‚ùå Failed to search restaurants: unable to verify the first certificate

      81 |       if (error instanceof AppError) throw error;
      82 |       const errorMessage = error instanceof Error ? error.message : 'Unknown error';
    > 83 |       console.error('‚ùå Failed to search restaurants:', errorMessage);
         |               ^
      84 |       // Return mock data on error
      85 |       return this.getMockRestaurants();
      86 |     }

      at RestaurantService.error [as searchRestaurants] (src/services/restaurantService.ts:83:15)
      at RestaurantController.searchRestaurants (src/controllers/restaurant.controller.ts:30:27)
      at src/routes/restaurant.routes.ts:14:3
      at src/middleware/errorHandler.ts:58:9

  console.log
    ‚úÖ Using Google Places API with key

      at RestaurantService.log [as searchRestaurants] (src/services/restaurantService.ts:45:15)

  console.log
    üì° Google API Response Status: OK

      at RestaurantService.log [as searchRestaurants] (src/services/restaurantService.ts:63:15)

  console.log
    üçΩÔ∏è Found 1 restaurants from Google Places

      at RestaurantService.log [as searchRestaurants] (src/services/restaurantService.ts:72:15)

  console.log
    ‚úÖ Using Google Places API with key

      at RestaurantService.log [as searchRestaurants] (src/services/restaurantService.ts:45:15)

  console.log
    üì° Google API Response Status: ZERO_RESULTS

      at RestaurantService.log [as searchRestaurants] (src/services/restaurantService.ts:63:15)

  console.log
    üçΩÔ∏è Found 0 restaurants from Google Places

      at RestaurantService.log [as searchRestaurants] (src/services/restaurantService.ts:72:15)

  console.log
    ‚úÖ Using Google Places API with key

      at RestaurantService.log [as searchRestaurants] (src/services/restaurantService.ts:45:15)

  console.log
    üì° Google API Response Status: OK

      at RestaurantService.log [as searchRestaurants] (src/services/restaurantService.ts:63:15)

  console.log
    üçΩÔ∏è Found 2 restaurants from Google Places

      at RestaurantService.log [as searchRestaurants] (src/services/restaurantService.ts:72:15)

  console.error
    Failed to get restaurant details: Service Unavailable

      118 |       if (error instanceof AppError) throw error;
      119 |       const errorMessage = error instanceof Error ? error.message : 'Unknown error';
    > 120 |       console.error('Failed to get restaurant details:', errorMessage);
          |               ^
      121 |       return this.getMockRestaurant(placeId);
      122 |     }
      123 |   }

      at RestaurantService.error [as getRestaurantDetails] (src/services/restaurantService.ts:120:15)
      at RestaurantController.getRestaurantDetails (src/controllers/restaurant.controller.ts:56:26)
      at src/routes/restaurant.routes.ts:32:3
      at src/middleware/errorHandler.ts:58:9

  console.error
    Failed to get restaurant details: ETIMEDOUT

      118 |       if (error instanceof AppError) throw error;
      119 |       const errorMessage = error instanceof Error ? error.message : 'Unknown error';
    > 120 |       console.error('Failed to get restaurant details:', errorMessage);
          |               ^
      121 |       return this.getMockRestaurant(placeId);
      122 |     }
      123 |   }

      at RestaurantService.error [as getRestaurantDetails] (src/services/restaurantService.ts:120:15)
      at RestaurantController.getRestaurantDetails (src/controllers/restaurant.controller.ts:56:26)
      at src/routes/restaurant.routes.ts:32:3
      at src/middleware/errorHandler.ts:58:9

  console.error
    Error: {
      message: 'Restaurant not found: NOT_FOUND',
      statusCode: 404,
      stack: 'AppError: Restaurant not found: NOT_FOUND\n' +
        '    at RestaurantService.getRestaurantDetails (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/src/services/restaurantService.ts:111:15)\n' +
        '    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n' +
        '    at RestaurantController.getRestaurantDetails (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/src/controllers/restaurant.controller.ts:56:26)\n' +
        '    at /Users/hashim/Desktop/Development/FeastFriends/321-project/backend/src/routes/restaurant.routes.ts:32:3\n' +
        '    at /Users/hashim/Desktop/Development/FeastFriends/321-project/backend/src/middleware/errorHandler.ts:58:9',
      timestamp: '2025-11-09T07:24:51.965Z',
      path: '/api/restaurant/non-existent-place',
      method: 'GET'
    }

      90 |   }
      91 |
    > 92 |   console.error('Error:', {
         |           ^
      93 |     message: err.message,
      94 |     statusCode,
      95 |     stack: err.stack,

      at error (src/middleware/errorHandler.ts:92:11)
      at Layer.handleError (node_modules/router/lib/layer.js:116:17)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at Layer.handleError (node_modules/router/lib/layer.js:111:12)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at Immediate.next (node_modules/router/index.js:291:5)
      at Immediate._onImmediate (node_modules/router/index.js:688:15)

  console.error
    Error: {
      message: 'Restaurant not found: INVALID_REQUEST',
      statusCode: 404,
      stack: 'AppError: Restaurant not found: INVALID_REQUEST\n' +
        '    at RestaurantService.getRestaurantDetails (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/src/services/restaurantService.ts:111:15)\n' +
        '    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n' +
        '    at RestaurantController.getRestaurantDetails (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/src/controllers/restaurant.controller.ts:56:26)\n' +
        '    at /Users/hashim/Desktop/Development/FeastFriends/321-project/backend/src/routes/restaurant.routes.ts:32:3\n' +
        '    at /Users/hashim/Desktop/Development/FeastFriends/321-project/backend/src/middleware/errorHandler.ts:58:9',
      timestamp: '2025-11-09T07:24:51.972Z',
      path: '/api/restaurant/invalid_format',
      method: 'GET'
    }

      90 |   }
      91 |
    > 92 |   console.error('Error:', {
         |           ^
      93 |     message: err.message,
      94 |     statusCode,
      95 |     stack: err.stack,

      at error (src/middleware/errorHandler.ts:92:11)
      at Layer.handleError (node_modules/router/lib/layer.js:116:17)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at Layer.handleError (node_modules/router/lib/layer.js:111:12)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at Immediate.next (node_modules/router/index.js:291:5)
      at Immediate._onImmediate (node_modules/router/index.js:688:15)

  console.log
    ‚úÖ Using Google Places API with key

      at RestaurantService.log [as searchRestaurants] (src/services/restaurantService.ts:45:15)

  console.error
    ‚ùå Failed to search restaurants: API Unavailable

      81 |       if (error instanceof AppError) throw error;
      82 |       const errorMessage = error instanceof Error ? error.message : 'Unknown error';
    > 83 |       console.error('‚ùå Failed to search restaurants:', errorMessage);
         |               ^
      84 |       // Return mock data on error
      85 |       return this.getMockRestaurants();
      86 |     }

      at RestaurantService.error [as searchRestaurants] (src/services/restaurantService.ts:83:15)
      at RestaurantService.getRecommendationsForGroup (src/services/restaurantService.ts:177:25)
      at RestaurantController.getGroupRecommendations (src/controllers/restaurant.controller.ts:87:31)

  console.log
    ‚úÖ Using Google Places API with key

      at RestaurantService.log [as searchRestaurants] (src/services/restaurantService.ts:45:15)

  console.error
    ‚ùå Failed to search restaurants: ETIMEDOUT

      81 |       if (error instanceof AppError) throw error;
      82 |       const errorMessage = error instanceof Error ? error.message : 'Unknown error';
    > 83 |       console.error('‚ùå Failed to search restaurants:', errorMessage);
         |               ^
      84 |       // Return mock data on error
      85 |       return this.getMockRestaurants();
      86 |     }

      at RestaurantService.error [as searchRestaurants] (src/services/restaurantService.ts:83:15)
      at RestaurantService.getRecommendationsForGroup (src/services/restaurantService.ts:177:25)
      at RestaurantController.getGroupRecommendations (src/controllers/restaurant.controller.ts:87:31)

  console.log
    ‚úÖ Using Google Places API with key

      at RestaurantService.log [as searchRestaurants] (src/services/restaurantService.ts:45:15)

  console.log
    üì° Google API Response Status: OK

      at RestaurantService.log [as searchRestaurants] (src/services/restaurantService.ts:63:15)

  console.log
    üçΩÔ∏è Found 1 restaurants from Google Places

      at RestaurantService.log [as searchRestaurants] (src/services/restaurantService.ts:72:15)

  console.error
    Error: {
      message: 'Forced controller failure',
      statusCode: 500,
      stack: 'Error: Forced controller failure\n' +
        '    at RestaurantService.<anonymous> (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/tests/with-mocks/restaurant.mock.test.ts:758:15)\n' +
        '    at /Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-mock/build/index.js:305:39\n' +
        '    at RestaurantService.<anonymous> (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-mock/build/index.js:312:13)\n' +
        '    at RestaurantService.mockConstructor [as searchRestaurants] (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/jest-mock/build/index.js:102:19)\n' +
        '    at RestaurantController.searchRestaurants (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/src/controllers/restaurant.controller.ts:30:51)\n' +
        '    at searchRestaurants (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/src/routes/restaurant.routes.ts:14:30)\n' +
        '    at fn (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/src/middleware/errorHandler.ts:58:15)\n' +
        '    at /Users/hashim/Desktop/Development/FeastFriends/321-project/backend/src/middleware/errorHandler.ts:62:6\n' +
        '    at Layer.handleRequest (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/lib/layer.js:152:17)\n' +
        '    at next (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/lib/route.js:157:13)\n' +
        '    at next (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/src/middleware/auth.middleware.ts:110:5)\n' +
        '    at Layer.handleRequest (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/lib/layer.js:152:17)\n' +
        '    at next (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/lib/route.js:157:13)\n' +
        '    at Route.dispatch (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/lib/route.js:117:3)\n' +
        '    at handle (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/index.js:435:11)\n' +
        '    at Layer.handleRequest (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/lib/layer.js:152:17)\n' +
        '    at /Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/index.js:295:15\n' +
        '    at processParams (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/index.js:582:12)\n' +
        '    at next (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/index.js:291:5)\n' +
        '    at Function.handle (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/index.js:186:3)\n' +
        '    at router (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/index.js:60:12)\n' +
        '    at Layer.handleRequest (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/lib/layer.js:152:17)\n' +
        '    at trimPrefix (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/index.js:342:13)\n' +
        '    at /Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/index.js:297:9\n' +
        '    at processParams (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/index.js:582:12)\n' +
        '    at next (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/index.js:291:5)\n' +
        '    at urlencodedParser (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/body-parser/lib/types/urlencoded.js:68:7)\n' +
        '    at Layer.handleRequest (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/lib/layer.js:152:17)\n' +
        '    at trimPrefix (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/index.js:342:13)\n' +
        '    at /Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/index.js:297:9\n' +
        '    at processParams (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/index.js:582:12)\n' +
        '    at next (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/index.js:291:5)\n' +
        '    at jsonParser (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/body-parser/lib/types/json.js:100:7)\n' +
        '    at Layer.handleRequest (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/lib/layer.js:152:17)\n' +
        '    at trimPrefix (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/index.js:342:13)\n' +
        '    at /Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/index.js:297:9\n' +
        '    at processParams (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/index.js:582:12)\n' +
        '    at next (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/index.js:291:5)\n' +
        '    at cors (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/cors/lib/index.js:188:7)\n' +
        '    at /Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/cors/lib/index.js:224:17\n' +
        '    at originCallback (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/cors/lib/index.js:214:15)\n' +
        '    at /Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/cors/lib/index.js:219:13\n' +
        '    at optionsCallback (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/cors/lib/index.js:199:9)\n' +
        '    at corsMiddleware (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/cors/lib/index.js:204:7)\n' +
        '    at Layer.handleRequest (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/lib/layer.js:152:17)\n' +
        '    at trimPrefix (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/index.js:342:13)\n' +
        '    at /Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/index.js:297:9\n' +
        '    at processParams (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/index.js:582:12)\n' +
        '    at next (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/index.js:291:5)\n' +
        '    at Function.handle (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/router/index.js:186:3)\n' +
        '    at Function.handle (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/express/lib/application.js:177:15)\n' +
        '    at Server.app (/Users/hashim/Desktop/Development/FeastFriends/321-project/backend/node_modules/express/lib/express.js:38:9)\n' +
        '    at Server.emit (node:events:519:28)\n' +
        '    at parserOnIncoming (node:_http_server:1173:12)\n' +
        '    at HTTPParser.parserOnHeadersComplete (node:_http_common:121:17)',
      timestamp: '2025-11-09T07:24:52.004Z',
      path: '/api/restaurant/search',
      method: 'GET'
    }

      90 |   }
      91 |
    > 92 |   console.error('Error:', {
         |           ^
      93 |     message: err.message,
      94 |     statusCode,
      95 |     stack: err.stack,

      at error (src/middleware/errorHandler.ts:92:11)
      at Layer.handleError (node_modules/router/lib/layer.js:116:17)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at Layer.handleError (node_modules/router/lib/layer.js:111:12)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at node_modules/router/index.js:688:15
      at next (node_modules/router/index.js:276:14)
      at next (node_modules/router/lib/route.js:132:14)
      at RestaurantController.next [as searchRestaurants] (src/controllers/restaurant.controller.ts:44:7)
      at searchRestaurants (src/routes/restaurant.routes.ts:14:30)
      at fn (src/middleware/errorHandler.ts:58:15)
      at src/middleware/errorHandler.ts:62:6
      at Layer.handleRequest (node_modules/router/lib/layer.js:152:17)
      at next (node_modules/router/lib/route.js:157:13)
      at next (src/middleware/auth.middleware.ts:110:5)
      at Layer.handleRequest (node_modules/router/lib/layer.js:152:17)
      at next (node_modules/router/lib/route.js:157:13)
      at Route.dispatch (node_modules/router/lib/route.js:117:3)
      at handle (node_modules/router/index.js:435:11)
      at Layer.handleRequest (node_modules/router/lib/layer.js:152:17)
      at node_modules/router/index.js:295:15
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at Function.handle (node_modules/router/index.js:186:3)
      at router (node_modules/router/index.js:60:12)
      at Layer.handleRequest (node_modules/router/lib/layer.js:152:17)
      at trimPrefix (node_modules/router/index.js:342:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at urlencodedParser (node_modules/body-parser/lib/types/urlencoded.js:68:7)
      at Layer.handleRequest (node_modules/router/lib/layer.js:152:17)
      at trimPrefix (node_modules/router/index.js:342:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at jsonParser (node_modules/body-parser/lib/types/json.js:100:7)
      at Layer.handleRequest (node_modules/router/lib/layer.js:152:17)
      at trimPrefix (node_modules/router/index.js:342:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at cors (node_modules/cors/lib/index.js:188:7)
      at node_modules/cors/lib/index.js:224:17
      at originCallback (node_modules/cors/lib/index.js:214:15)
      at node_modules/cors/lib/index.js:219:13
      at optionsCallback (node_modules/cors/lib/index.js:199:9)
      at corsMiddleware (node_modules/cors/lib/index.js:204:7)
      at Layer.handleRequest (node_modules/router/lib/layer.js:152:17)
      at trimPrefix (node_modules/router/index.js:342:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at Function.handle (node_modules/router/index.js:186:3)
      at Function.handle (node_modules/express/lib/application.js:177:15)
      at Server.app (node_modules/express/lib/express.js:38:9)

  console.log
    Test suite completed.

      at Object.<anonymous> (tests/setup.ts:14:11)

  console.log
    
    üßπ Cleaning up after tests...

      at Object.<anonymous> (tests/with-mocks/restaurant.mock.test.ts:56:11)

  console.warn
    MongoDB disconnected. Attempting to reconnect...

      28 |
      29 |     mongoose.connection.on('disconnected', () => {
    > 30 |       console.warn('MongoDB disconnected. Attempting to reconnect...');
         |               ^
      31 |     });
      32 |
      33 |     mongoose.connection.on('reconnected', () => {

      at NativeConnection.<anonymous> (src/config/database.ts:30:15)
      at NativeConnection.set (node_modules/mongoose/lib/connection.js:145:12)
      at NativeConnection.onClose (node_modules/mongoose/lib/connection.js:1315:19)
      at NativeConnection._close (node_modules/mongoose/lib/connection.js:1264:12)
      at disconnectDatabase (src/config/database.ts:55:5)
      at Object.<anonymous> (tests/with-mocks/restaurant.mock.test.ts:66:3)

  console.log
    MongoDB disconnected successfully

      at disconnectDatabase (src/config/database.ts:56:13)

  console.log
    ‚úÖ Cleanup complete.

      at Object.<anonymous> (tests/with-mocks/restaurant.mock.test.ts:67:11)

PASS tests/with-mocks/restaurant.mock.test.ts
  GET /api/restaurant/search - External Failures
    ‚úì should return mock data when Google Places API is unavailable (5 ms)
    ‚úì should return mock data when network timeout occurs (3 ms)
    ‚úì should return mock data when DNS resolution fails (3 ms)
    ‚úì should return 500 when API returns OVER_QUERY_LIMIT (11 ms)
    ‚úì should return 500 when API returns REQUEST_DENIED (4 ms)
    ‚úì should return 500 when API returns INVALID_REQUEST (3 ms)
    ‚úì should handle malformed response from Google API (3 ms)
    ‚úì should handle network error (ECONNREFUSED) (14 ms)
    ‚úì should handle SSL/TLS errors (56 ms)
    ‚úì should successfully search restaurants with valid API response (34 ms)
    ‚úì should handle ZERO_RESULTS status gracefully (35 ms)
    ‚úì should filter results by price level when specified (17 ms)
  GET /api/restaurant/:restaurantId - External Failures
    ‚úì should return mock data when Google Places API unavailable (30 ms)
    ‚úì should return mock data when network timeout occurs (2 ms)
    ‚úì should throw 404 when restaurant not found in Google API (3 ms)
    ‚úì should successfully get restaurant details with valid API response (2 ms)
    ‚úì should include photos when restaurant has photos (covers getPhotoUrl) (2 ms)
    ‚úì should return 404 when API returns INVALID_REQUEST (2 ms)
  POST /api/restaurant/recommendations/:groupId - External Failures
    ‚úì should return mock data when Google Places API fails (4 ms)
    ‚úì should handle network timeout when getting recommendations (5 ms)
    ‚úì should aggregate preferences and search successfully (6 ms)
  Request Validation - Controller Level
    ‚úì should return 400 when latitude is missing (2 ms)
    ‚úì should return 400 when longitude is missing (2 ms)
    ‚úì should return 400 when userPreferences is missing in recommendations (1 ms)
    ‚úì should return 400 when userPreferences is not an array (2 ms)
  Controller Catch Block Coverage (next(error))
    ‚úì should call errorHandler when restaurantService throws (11 ms)

---------------------------|---------|----------|---------|---------|---------------------------------
File                       | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s               
---------------------------|---------|----------|---------|---------|---------------------------------
All files                  |   84.96 |    83.86 |   81.97 |   84.93 |                                 
 src                       |   23.33 |        0 |       0 |   23.59 |                                 
  app.ts                   |   95.45 |      100 |       0 |   95.45 | 26                              
  server.ts                |       0 |        0 |       0 |       0 | 1-129                           
 src/controllers           |     100 |      100 |     100 |     100 |                                 
  auth.controller.ts       |     100 |      100 |     100 |     100 |                                 
  group.controller.ts      |     100 |      100 |     100 |     100 |                                 
  matching.controller.ts   |     100 |      100 |     100 |     100 |                                 
  restaurant.controller.ts |     100 |      100 |     100 |     100 |                                 
  user.controller.ts       |     100 |      100 |     100 |     100 |                                 
 src/middleware            |   92.39 |    88.09 |     100 |   91.95 |                                 
  auth.middleware.ts       |   95.23 |      100 |     100 |      95 | 112-113                         
  errorHandler.ts          |      90 |    83.33 |     100 |   89.36 | 23,28,34,40,45                  
 src/models                |     100 |      100 |     100 |     100 |                                 
  Group.ts                 |     100 |      100 |     100 |     100 |                                 
  Room.ts                  |     100 |      100 |     100 |     100 |                                 
  User.ts                  |     100 |      100 |     100 |     100 |                                 
 src/routes                |     100 |      100 |     100 |     100 |                                 
  auth.routes.ts           |     100 |      100 |     100 |     100 |                                 
  group.routes.ts          |     100 |      100 |     100 |     100 |                                 
  matching.routes.ts       |     100 |      100 |     100 |     100 |                                 
  restaurant.routes.ts     |     100 |      100 |     100 |     100 |                                 
  user.routes.ts           |     100 |      100 |     100 |     100 |                                 
 src/services              |   81.47 |    79.13 |   81.81 |   81.16 |                                 
  authService.ts           |   88.73 |     82.5 |   88.88 |   88.73 | 159,191-198,208,216             
  groupService.ts          |   76.92 |       72 |      70 |   76.92 | 15,248,283-363                  
  matchingService.ts       |   76.51 |    74.13 |   78.57 |      76 | 69-70,169,260-304,349-384       
  notificationService.ts   |   60.41 |    33.33 |   44.44 |   53.65 | 12-28,54-55,66,76,87-97,107-116 
  restaurantService.ts     |     100 |       85 |     100 |     100 | 34,82,119-133                   
  userService.ts           |   87.64 |    88.33 |     100 |   91.66 | 22-29                           
 src/utils                 |     100 |       80 |     100 |     100 |                                 
  socketManager.ts         |     100 |       80 |     100 |     100 | 18,171                          
---------------------------|---------|----------|---------|---------|---------------------------------
Test Suites: 11 passed, 11 total
Tests:       283 passed, 283 total
Snapshots:   0 total
Time:        7.791 s, estimated 8 s
Ran all test suites.
